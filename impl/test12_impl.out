Doing expand get, insert... Done.
Doing simplify (non-expanded game)... No change.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Trying equivalence suf_cma(mac)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Doing insert instruction let tdi_t2bitstring(x111)=x1_1 in at occurrence 112... Done.
Trying equivalence rom(hash1)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... Done.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 140, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_4 inside simplify... At 147, output message r_4 depends on r_4.
No change
Doing global dependency analysis on r_6 inside simplify... At 139, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_4 inside simplify... At 146, output message r_4 depends on r_4.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
Doing insert instruction let tcbi_t2bitstring(x222)=x1_2 in at occurrence 170... Done.
Trying equivalence rom(hash2)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... Done.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 136, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 198, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 205, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 143, output message r_4 depends on r_4.
No change
Doing global dependency analysis on r_6 inside simplify... At 136, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 197, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 204, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 143, output message r_4 depends on r_4.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
Trying equivalence ind_cca2(enc)... Failed.
Doing remove assignments of binder sk2... Done.
Doing remove assignments of binder pk2... Done.
Trying equivalence ind_cca2(enc) with r_12, r_2, k_2, r_13, r_14, r_15... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Applied collision new r1: keyseed; new r2: keyseed; return((pkgen(r1) = pkgen2_1(r2))) <=(Penccoll)=> return(false) with r2 -> k_4, r1 -> k_3[i2_1194] Probability: Penccoll * qTD
Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 663, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 722, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 729, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 670, output message r_4 depends on r_4.
No change
Doing global dependency analysis on session_key inside simplify... The variable session_key depends on session_key and occurs in a query.
No change
Doing global dependency analysis on r_6 inside simplify... At 597, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 656, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 663, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 604, output message r_4 depends on r_4.
No change
Doing global dependency analysis on session_key inside simplify... The variable session_key depends on session_key and occurs in a query.
No change
Run simplify 2 time(s). Maximum reached.
Done.
Doing SA rename u_13... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 529, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 588, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 595, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 536, output message r_4 depends on r_4.
No change
Doing global dependency analysis on session_key inside simplify... The variable session_key depends on session_key and occurs in a query.
No change
Doing global dependency analysis on r_6 inside simplify... At 529, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 588, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 595, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 536, output message r_4 depends on r_4.
No change
Doing global dependency analysis on session_key inside simplify... The variable session_key depends on session_key and occurs in a query.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing SA rename u_15... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 526, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 585, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 592, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 533, output message r_4 depends on r_4.
No change
Doing global dependency analysis on session_key inside simplify... The variable session_key depends on session_key and occurs in a query.
No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 526, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 585, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 592, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 533, output message r_4 depends on r_4.
No change
Doing global dependency analysis on session_key inside simplify... The variable session_key depends on session_key and occurs in a query.
No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... Done.
Doing remove assignments of findcond... No change.
Doing merge branches... Done.
Trying equivalence uf_cma(sign)... Failed.
Doing remove assignments of binder spk1... Done.
Trying equivalence uf_cma(sign) with ks... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... Done.
Doing expand... Done.
Doing remove assignments of findcond... No change.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 336, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 395, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 402, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 343, output message r_4 depends on r_4.
No change
Doing global dependency analysis on r_6 inside simplify... At 327, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 386, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 393, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 334, output message r_4 depends on r_4.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... Done.
Trying equivalence ind_cca2(enc)... Failed.
Doing remove assignments of binder pk_TD... Done.
Trying equivalence ind_cca2(enc) with k_3, r3_3, r3_4, r3_5, r3_6... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on r_6 inside simplify... At 335, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 394, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 401, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 342, output message r_4 depends on r_4.
No change
Doing global dependency analysis on r_6 inside simplify... At 327, output message r_6[u_22] depends on r_6.
No change
Doing global dependency analysis on r_11 inside simplify... At 386, output message r_11[u_37] depends on r_11.
No change
Doing global dependency analysis on r_9 inside simplify... At 393, output message r_9 depends on r_9.
No change
Doing global dependency analysis on r_4 inside simplify... At 334, output message r_4 depends on r_4.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
Eliminated collisions between r_6 and r_6 Probability: 0.5 / |hashoutput1| * qTDXM * qTDXM
Eliminated collisions between r_11 and r_11 Probability: 0.5 / |hashoutput2| * qCPU * qCPU
Eliminated collisions between r_9 and r_9 Probability: 0.5 / |hashoutput2| * qH2 * qH2
Eliminated collisions between r_11 and r_9 Probability: qCPU * qH2 / |hashoutput2|
Eliminated collisions between r_4 and r_4 Probability: 0.5 / |hashoutput1| * qH1 * qH1
Eliminated collisions between r_6 and r_4 Probability: qTDXM * qH1 / |hashoutput1|
Proved query event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) Probability: (0.5 * qTDXM * qTDXM + 0.5 * qH1 * qH1 + qTDXM * qH1) / |hashoutput1| + (0.5 * qCPU * qCPU + 0.5 * qH2 * qH2 + qCPU * qH2) / |hashoutput2|
Eliminated collisions between r_6 and r_6 Probability: 0.5 / |hashoutput1| * qTDXM * qTDXM
Eliminated collisions between r_11 and r_11 Probability: 0.5 / |hashoutput2| * qCPU * qCPU
Eliminated collisions between r_4 and r_4 Probability: 0.5 / |hashoutput1| * qH1 * qH1
Eliminated collisions between r_6 and r_4 Probability: qTDXM * qH1 / |hashoutput1|
Eliminated collisions between r_9 and r_9 Probability: 0.5 / |hashoutput2| * qH2 * qH2
Eliminated collisions between r_11 and r_9 Probability: qCPU * qH2 / |hashoutput2|
Proved query event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8)) Probability: (0.5 * qTDXM * qTDXM + 0.5 * qH1 * qH1 + qTDXM * qH1) / |hashoutput1| + (0.5 * qCPU * qCPU + 0.5 * qH2 * qH2 + qCPU * qH2) / |hashoutput2|
Eliminated collisions between r_6 and r_6 Probability: 0.5 / |hashoutput1| * qTDXM * qTDXM
Eliminated collisions between r_11 and r_11 Probability: 0.5 / |hashoutput2| * qCPU * qCPU
Eliminated collisions between r_9 and r_9 Probability: 0.5 / |hashoutput2| * qH2 * qH2
Eliminated collisions between r_11 and r_9 Probability: qCPU * qH2 / |hashoutput2|
Eliminated collisions between r_4 and r_4 Probability: 0.5 / |hashoutput1| * qH1 * qH1
Eliminated collisions between r_6 and r_4 Probability: qTDXM * qH1 / |hashoutput1|
Proved query event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8)) Probability: (0.5 * qTDXM * qTDXM + 0.5 * qH1 * qH1 + qTDXM * qH1) / |hashoutput1| + (0.5 * qCPU * qCPU + 0.5 * qH2 * qH2 + qCPU * qH2) / |hashoutput2|
Proof of event(QEaccepted2_14(x1, x2)) ==> event(TDXMsentTDR_8(x1, x2)) failed:
  Found QEaccepted2_14(smr_QE, tdi_QE) at 1324
  but could not prove event(TDXMsentTDR_8(x1, x2))
Proved one-session secrecy of session_key
Proved secrecy of session_key
Sorry, the following queries remain unproved:
- event(QEaccepted2_14(x1, x2)) ==> event(TDXMsentTDR_8(x1, x2))
===================== Proof starts =======================
Initial state
Game 1 is
      in(start, ());
      let skp(spk1: spkey, ssk1: sskey) = (new ks: skeyseed; skp(spkgen(ks), sskgen(ks))) in
      let kp(pk2: pkey, sk2: skey) = (new k_2: keyseed; kp(pkgen(k_2), skgen(k_2))) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m2_Ch: bitstring = (let m_2: bitstring = key2bitstring(session_key) in new r_2: enc_seed; enc_r(m_2, x1_Ch, r_2)) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        let kp(pk_TD: pkey, sk_TD: skey) = (new k_3: keyseed; kp(pkgen(k_3), skgen(k_3))) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        insert mes_TD_TDXM_2(rdata_TD);
        out(c5[i_1], ());
        in(c12[i_1], ());
        get mes_TDXM_TD_8(tdr_TD: tdr_t) in
        out(c13[i_1], tdr_TD)
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let rtyp_TDXM: rtyp_t = get_rtyp in
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        get mes_TD_TDXM_2(rdata_TDXM: rdata_t) in
        let arg_TDXM_CPU_1: arg_TDXM_CPU_t = arg_TDXM_CPU_f(rdata_TDXM, rtyp_TDXM, tdih_TDXM) in
        insert mes_TDXM_CPU_4(arg_TDXM_CPU_1);
        let res4_TDXM: res_t = get_res in
        out(c7[i_2], ());
        in(c10[i_2], ());
        get mes_CPU_TDXM_6(smr_TDXM: smr_t) in
        event TDXMsentTDR_8(smr_TDXM, tdi_TDXM);
        let tdr_TDXM: tdr_t = tdr_f(smr_TDXM, res4_TDXM, tdi_TDXM) in
        event TDXMsentTDR_8(smr_TDXM, tdi_TDXM);
        insert mes_TDXM_TD_8(tdr_TDXM);
        out(c11[i_2], ())
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        get mes_TDXM_CPU_4(arg_TDXM_CPU_2: arg_TDXM_CPU_t) in
        let arg_TDXM_CPU_f(rdata_CPU: rdata_t, rtyp_CPU: rtyp_t, tdih_CPU: hashoutput1) = arg_TDXM_CPU_2 in
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_CPU, res1_CPU, csvn_CPU, tdih_CPU, tcbh_CPU, rdata_CPU, res2_CPU) in
        let mac_CPU: macres_t = mac(rms_without_mac_t2bitstring(rms_without_mac_CPU), mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_CPU, res1_CPU, csvn_CPU, tdih_CPU, tcbh_CPU, rdata_CPU, res2_CPU, mac_CPU);
        insert mes_CPU_TDXM_6(smr_CPU);
        out(c9[i_3], ());
        in(c16[i_3], ());
        get mes_QE_CPU_12(rms_QE_to_CPU: rms_t) in
        let rms_f(rms_without_mac_QE_to_CPU: rms_without_mac_t, mac_QE_to_CPU: macres_t) = rms_QE_to_CPU in
        if check(rms_without_mac_t2bitstring(rms_without_mac_QE_to_CPU), mkey, mac_QE_to_CPU) then
        insert mes_CPU_QE_14(rms_without_mac_QE_to_CPU);
        let rms_without_mac_from_CPU_1: rms_without_mac_t = rms_without_mac_QE_to_CPU in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        insert mes_QE_CPU_12(rms_QE);
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        out(c15[i_4], ());
        in(c18[i_4], ());
        get mes_CPU_QE_14(rms_without_mac_from_CPU_2: rms_without_mac_t) suchthat rms_without_mac_from_CPU_2 = rms_without_mac_QE in
        event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
        event QEaccepted2_14(smr_QE, tdi_QE);
        let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
        let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
        let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
        let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
        let m1: bitstring = (let m_3: bitstring = quote_t2bitstring(quote_QE) in new r_3: enc_seed; enc_r(m_3, pk2, r_3)) in
        out(c19[i_4], m1)
      ))


Applying expand get, insert
  - Expand get/insert for table mes_TD_TDXM_2
  - Expand get/insert for table mes_TDXM_TD_8
  - Expand get/insert for table mes_TDXM_CPU_4
  - Expand get/insert for table mes_CPU_TDXM_6
  - Expand get/insert for table mes_CPU_QE_14
  - Expand get/insert for table mes_QE_CPU_12
yields

Game 2 is
      in(start, ());
   {2}let skp(spk1: spkey, ssk1: sskey) = (new ks: skeyseed; skp(spkgen(ks), sskgen(ks))) in
   {9}let kp(pk2: pkey, sk2: skey) = (new k_2: keyseed; kp(pkgen(k_2), skgen(k_2))) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m2_Ch: bitstring = (let m_2: bitstring = key2bitstring(session_key) in new r_2: enc_seed; enc_r(m_2, x1_Ch, r_2)) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
 {131}  let kp(pk_TD: pkey, sk_TD: skey) = (new k_3: keyseed; kp(pkgen(k_3), skgen(k_3))) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        let mes_TD_TDXM_1: rdata_t = rdata_TD in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(mes_TDXM_TD_1[u_11]) then
        out(c13[i_1], mes_TDXM_TD_1[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let rtyp_TDXM: rtyp_t = get_rtyp in
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(mes_TD_TDXM_1[u_9]) then
        let arg_TDXM_CPU_1: arg_TDXM_CPU_t = arg_TDXM_CPU_f(mes_TD_TDXM_1[u_8], rtyp_TDXM, tdih_TDXM) in
        let mes_TDXM_CPU_1: arg_TDXM_CPU_t = arg_TDXM_CPU_1 in
        let res4_TDXM: res_t = get_res in
        out(c7[i_2], ());
        in(c10[i_2], ());
        find u_6 = u_7 <= qCPU suchthat defined(mes_CPU_TDXM_1[u_7]) then
        event TDXMsentTDR_8(mes_CPU_TDXM_1[u_6], tdi_TDXM);
        let tdr_TDXM: tdr_t = tdr_f(mes_CPU_TDXM_1[u_6], res4_TDXM, tdi_TDXM) in
        event TDXMsentTDR_8(mes_CPU_TDXM_1[u_6], tdi_TDXM);
        let mes_TDXM_TD_1: tdr_t = tdr_TDXM in
        out(c11[i_2], ())
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
 {255}  find u_4 = u_5 <= qTDXM suchthat defined(mes_TDXM_CPU_1[u_5]) then
 {258}  let arg_TDXM_CPU_f(rdata_CPU: rdata_t, rtyp_CPU: rtyp_t, tdih_CPU: hashoutput1) = mes_TDXM_CPU_1[u_4] in
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_CPU, res1_CPU, csvn_CPU, tdih_CPU, tcbh_CPU, rdata_CPU, res2_CPU) in
        let mac_CPU: macres_t = mac(rms_without_mac_t2bitstring(rms_without_mac_CPU), mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_CPU, res1_CPU, csvn_CPU, tdih_CPU, tcbh_CPU, rdata_CPU, res2_CPU, mac_CPU);
        let mes_CPU_TDXM_1: smr_t = smr_CPU in
        out(c9[i_3], ());
        in(c16[i_3], ());
 {338}  find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3]) then
 {341}  let rms_f(rms_without_mac_QE_to_CPU: rms_without_mac_t, mac_QE_to_CPU: macres_t) = mes_QE_CPU_1[u_2] in
        if check(rms_without_mac_t2bitstring(rms_without_mac_QE_to_CPU), mkey, mac_QE_to_CPU) then
        let mes_CPU_QE_1: rms_without_mac_t = rms_without_mac_QE_to_CPU in
        let rms_without_mac_from_CPU_1: rms_without_mac_t = rms_without_mac_QE_to_CPU in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        let mes_QE_CPU_1: rms_t = rms_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        out(c15[i_4], ());
        in(c18[i_4], ());
        find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1]) && (mes_CPU_QE_1[u_1] = rms_without_mac_QE) then
        event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
        event QEaccepted2_14(smr_QE, tdi_QE);
        let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
        let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
        let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
        let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
        let m1: bitstring = (let m_3: bitstring = quote_t2bitstring(quote_QE) in new r_3: enc_seed; enc_r(m_3, pk2, r_3)) in
        out(c19[i_4], m1)
      ))


Applying expand
  - Expand if/find/let
    - Simplify pattern skp(spk1: spkey, ssk1: sskey) (tuple expanded) at 2
    - Simplify pattern kp(pk2: pkey, sk2: skey) (tuple expanded) at 9
    - Simplify pattern arg_TDXM_CPU_f(rdata_CPU: rdata_t, rtyp_CPU: rtyp_t, tdih_CPU: hashoutput1) (tuple expanded) at 258
    - Simplify pattern rms_f(rms_without_mac_QE_to_CPU: rms_without_mac_t, mac_QE_to_CPU: macres_t) (tuple expanded) at 341
    - Replaced defined condition mes_QE_CPU_1[u_3] with mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3] in find at 338
    - Replaced defined condition mes_TDXM_CPU_1[u_5] with mes_TDXM_CPU_1[u_5], mes_TD_TDXM_1[u_8[u_5]], rtyp_TDXM[u_5], tdih_TDXM[u_5] in find at 255
    - Simplify pattern kp(pk_TD: pkey, sk_TD: skey) (tuple expanded) at 131
yields

Game 3 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let sk_TD: skey = skgen(k_3) in
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        let mes_TD_TDXM_1: rdata_t = rdata_TD in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(mes_TDXM_TD_1[u_11]) then
        out(c13[i_1], mes_TDXM_TD_1[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let rtyp_TDXM: rtyp_t = get_rtyp in
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(mes_TD_TDXM_1[u_9]) then
        let arg_TDXM_CPU_1: arg_TDXM_CPU_t = arg_TDXM_CPU_f(mes_TD_TDXM_1[u_8], rtyp_TDXM, tdih_TDXM) in
        let mes_TDXM_CPU_1: arg_TDXM_CPU_t = arg_TDXM_CPU_1 in
        let res4_TDXM: res_t = get_res in
        out(c7[i_2], ());
        in(c10[i_2], ());
        find u_6 = u_7 <= qCPU suchthat defined(mes_CPU_TDXM_1[u_7]) then
        event TDXMsentTDR_8(mes_CPU_TDXM_1[u_6], tdi_TDXM);
        let tdr_TDXM: tdr_t = tdr_f(mes_CPU_TDXM_1[u_6], res4_TDXM, tdi_TDXM) in
        event TDXMsentTDR_8(mes_CPU_TDXM_1[u_6], tdi_TDXM);
        let mes_TDXM_TD_1: tdr_t = tdr_TDXM in
        out(c11[i_2], ())
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(mes_TDXM_CPU_1[u_5], mes_TD_TDXM_1[u_8[u_5]], rtyp_TDXM[u_5], tdih_TDXM[u_5]) then
        let tdih_CPU: hashoutput1 = tdih_TDXM[u_4] in
        let rtyp_CPU: rtyp_t = rtyp_TDXM[u_4] in
        let rdata_CPU: rdata_t = mes_TD_TDXM_1[u_8[u_4]] in
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_CPU, res1_CPU, csvn_CPU, tdih_CPU, tcbh_CPU, rdata_CPU, res2_CPU) in
        let mac_CPU: macres_t = mac(rms_without_mac_t2bitstring(rms_without_mac_CPU), mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_CPU, res1_CPU, csvn_CPU, tdih_CPU, tcbh_CPU, rdata_CPU, res2_CPU, mac_CPU);
        let mes_CPU_TDXM_1: smr_t = smr_CPU in
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3]) then
        let mac_QE_to_CPU: macres_t = macres_QE[u_2] in
        let rms_without_mac_QE_to_CPU: rms_without_mac_t = rms_without_mac_QE[u_2] in
        if check(rms_without_mac_t2bitstring(rms_without_mac_QE_to_CPU), mkey, mac_QE_to_CPU) then
        let mes_CPU_QE_1: rms_without_mac_t = rms_without_mac_QE_to_CPU in
        let rms_without_mac_from_CPU_1: rms_without_mac_t = rms_without_mac_QE_to_CPU in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        let mes_QE_CPU_1: rms_t = rms_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        out(c15[i_4], ());
        in(c18[i_4], ());
        find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1]) && (mes_CPU_QE_1[u_1] = rms_without_mac_QE) then
        event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
        event QEaccepted2_14(smr_QE, tdi_QE);
        let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
        let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
        let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
        let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
        let m_3: bitstring = quote_t2bitstring(quote_QE) in
        new r_3: enc_seed;
        let m1: bitstring = enc_r(m_3, pk2, r_3) in
        out(c19[i_4], m1)
      ))


Applying remove assignments of findcond
  - Remove assignments on mes_QE_CPU_1 (definition point kept, all usages removed)
  - Remove assignments on tdih_CPU (definition removed, all usages removed)
  - Remove assignments on rtyp_CPU (definition removed, all usages removed)
  - Remove assignments on rdata_CPU (definition removed, all usages removed)
  - Remove assignments on mes_CPU_TDXM_1 (definition removed, all usages removed)
  - Remove assignments on mac_QE_to_CPU (definition removed, all usages removed)
  - Remove assignments on rms_without_mac_QE_to_CPU (definition removed, all usages removed)
  - Remove assignments on mes_CPU_QE_1 (definition point kept, all usages removed)
  - Remove assignments on rms_without_mac_from_CPU_1 (definition removed, all usages removed)
  - Remove assignments on mes_TDXM_CPU_1 (definition removed, all usages removed)
  - Remove assignments on mes_TDXM_TD_1 (definition removed, all usages removed)
  - Remove assignments on sk_TD (definition removed, all usages removed)
  - Remove assignments on mes_TD_TDXM_1 (definition removed, all usages removed)
  - Remove assignments on arg_TDXM_CPU_1 (definition removed, all usages removed)
yields

Game 4 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
 {150}  find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11], tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let rtyp_TDXM: rtyp_t = get_rtyp in
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
 {177}  find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9], rdata_TD[u_9]) then
        let res4_TDXM: res_t = get_res in
        out(c7[i_2], ());
        in(c10[i_2], ());
 {188}  find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7], smr_CPU[u_7]) then
        event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
        let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
        event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
        out(c11[i_2], ())
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
 {233}  find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], rdata_TD[u_8[u_5]], res4_TDXM[u_5], rtyp_TDXM[u_5], tdih_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let mac_CPU: macres_t = mac(rms_without_mac_t2bitstring(rms_without_mac_CPU), mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, mac_CPU);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3]) then
        if check(rms_without_mac_t2bitstring(rms_without_mac_QE[u_2]), mkey, macres_QE[u_2]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        let mes_QE_CPU_1: rms_t = cst_rms_t in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        out(c15[i_4], ());
        in(c18[i_4], ());
 {397}  find u = u_1 <= qCPU suchthat defined(rms_without_mac_QE[u_2[u_1]], mes_CPU_QE_1[u_1]) && {401}(rms_without_mac_QE[u_2[u_1]] = rms_without_mac_QE) then
        event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
        event QEaccepted2_14(smr_QE, tdi_QE);
        let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
        let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
        let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
        let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
        let m_3: bitstring = quote_t2bitstring(quote_QE) in
        new r_3: enc_seed;
        let m1: bitstring = enc_r(m_3, pk2, r_3) in
        out(c19[i_4], m1)
      ))


Applying simplify
  - Simplification pass
    - Replaced (rms_without_mac_QE[u_2[u_1]] = rms_without_mac_QE) with ((res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE)) at 401
    - Replaced defined condition rms_without_mac_QE[u_2[u_1]], mes_CPU_QE_1[u_1] with mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]] in find at 397
    - Replaced defined condition rdata_TD[u_8[u_5]], rdata_TD[u_8[u_5]], res4_TDXM[u_5], rtyp_TDXM[u_5], tdih_TDXM[u_5] with res4_TDXM[u_5], rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5] in find at 233
    - Replaced defined condition smr_CPU[u_7], smr_CPU[u_7] with smr_CPU[u_7] in find at 188
    - Replaced defined condition rdata_TD[u_9], rdata_TD[u_9] with rdata_TD[u_9] in find at 177
    - Replaced defined condition tdr_TDXM[u_11], tdr_TDXM[u_11] with tdr_TDXM[u_11] in find at 150
yields

Game 5 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let rtyp_TDXM: rtyp_t = get_rtyp in
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        let res4_TDXM: res_t = get_res in
        out(c7[i_2], ());
        in(c10[i_2], ());
        find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
        event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
        let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
        event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
        out(c11[i_2], ())
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(res4_TDXM[u_5], rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let mac_CPU: macres_t = mac(rms_without_mac_t2bitstring(rms_without_mac_CPU), mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, mac_CPU);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3]) then
        if check(rms_without_mac_t2bitstring(rms_without_mac_QE[u_2]), mkey, macres_QE[u_2]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        let mes_QE_CPU_1: rms_t = cst_rms_t in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        out(c15[i_4], ());
        in(c18[i_4], ());
        find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
        event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
        event QEaccepted2_14(smr_QE, tdi_QE);
        let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
        let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
        let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
        let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
        let m_3: bitstring = quote_t2bitstring(quote_QE) in
        new r_3: enc_seed;
        let m1: bitstring = enc_r(m_3, pk2, r_3) in
        out(c19[i_4], m1)
      ))


Applying move all binders
  - Move assignment to mes_QE_CPU_1
  - Move assignment to rtyp_TDXM
yields

Game 6 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let res4_TDXM: res_t = get_res in
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(res4_TDXM[u_5], rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let mac_CPU: macres_t = mac(rms_without_mac_t2bitstring(rms_without_mac_CPU), mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, mac_CPU);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3]) then
        if check(rms_without_mac_t2bitstring(rms_without_mac_QE[u_2]), mkey, macres_QE[u_2]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying equivalence suf_cma(mac) [probability Pmac(time(context for game 6) + time, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring))]
  - Equivalence suf_cma(mac) with variables: mkey -> k_3
yields

Game 7 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let res4_TDXM: res_t = get_res in
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
 {233}  find u_4 = u_5 <= qTDXM suchthat defined(res4_TDXM[u_5], rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let mac_CPU: macres_t = (let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in (let ma2: macres_t = mac'(x, mkey) in ma2)) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, mac_CPU);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3]) then
 {332}  if (let m_4: bitstring = rms_without_mac_t2bitstring(rms_without_mac_QE[u_2]) in (let ma: macres_t = macres_QE[u_2] in find u_12 = ri <= qCPU suchthat defined(x[ri], ma2[ri]) && (m_4 = x[ri]) && (ma = ma2[ri]) then true else false)) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying expand
  - Expand if/find/let
    - Test at 332 always false
    - Test at 332 always true
    - Replaced defined condition res4_TDXM[u_5], rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5] with rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5] in find at 233
yields

Game 8 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let res4_TDXM: res_t = get_res in
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let mac_CPU: macres_t = ma2 in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, mac_CPU) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, mac_CPU);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3]) then
        let m_4: bitstring = rms_without_mac_t2bitstring(rms_without_mac_QE[u_2]) in
        let ma: macres_t = macres_QE[u_2] in
        find u_12 = ri <= qCPU suchthat defined(x[ri], ma2[ri]) && (m_4 = x[ri]) && (ma = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on mac_CPU (definition removed, all usages removed)
  - Remove assignments on ma (definition removed, all usages removed)
yields

Game 9 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let res4_TDXM: res_t = get_res in
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
 {323}  find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3]) then
        let m_4: bitstring = rms_without_mac_t2bitstring(rms_without_mac_QE[u_2]) in
 {333}  find u_12 = ri <= qCPU suchthat defined(x[ri], ma2[ri]) && {336}((m_4 = x[ri]) && (macres_QE[u_2] = ma2[ri])) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Replaced ((m_4 = x[ri]) && (macres_QE[u_2] = ma2[ri])) with ((res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri])) at 336
    - Replaced defined condition x[ri], ma2[ri] with ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri] in find at 333
    - Replaced defined condition mes_QE_CPU_1[u_3], rms_without_mac_QE[u_3], macres_QE[u_3] with mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3], rms_without_mac_QE[u_3] in find at 323
yields

Game 10 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let res4_TDXM: res_t = get_res in
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3], rms_without_mac_QE[u_3]) then
        let m_4: bitstring = rms_without_mac_t2bitstring(rms_without_mac_QE[u_2]) in
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying move all binders
  - Move assignment to m_4
  - Move assignment to res4_TDXM
yields

Game 11 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
 {112}  out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let res4_TDXM: res_t = get_res in
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3], rms_without_mac_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying insert instruction let tdi_t2bitstring(x111)=x1_1 in at occurrence 112
yields

Game 12 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk1: hashkey;
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          out(ch2[iH], hash1(hk1, x1_1))
        else
          out(ch2[iH], hash1(hk1, x1_1))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = hash1(hk1, tdi_t2bitstring(tdi_TDXM)) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let res4_TDXM: res_t = get_res in
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3], rms_without_mac_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (tdih_QE = hash1(hk1, tdi_t2bitstring(tdi_QE))) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying equivalence rom(hash1) [probability qQE / |hashoutput1|]
  - Equivalence rom(hash1) with variables: hk1 -> hk
yields

Game 13 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          out(ch2[iH], (let x_O: bitstring = x1_1 in {119}find [unique] u_24 = ri_12 <= qH1 suchthat defined(x_O[ri_12], r_4[ri_12]) && (x_O = x_O[ri_12]) then r_4[u_24] orfind u_23 = ri_11 <= qH1 suchthat defined(x_O_1[ri_11], r_5[ri_11]) && {132}(x_O = x_O_1[ri_11]) then r_5[u_23] orfind u_22 = ri_10 <= qTDXM suchthat defined(x_O_2[ri_10], r_6[ri_10]) && (x_O = x_O_2[ri_10]) then r_6[u_22] else new r_4: hashoutput1; r_4))
        else
          out(ch2[iH], (let x_O_1: bitstring = x1_1 in {159}find [unique] u_21 = ri_9 <= qH1 suchthat defined(x_O[ri_9], r_4[ri_9]) && {162}(x_O_1 = x_O[ri_9]) then r_4[u_21] orfind u_20 = ri_8 <= qH1 suchthat defined(x_O_1[ri_8], r_5[ri_8]) && (x_O_1 = x_O_1[ri_8]) then r_5[u_20] orfind u_19 = ri_7 <= qTDXM suchthat defined(x_O_2[ri_7], r_6[ri_7]) && {182}(x_O_1 = x_O_2[ri_7]) then r_6[u_19] else new r_5: hashoutput1; r_5))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = (let x_O_2: bitstring = tdi_t2bitstring(tdi_TDXM) in {248}find [unique] u_18 = ri_6 <= qH1 suchthat defined(x_O[ri_6], r_4[ri_6]) && (x_O_2 = x_O[ri_6]) then r_4[u_18] orfind u_17 = ri_5 <= qH1 suchthat defined(x_O_1[ri_5], r_5[ri_5]) && {261}(x_O_2 = x_O_1[ri_5]) then r_5[u_17] orfind u_16 = ri_4 <= qTDXM suchthat defined(x_O_2[ri_4], r_6[ri_4]) && {271}(x_O_2 = x_O_2[ri_4]) then r_6[u_16] else new r_6: hashoutput1; r_6) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let res4_TDXM: res_t = get_res in
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        if (let x_Oeq: bitstring = tdi_t2bitstring(tdi_QE) in (let X_Oeq: hashoutput1 = tdih_QE in {558}find [unique] u_15 = ri_3 <= qH1 suchthat defined(x_O[ri_3], r_4[ri_3]) && (x_Oeq = x_O[ri_3]) then (X_Oeq = r_4[u_15]) orfind u_14 = ri_2 <= qH1 suchthat defined(x_O_1[ri_2], r_5[ri_2]) && {574}(x_Oeq = x_O_1[ri_2]) then (X_Oeq = r_5[u_14]) orfind u_13 = ri_1 <= qTDXM suchthat defined(x_O_2[ri_1], r_6[ri_1]) && (x_Oeq = x_O_2[ri_1]) then (X_Oeq = r_6[u_13]) else false)) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify (non-expanded game)
  - Simplification pass
    - Replaced (x_O = x_O_1[ri_11]) with false at 132
    - Remove branch 2 in find at 119
    - Replaced (x_O_1 = x_O_2[ri_7]) with false at 182
    - Remove branch 3 in find at 159
    - Replaced (x_O_1 = x_O[ri_9]) with false at 162
    - Remove branch 1 in find at 159
    - Replaced (x_O_2 = x_O_2[ri_4]) with true at 271
    - Replaced (x_O_2 = x_O_1[ri_5]) with false at 261
    - Remove branch 2 in find at 248
    - Replaced (x_Oeq = x_O_1[ri_2]) with false at 574
    - Remove branch 2 in find at 558
yields

Game 14 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          out(ch2[iH], (let x_O: bitstring = x1_1 in find [unique] u_24 = ri_12 <= qH1 suchthat defined(x_O[ri_12], r_4[ri_12]) && (x_O = x_O[ri_12]) then r_4[u_24] orfind u_22 = ri_10 <= qTDXM suchthat defined(x_O_2[ri_10], r_6[ri_10]) && (x_O = x_O_2[ri_10]) then r_6[u_22] else new r_4: hashoutput1; r_4))
        else
          out(ch2[iH], (let x_O_1: bitstring = x1_1 in find [unique] u_20 = ri_8 <= qH1 suchthat defined(x_O_1[ri_8], r_5[ri_8]) && (x_O_1 = x_O_1[ri_8]) then r_5[u_20] else new r_5: hashoutput1; r_5))
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let tdih_TDXM: hashoutput1 = (let x_O_2: bitstring = tdi_t2bitstring(tdi_TDXM) in {218}find [unique] u_18 = ri_6 <= qH1 suchthat defined(x_O[ri_6], r_4[ri_6]) && (x_O_2 = x_O[ri_6]) then r_4[u_18] orfind u_16 = ri_4 <= qTDXM suchthat defined(x_O_2[ri_4], r_6[ri_4]) then r_6[u_16] else new r_6: hashoutput1; r_6) in
        find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
        (
          let rtyp_TDXM: rtyp_t = get_rtyp in
          out(c7[i_2], ());
          in(c10[i_2], ());
          find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          let res4_TDXM: res_t = get_res in
          let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
          event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
          out(c11[i_2], ())
        )
        else
          let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
 {505}  if (let x_Oeq: bitstring = tdi_t2bitstring(tdi_QE) in (let X_Oeq: hashoutput1 = tdih_QE in find [unique] u_15 = ri_3 <= qH1 suchthat defined(x_O[ri_3], r_4[ri_3]) && (x_Oeq = x_O[ri_3]) then (X_Oeq = r_4[u_15]) orfind u_13 = ri_1 <= qTDXM suchthat defined(x_O_2[ri_1], r_6[ri_1]) && (x_Oeq = x_O_2[ri_1]) then (X_Oeq = r_6[u_13]) else false)) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
        (
          let mes_QE_CPU_1: rms_t = cst_rms_t in
          out(c15[i_4], ());
          in(c18[i_4], ());
          find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
          event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
          event QEaccepted2_14(smr_QE, tdi_QE);
          let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
          let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
          let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
          let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
          let m_3: bitstring = quote_t2bitstring(quote_QE) in
          new r_3: enc_seed;
          let m1: bitstring = enc_r(m_3, pk2, r_3) in
          out(c19[i_4], m1)
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying expand
  - Expand if/find/let
    - Test at 505 always false
    - Replaced defined condition x_O_2[ri_4], r_6[ri_4] with r_6[ri_4] in find at 218
yields

Game 15 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
        (
          let x_O: bitstring = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(x_O[ri_12], r_4[ri_12]) && (x_O = x_O[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(x_O_2[ri_10], r_6[ri_10]) && (x_O = x_O_2[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        )
        else
          let x_O_1: bitstring = x1_1 in
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(x_O_1[ri_8], r_5[ri_8]) && (x_O_1 = x_O_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let x_O_2: bitstring = tdi_t2bitstring(tdi_TDXM) in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(x_O[ri_6], r_4[ri_6]) && (x_O_2 = x_O[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        let x_Oeq: bitstring = tdi_t2bitstring(tdi_QE) in
        let X_Oeq: hashoutput1 = tdih_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(x_O[ri_3], r_4[ri_3]) && (x_Oeq = x_O[ri_3]) then
        (
          if (X_Oeq = r_4[u_15]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(x_O_2[ri_1], r_6[ri_1]) && (x_Oeq = x_O_2[ri_1]) then
        (
          if (X_Oeq = r_6[u_13]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on X_Oeq (definition removed, all usages removed)
  - Remove assignments on x_O_1 (definition point kept, all usages removed)
  - Remove assignments on x_O (definition point kept, all usages removed)
yields

Game 16 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
        (
          let x_O: bitstring = cst_bitstring in
 {116}    find [unique] u_24 = ri_12 <= qH1 suchthat defined(x1_1[ri_12], x_O[ri_12], r_4[ri_12]) && {120}(x1_1 = x1_1[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(x_O_2[ri_10], r_6[ri_10]) && {133}(x1_1 = x_O_2[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        )
        else
          let x_O_1: bitstring = cst_bitstring in
 {153}    find [unique] u_20 = ri_8 <= qH1 suchthat defined(x1_1[ri_8], x_O_1[ri_8], r_5[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let x_O_2: bitstring = tdi_t2bitstring(tdi_TDXM) in
 {228}  find [unique] u_18 = ri_6 <= qH1 suchthat defined(x1_1[ri_6], x_O[ri_6], r_4[ri_6]) && {232}(x_O_2 = x1_1[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        let x_Oeq: bitstring = tdi_t2bitstring(tdi_QE) in
 {633}  find [unique] u_15 = ri_3 <= qH1 suchthat defined(x1_1[ri_3], x_O[ri_3], r_4[ri_3]) && {637}(x_Oeq = x1_1[ri_3]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(x_O_2[ri_1], r_6[ri_1]) && {812}(x_Oeq = x_O_2[ri_1]) then
        (
          if (tdih_QE = r_6[u_13]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Replaced (x_Oeq = x_O_2[ri_1]) with (tdi_QE = tdi_TDXM[ri_1]) at 812
    - Replaced defined condition x_O_2[ri_1], r_6[ri_1] with r_6[ri_1], tdi_TDXM[ri_1] in find at 633
    - Replaced (x_Oeq = x1_1[ri_3]) with (tdi_QE = x111[ri_3]) at 637
    - Replaced defined condition x1_1[ri_3], x_O[ri_3], r_4[ri_3] with r_4[ri_3], x111[ri_3] in find at 633
    - Replaced (x_O_2 = x1_1[ri_6]) with (tdi_TDXM = x111[ri_6]) at 232
    - Replaced defined condition x1_1[ri_6], x_O[ri_6], r_4[ri_6] with r_4[ri_6], x111[ri_6] in find at 228
    - Replaced defined condition x1_1[ri_8], x_O_1[ri_8], r_5[ri_8] with r_5[ri_8], x1_1[ri_8] in find at 153
    - Replaced (x1_1 = x_O_2[ri_10]) with (x111 = tdi_TDXM[ri_10]) at 133
    - Replaced defined condition x_O_2[ri_10], r_6[ri_10] with r_6[ri_10], tdi_TDXM[ri_10] in find at 116
    - Replaced (x1_1 = x1_1[ri_12]) with (x111 = x111[ri_12]) at 120
    - Replaced defined condition x1_1[ri_12], x_O[ri_12], r_4[ri_12] with r_4[ri_12], x111[ri_12] in find at 116
yields

Game 17 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
        (
          let x_O: bitstring = cst_bitstring in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        )
        else
          let x_O_1: bitstring = cst_bitstring in
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        let x_O_2: bitstring = tdi_t2bitstring(tdi_TDXM) in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        let x_Oeq: bitstring = tdi_t2bitstring(tdi_QE) in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          if (tdih_QE = r_6[u_13]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying move all binders
  - Move assignment to x_Oeq
  - Move assignment to x_O_2
  - Move assignment to x_O_1
  - Move assignment to x_O
yields

Game 18 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          if (tdih_QE = r_6[u_13]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_3: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_3) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Rename variable r_3 into r_8, r_7
yields

Game 19 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
 {170}  out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_7: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_7) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          if (tdih_QE = r_6[u_13]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_8: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_8) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying insert instruction let tcbi_t2bitstring(x222)=x1_2 in at occurrence 170
yields

Game 20 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new hk2: hashkey;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          out(ch2_1[iH_1], hash2(hk2, x1_2))
        else
          out(ch2_1[iH_1], hash2(hk2, x1_2))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = hash2(hk2, tcbi_t2bitstring(tcbi_CPU)) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_7: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_7) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          if (tdih_QE = r_6[u_13]) && (tcbh_QE = hash2(hk2, tcbi_t2bitstring(tcbi_QE))) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_8: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_8) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying equivalence rom(hash2) [probability qQE / |hashoutput2|]
  - Equivalence rom(hash2) with variables: hk2 -> hk
yields

Game 21 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          out(ch2_1[iH_1], (let x_O_3: bitstring = x1_2 in {177}find [unique] u_39 = ri_27 <= qH2 suchthat defined(x_O_3[ri_27], r_9[ri_27]) && (x_O_3 = x_O_3[ri_27]) then r_9[u_39] orfind u_38 = ri_26 <= qH2 suchthat defined(x_O_4[ri_26], r_10[ri_26]) && {190}(x_O_3 = x_O_4[ri_26]) then r_10[u_38] orfind u_37 = ri_25 <= qCPU suchthat defined(x_O_5[ri_25], r_11[ri_25]) && (x_O_3 = x_O_5[ri_25]) then r_11[u_37] else new r_9: hashoutput2; r_9))
        else
          out(ch2_1[iH_1], (let x_O_4: bitstring = x1_2 in {217}find [unique] u_36 = ri_24 <= qH2 suchthat defined(x_O_3[ri_24], r_9[ri_24]) && {220}(x_O_4 = x_O_3[ri_24]) then r_9[u_36] orfind u_35 = ri_23 <= qH2 suchthat defined(x_O_4[ri_23], r_10[ri_23]) && (x_O_4 = x_O_4[ri_23]) then r_10[u_35] orfind u_34 = ri_22 <= qCPU suchthat defined(x_O_5[ri_22], r_11[ri_22]) && {240}(x_O_4 = x_O_5[ri_22]) then r_11[u_34] else new r_10: hashoutput2; r_10))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = (let x_O_5: bitstring = tcbi_t2bitstring(tcbi_CPU) in {501}find [unique] u_33 = ri_21 <= qH2 suchthat defined(x_O_3[ri_21], r_9[ri_21]) && (x_O_5 = x_O_3[ri_21]) then r_9[u_33] orfind u_32 = ri_20 <= qH2 suchthat defined(x_O_4[ri_20], r_10[ri_20]) && {514}(x_O_5 = x_O_4[ri_20]) then r_10[u_32] orfind u_31 = ri_19 <= qCPU suchthat defined(x_O_5[ri_19], r_11[ri_19]) && {524}(x_O_5 = x_O_5[ri_19]) then r_11[u_31] else new r_11: hashoutput2; r_11) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          if (tdih_QE = r_4[u_15]) && (let x_Oeq_1: bitstring = tcbi_t2bitstring(tcbi_QE) in (let X_Oeq_1: hashoutput2 = tcbh_QE in {746}find [unique] u_27 = ri_15 <= qH2 suchthat defined(x_O_3[ri_15], r_9[ri_15]) && (x_Oeq_1 = x_O_3[ri_15]) then (X_Oeq_1 = r_9[u_27]) orfind u_26 = ri_14 <= qH2 suchthat defined(x_O_4[ri_14], r_10[ri_14]) && {762}(x_Oeq_1 = x_O_4[ri_14]) then (X_Oeq_1 = r_10[u_26]) orfind u_25 = ri_13 <= qCPU suchthat defined(x_O_5[ri_13], r_11[ri_13]) && (x_Oeq_1 = x_O_5[ri_13]) then (X_Oeq_1 = r_11[u_25]) else false)) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_7: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_7) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          if (tdih_QE = r_6[u_13]) && (let x_Oeq_2: bitstring = tcbi_t2bitstring(tcbi_QE) in (let X_Oeq_2: hashoutput2 = tcbh_QE in {961}find [unique] u_30 = ri_18 <= qH2 suchthat defined(x_O_3[ri_18], r_9[ri_18]) && (x_Oeq_2 = x_O_3[ri_18]) then (X_Oeq_2 = r_9[u_30]) orfind u_29 = ri_17 <= qH2 suchthat defined(x_O_4[ri_17], r_10[ri_17]) && {977}(x_Oeq_2 = x_O_4[ri_17]) then (X_Oeq_2 = r_10[u_29]) orfind u_28 = ri_16 <= qCPU suchthat defined(x_O_5[ri_16], r_11[ri_16]) && (x_Oeq_2 = x_O_5[ri_16]) then (X_Oeq_2 = r_11[u_28]) else false)) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_8: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_8) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify (non-expanded game)
  - Simplification pass
    - Replaced (x_O_3 = x_O_4[ri_26]) with false at 190
    - Remove branch 2 in find at 177
    - Replaced (x_O_4 = x_O_5[ri_22]) with false at 240
    - Remove branch 3 in find at 217
    - Replaced (x_O_4 = x_O_3[ri_24]) with false at 220
    - Remove branch 1 in find at 217
    - Replaced (x_O_5 = x_O_5[ri_19]) with true at 524
    - Replaced (x_O_5 = x_O_4[ri_20]) with false at 514
    - Remove branch 2 in find at 501
    - Replaced (x_Oeq_1 = x_O_4[ri_14]) with false at 762
    - Remove branch 2 in find at 746
    - Replaced (x_Oeq_2 = x_O_4[ri_17]) with false at 977
    - Remove branch 2 in find at 961
yields

Game 22 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          out(ch2_1[iH_1], (let x_O_3: bitstring = x1_2 in find [unique] u_39 = ri_27 <= qH2 suchthat defined(x_O_3[ri_27], r_9[ri_27]) && (x_O_3 = x_O_3[ri_27]) then r_9[u_39] orfind u_37 = ri_25 <= qCPU suchthat defined(x_O_5[ri_25], r_11[ri_25]) && (x_O_3 = x_O_5[ri_25]) then r_11[u_37] else new r_9: hashoutput2; r_9))
        else
          out(ch2_1[iH_1], (let x_O_4: bitstring = x1_2 in find [unique] u_35 = ri_23 <= qH2 suchthat defined(x_O_4[ri_23], r_10[ri_23]) && (x_O_4 = x_O_4[ri_23]) then r_10[u_35] else new r_10: hashoutput2; r_10))
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let tcbh_CPU: hashoutput2 = (let x_O_5: bitstring = tcbi_t2bitstring(tcbi_CPU) in {471}find [unique] u_33 = ri_21 <= qH2 suchthat defined(x_O_3[ri_21], r_9[ri_21]) && (x_O_5 = x_O_3[ri_21]) then r_9[u_33] orfind u_31 = ri_19 <= qCPU suchthat defined(x_O_5[ri_19], r_11[ri_19]) then r_11[u_31] else new r_11: hashoutput2; r_11) in
        let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
        let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
        let ma2: macres_t = mac'(x, mkey) in
        let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
        let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
        event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
        out(c9[i_3], ());
        in(c16[i_3], ());
        find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
        find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
        let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
        out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
 {687}    if (tdih_QE = r_4[u_15]) && (let x_Oeq_1: bitstring = tcbi_t2bitstring(tcbi_QE) in (let X_Oeq_1: hashoutput2 = tcbh_QE in find [unique] u_27 = ri_15 <= qH2 suchthat defined(x_O_3[ri_15], r_9[ri_15]) && (x_Oeq_1 = x_O_3[ri_15]) then (X_Oeq_1 = r_9[u_27]) orfind u_25 = ri_13 <= qCPU suchthat defined(x_O_5[ri_13], r_11[ri_13]) && (x_Oeq_1 = x_O_5[ri_13]) then (X_Oeq_1 = r_11[u_25]) else false)) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_7: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_7) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
 {889}    if (tdih_QE = r_6[u_13]) && (let x_Oeq_2: bitstring = tcbi_t2bitstring(tcbi_QE) in (let X_Oeq_2: hashoutput2 = tcbh_QE in find [unique] u_30 = ri_18 <= qH2 suchthat defined(x_O_3[ri_18], r_9[ri_18]) && (x_Oeq_2 = x_O_3[ri_18]) then (X_Oeq_2 = r_9[u_30]) orfind u_28 = ri_16 <= qCPU suchthat defined(x_O_5[ri_16], r_11[ri_16]) && (x_Oeq_2 = x_O_5[ri_16]) then (X_Oeq_2 = r_11[u_28]) else false)) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_8: enc_seed;
            let m1: bitstring = enc_r(m_3, pk2, r_8) in
            out(c19[i_4], m1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying expand
  - Expand if/find/let
    - Test at 889 always false
    - Test at 687 always false
    - Replaced defined condition x_O_5[ri_19], r_11[ri_19] with r_11[ri_19] in find at 471
yields

Game 23 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
        (
          let x_O_3: bitstring = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(x_O_3[ri_27], r_9[ri_27]) && (x_O_3 = x_O_3[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(x_O_5[ri_25], r_11[ri_25]) && (x_O_3 = x_O_5[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        )
        else
          let x_O_4: bitstring = x1_2 in
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(x_O_4[ri_23], r_10[ri_23]) && (x_O_4 = x_O_4[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let x_O_5: bitstring = tcbi_t2bitstring(tcbi_CPU) in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(x_O_3[ri_21], r_9[ri_21]) && (x_O_5 = x_O_3[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], tcbh_CPU, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          let x_Oeq_1: bitstring = tcbi_t2bitstring(tcbi_QE) in
          let X_Oeq_1: hashoutput2 = tcbh_QE in
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(x_O_3[ri_15], r_9[ri_15]) && (x_Oeq_1 = x_O_3[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (X_Oeq_1 = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(x_O_5[ri_13], r_11[ri_13]) && (x_Oeq_1 = x_O_5[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (X_Oeq_1 = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          let x_Oeq_2: bitstring = tcbi_t2bitstring(tcbi_QE) in
          let X_Oeq_2: hashoutput2 = tcbh_QE in
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(x_O_3[ri_18], r_9[ri_18]) && (x_Oeq_2 = x_O_3[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (X_Oeq_2 = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(x_O_5[ri_16], r_11[ri_16]) && (x_Oeq_2 = x_O_5[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (X_Oeq_2 = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on X_Oeq_1 (definition removed, all usages removed)
  - Remove assignments on X_Oeq_2 (definition removed, all usages removed)
  - Remove assignments on tcbh_CPU (definition kept, array references kept)
  - Remove assignments on tcbh_CPU (definition kept, array references kept)
  - Remove assignments on tcbh_CPU (definition kept, array references kept)
  - Remove assignments on x_O_4 (definition point kept, all usages removed)
  - Remove assignments on x_O_3 (definition point kept, all usages removed)
yields

Game 24 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
        (
          let x_O_3: bitstring = cst_bitstring in
 {174}    find [unique] u_39 = ri_27 <= qH2 suchthat defined(x1_2[ri_27], x_O_3[ri_27], r_9[ri_27]) && {178}(x1_2 = x1_2[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(x_O_5[ri_25], r_11[ri_25]) && {191}(x1_2 = x_O_5[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        )
        else
          let x_O_4: bitstring = cst_bitstring in
 {211}    find [unique] u_35 = ri_23 <= qH2 suchthat defined(x1_2[ri_23], x_O_4[ri_23], r_10[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let x_O_5: bitstring = tcbi_t2bitstring(tcbi_CPU) in
 {481}  find [unique] u_33 = ri_21 <= qH2 suchthat defined(x1_2[ri_21], x_O_3[ri_21], r_9[ri_21]) && {485}(x_O_5 = x1_2[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          let x_Oeq_1: bitstring = tcbi_t2bitstring(tcbi_QE) in
{1045}    find [unique] u_27 = ri_15 <= qH2 suchthat defined(x1_2[ri_15], x_O_3[ri_15], r_9[ri_15]) && {1049}(x_Oeq_1 = x1_2[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(x_O_5[ri_13], r_11[ri_13]) && {1222}(x_Oeq_1 = x_O_5[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          let x_Oeq_2: bitstring = tcbi_t2bitstring(tcbi_QE) in
{1409}    find [unique] u_30 = ri_18 <= qH2 suchthat defined(x1_2[ri_18], x_O_3[ri_18], r_9[ri_18]) && {1413}(x_Oeq_2 = x1_2[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(x_O_5[ri_16], r_11[ri_16]) && {1586}(x_Oeq_2 = x_O_5[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Replaced (x_Oeq_2 = x_O_5[ri_16]) with (tcbi_QE = tcbi_CPU[ri_16]) at 1586
    - Replaced defined condition x_O_5[ri_16], r_11[ri_16] with r_11[ri_16], tcbi_CPU[ri_16] in find at 1409
    - Replaced (x_Oeq_2 = x1_2[ri_18]) with (tcbi_QE = x222[ri_18]) at 1413
    - Replaced defined condition x1_2[ri_18], x_O_3[ri_18], r_9[ri_18] with r_9[ri_18], x222[ri_18] in find at 1409
    - Replaced (x_Oeq_1 = x_O_5[ri_13]) with (tcbi_QE = tcbi_CPU[ri_13]) at 1222
    - Replaced defined condition x_O_5[ri_13], r_11[ri_13] with r_11[ri_13], tcbi_CPU[ri_13] in find at 1045
    - Replaced (x_Oeq_1 = x1_2[ri_15]) with (tcbi_QE = x222[ri_15]) at 1049
    - Replaced defined condition x1_2[ri_15], x_O_3[ri_15], r_9[ri_15] with r_9[ri_15], x222[ri_15] in find at 1045
    - Replaced (x_O_5 = x1_2[ri_21]) with (tcbi_CPU = x222[ri_21]) at 485
    - Replaced defined condition x1_2[ri_21], x_O_3[ri_21], r_9[ri_21] with r_9[ri_21], x222[ri_21] in find at 481
    - Replaced defined condition x1_2[ri_23], x_O_4[ri_23], r_10[ri_23] with r_10[ri_23], x1_2[ri_23] in find at 211
    - Replaced (x1_2 = x_O_5[ri_25]) with (x222 = tcbi_CPU[ri_25]) at 191
    - Replaced defined condition x_O_5[ri_25], r_11[ri_25] with r_11[ri_25], tcbi_CPU[ri_25] in find at 174
    - Replaced (x1_2 = x1_2[ri_27]) with (x222 = x222[ri_27]) at 178
    - Replaced defined condition x1_2[ri_27], x_O_3[ri_27], r_9[ri_27] with r_9[ri_27], x222[ri_27] in find at 174
yields

Game 25 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
        (
          let x_O_3: bitstring = cst_bitstring in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        )
        else
          let x_O_4: bitstring = cst_bitstring in
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let res1_CPU: res_t = get_res in
        let csvn_CPU: csvn_t = get_csvn in
        let tcbi_CPU: tcbi_t = get_tcbi in
        let res2_CPU: res_t = get_res in
        let x_O_5: bitstring = tcbi_t2bitstring(tcbi_CPU) in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          let x_Oeq_1: bitstring = tcbi_t2bitstring(tcbi_QE) in
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          let x_Oeq_2: bitstring = tcbi_t2bitstring(tcbi_QE) in
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying move all binders
  - Move assignment to x_Oeq_1
  - Move assignment to x_Oeq_2
  - Move assignment to x_O_5
  - Move assignment to res2_CPU
  - Move assignment to csvn_CPU
  - Move assignment to res1_CPU
  - Move assignment to x_O_4
  - Move assignment to x_O_3
yields

Game 26 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_7: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_7) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_8: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_8) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Rename variable r_7 into r_13, r_12
  - Rename variable r_8 into r_15, r_14
yields

Game 27 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let sk2: skey = skgen(k_2) in
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, sk2) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_12: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_12) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_13: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_13) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_14: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_14) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_15: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_15) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of binder sk2
  - Remove assignments on sk2 (definition removed, all usages removed)
yields

Game 28 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      let pk2: pkey = pkgen(k_2) in
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, skgen(k_2)) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_12: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_12) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_13: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_13) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_14: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_14) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_15: enc_seed;
              let m1: bitstring = enc_r(m_3, pk2, r_15) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of binder pk2
  - Remove assignments on pk2 (definition removed, all usages removed)
yields

Game 29 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_2: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec(m2, skgen(k_2)) in
        let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
        if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
        let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
        let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
        let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
        let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r_2: enc_seed;
        let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r_2) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_12: enc_seed;
              let m1: bitstring = enc_r(m_3, pkgen(k_2), r_12) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_13: enc_seed;
              let m1: bitstring = enc_r(m_3, pkgen(k_2), r_13) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_14: enc_seed;
              let m1: bitstring = enc_r(m_3, pkgen(k_2), r_14) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_15: enc_seed;
              let m1: bitstring = enc_r(m_3, pkgen(k_2), r_15) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying equivalence ind_cca2(enc) with r_12, r_2, k_2, r_13, r_14, r_15 [probability (qQE + qChallenger) * Penc(time(context for game 29) + time + (-1 + qChallenger + qQE) * time(enc_r, max(maxlength(game 29: m_2), maxlength(game 29: m_3))), qChallenger)]
  - Equivalence ind_cca2(enc) with variables: r_15 -> r1, r_14 -> r1, r_13 -> r1, r_12 -> r1, r_2 -> r2, k_2 -> r
yields

Game 30 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
  {27}  let injbot(quote_t2bitstring(quote_Ch: quote_t)) = (let m_5: bitstring = m2 in {31}find u_44 = ri_32 <= qChallenger suchthat defined(m2_1[ri_32], y[ri_32], x_1[ri_32]) && (y[ri_32] = pkgen2_1(k_4)) && (m_5 = m2_1[ri_32]) then injbot(x_1[u_44]) orfind u_43 = ri_31 <= qQE suchthat defined(m1_1[ri_31], x1[ri_31]) && (m_5 = m1_1[ri_31]) then injbot(x1[u_43]) orfind u_42 = ri_30 <= qQE suchthat defined(m1_2[ri_30], x1_3[ri_30]) && (m_5 = m1_2[ri_30]) then injbot(x1_3[u_42]) orfind u_41 = ri_29 <= qQE suchthat defined(m1_3[ri_29], x1_4[ri_29]) && (m_5 = m1_3[ri_29]) then injbot(x1_4[u_41]) orfind u_40 = ri_28 <= qQE suchthat defined(m1_4[ri_28], x1_5[ri_28]) && (m_5 = m1_4[ri_28]) then injbot(x1_5[u_40]) else dec2(m_5, skgen2_1(k_4))) in
  {99}  let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
 {102}  if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
 {110}  let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
 {113}  let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
 {116}  let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
 {119}  let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
        event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
        new session_key: key;
        let m_2: bitstring = key2bitstring(session_key) in
        new r3: enc_seed;
        new r2: enc_seed;
        let m2_Ch: bitstring = (let x_1: bitstring = m_2 in (let y: pkey = x1_Ch in {154}if defined(k_4) && (y = pkgen2_1(k_4)) then (let m2_1: bitstring = enc_r2(Z(x_1), y, r2) in m2_1) else enc_r(x_1, y, r3))) in
        out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_16: enc_seed;
              let m1: bitstring = (let x1: bitstring = m_3 in (let m1_1: bitstring = enc_r2(Z(x1), pkgen2_1(k_4), r_16) in m1_1)) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_17: enc_seed;
              let m1: bitstring = (let x1_3: bitstring = m_3 in (let m1_2: bitstring = enc_r2(Z(x1_3), pkgen2_1(k_4), r_17) in m1_2)) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_18: enc_seed;
              let m1: bitstring = (let x1_4: bitstring = m_3 in (let m1_3: bitstring = enc_r2(Z(x1_4), pkgen2_1(k_4), r_18) in m1_3)) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_19: enc_seed;
              let m1: bitstring = (let x1_5: bitstring = m_3 in (let m1_4: bitstring = enc_r2(Z(x1_5), pkgen2_1(k_4), r_19) in m1_4)) in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying expand [probability qTD * Penccoll]
  - Expand if/find/let
    - Transformed find at 154 into a test
    - Simplify pattern quote_t2bitstring(quote_Ch: quote_t) (tuple expanded), pattern injbot(quote_t2bitstring(quote_Ch: quote_t)) (tuple expanded) at 27
    - Simplify pattern quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) (tuple expanded) at 99
    - Test at 102 always true
    - Simplify pattern tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) (tuple expanded) at 110
    - Simplify pattern smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) (tuple expanded) at 113
    - Simplify pattern rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) (tuple expanded) at 116
    - Simplify pattern rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) (tuple expanded) at 119
    - Transformed find at 154 into a test
    - Test at 154 always false
    - Replaced defined condition m1_4[ri_28], x1_5[ri_28] with pk_TD[u_8[u_4[u_12[u[ri_28]]]]], rdata_other[u_8[u_4[u_12[u[ri_28]]]]], rtyp_QE[ri_28], res1_QE[ri_28], csvn_QE[ri_28], tdih_QE[ri_28], tcbh_QE[ri_28], rdata_QE[ri_28], res2_QE[ri_28], rms_without_mac_QE[ri_28], tcbi_QE[ri_28], smr_without_mac_QE[ri_28], res4_QE[ri_28], tdi_QE[ri_28], tdr_without_mac_QE[ri_28], sig_QE[ri_28], quote_QE[ri_28], m1_4[ri_28] in find at 31
    - Simplify pattern quote_t2bitstring(quote_Ch: quote_t) (tuple expanded), pattern injbot(quote_t2bitstring(quote_Ch: quote_t)) (tuple expanded) at 27
    - Simplify pattern quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) (tuple expanded) at 99
    - Test at 102 always true
    - Simplify pattern tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) (tuple expanded) at 110
    - Simplify pattern smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) (tuple expanded) at 113
    - Simplify pattern rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) (tuple expanded) at 116
    - Simplify pattern rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) (tuple expanded) at 119
    - Transformed find at 154 into a test
    - Test at 154 always false
    - Replaced defined condition m1_3[ri_29], x1_4[ri_29] with pk_TD[u_8[u_4[u_12[u[ri_29]]]]], rdata_other[u_8[u_4[u_12[u[ri_29]]]]], rtyp_QE[ri_29], res1_QE[ri_29], csvn_QE[ri_29], tdih_QE[ri_29], tcbh_QE[ri_29], rdata_QE[ri_29], res2_QE[ri_29], rms_without_mac_QE[ri_29], tcbi_QE[ri_29], smr_without_mac_QE[ri_29], res4_QE[ri_29], tdi_QE[ri_29], tdr_without_mac_QE[ri_29], sig_QE[ri_29], quote_QE[ri_29], m1_3[ri_29] in find at 31
    - Simplify pattern quote_t2bitstring(quote_Ch: quote_t) (tuple expanded), pattern injbot(quote_t2bitstring(quote_Ch: quote_t)) (tuple expanded) at 27
    - Simplify pattern quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) (tuple expanded) at 99
    - Test at 102 always true
    - Simplify pattern tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) (tuple expanded) at 110
    - Simplify pattern smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) (tuple expanded) at 113
    - Simplify pattern rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) (tuple expanded) at 116
    - Simplify pattern rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) (tuple expanded) at 119
    - Transformed find at 154 into a test
    - Test at 154 always false
    - Replaced defined condition m1_2[ri_30], x1_3[ri_30] with pk_TD[u_8[u_4[u_12[u[ri_30]]]]], rdata_other[u_8[u_4[u_12[u[ri_30]]]]], rtyp_QE[ri_30], res1_QE[ri_30], csvn_QE[ri_30], tdih_QE[ri_30], tcbh_QE[ri_30], rdata_QE[ri_30], res2_QE[ri_30], rms_without_mac_QE[ri_30], tcbi_QE[ri_30], smr_without_mac_QE[ri_30], res4_QE[ri_30], tdi_QE[ri_30], tdr_without_mac_QE[ri_30], sig_QE[ri_30], quote_QE[ri_30], m1_2[ri_30] in find at 31
    - Simplify pattern quote_t2bitstring(quote_Ch: quote_t) (tuple expanded), pattern injbot(quote_t2bitstring(quote_Ch: quote_t)) (tuple expanded) at 27
    - Simplify pattern quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) (tuple expanded) at 99
    - Test at 102 always true
    - Simplify pattern tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) (tuple expanded) at 110
    - Simplify pattern smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) (tuple expanded) at 113
    - Simplify pattern rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) (tuple expanded) at 116
    - Simplify pattern rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) (tuple expanded) at 119
    - Transformed find at 154 into a test
    - Test at 154 always false
    - Replaced defined condition m1_1[ri_31], x1[ri_31] with pk_TD[u_8[u_4[u_12[u[ri_31]]]]], rdata_other[u_8[u_4[u_12[u[ri_31]]]]], rtyp_QE[ri_31], res1_QE[ri_31], csvn_QE[ri_31], tdih_QE[ri_31], tcbh_QE[ri_31], rdata_QE[ri_31], res2_QE[ri_31], rms_without_mac_QE[ri_31], tcbi_QE[ri_31], smr_without_mac_QE[ri_31], res4_QE[ri_31], tdi_QE[ri_31], tdr_without_mac_QE[ri_31], sig_QE[ri_31], quote_QE[ri_31], m1_1[ri_31] in find at 31
    - Simplify pattern injbot(quote_t2bitstring(quote_Ch: quote_t)) (tuple expanded) at 27
    - Transformed find at 154 into a test
yields

Game 31 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        let m_5: bitstring = m2 in
        find u_44 = ri_32 <= qChallenger suchthat defined(m2_1[ri_32], y[ri_32], x_1[ri_32]) && (y[ri_32] = pkgen2_1(k_4)) && (m_5 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = x_1[u_44] in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if y = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Z(x_1), y, r2) in
            let m2_Ch: bitstring = m2_1 in
            out(c23[i], m2_Ch)
          )
          else
            let m2_Ch: bitstring = enc_r(x_1, y, r3) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], rdata_other[u_8[u_4[u_12[u[ri_31]]]]], rtyp_QE[ri_31], res1_QE[ri_31], csvn_QE[ri_31], tdih_QE[ri_31], tcbh_QE[ri_31], rdata_QE[ri_31], res2_QE[ri_31], rms_without_mac_QE[ri_31], tcbi_QE[ri_31], smr_without_mac_QE[ri_31], res4_QE[ri_31], tdi_QE[ri_31], tdr_without_mac_QE[ri_31], sig_QE[ri_31], quote_QE[ri_31], m1_1[ri_31]) && (m_5 = m1_1[ri_31]) then
        (
          let quote_Ch: quote_t = quote_QE[u_43] in
          let sig_Ch: signature = sig_QE[u_43] in
          let tdr_without_mac_Ch: tdr_without_mac_t = tdr_without_mac_QE[u_43] in
          let tdi_Ch: tdi_t = tdi_QE[u_43] in
          let res4_Ch: res_t = res4_QE[u_43] in
          let smr_without_mac_Ch: smr_without_mac_t = smr_without_mac_QE[u_43] in
          let tcbi_Ch: tcbi_t = tcbi_QE[u_43] in
          let rms_without_mac_Ch: rms_without_mac_t = rms_without_mac_QE[u_43] in
          let res2_Ch: res_t = res2_QE[u_43] in
          let rdata_Ch: rdata_t = rdata_QE[u_43] in
          let tcbh_CH: hashoutput2 = tcbh_QE[u_43] in
          let tdih_Ch: hashoutput1 = tdih_QE[u_43] in
          let csvn_Ch: csvn_t = csvn_QE[u_43] in
          let res1_Ch: res_t = res1_QE[u_43] in
          let rtyp_Ch: rtyp_t = rtyp_QE[u_43] in
          let y1_Ch: user_data_t = rdata_other[u_8[u_4[u_12[u[u_43]]]]] in
          let x1_Ch: pkey = pk_TD[u_8[u_4[u_12[u[u_43]]]]] in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          let m2_Ch: bitstring = enc_r(x_1, y, r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], rdata_other[u_8[u_4[u_12[u[ri_30]]]]], rtyp_QE[ri_30], res1_QE[ri_30], csvn_QE[ri_30], tdih_QE[ri_30], tcbh_QE[ri_30], rdata_QE[ri_30], res2_QE[ri_30], rms_without_mac_QE[ri_30], tcbi_QE[ri_30], smr_without_mac_QE[ri_30], res4_QE[ri_30], tdi_QE[ri_30], tdr_without_mac_QE[ri_30], sig_QE[ri_30], quote_QE[ri_30], m1_2[ri_30]) && (m_5 = m1_2[ri_30]) then
        (
          let quote_Ch: quote_t = quote_QE[u_42] in
          let sig_Ch: signature = sig_QE[u_42] in
          let tdr_without_mac_Ch: tdr_without_mac_t = tdr_without_mac_QE[u_42] in
          let tdi_Ch: tdi_t = tdi_QE[u_42] in
          let res4_Ch: res_t = res4_QE[u_42] in
          let smr_without_mac_Ch: smr_without_mac_t = smr_without_mac_QE[u_42] in
          let tcbi_Ch: tcbi_t = tcbi_QE[u_42] in
          let rms_without_mac_Ch: rms_without_mac_t = rms_without_mac_QE[u_42] in
          let res2_Ch: res_t = res2_QE[u_42] in
          let rdata_Ch: rdata_t = rdata_QE[u_42] in
          let tcbh_CH: hashoutput2 = tcbh_QE[u_42] in
          let tdih_Ch: hashoutput1 = tdih_QE[u_42] in
          let csvn_Ch: csvn_t = csvn_QE[u_42] in
          let res1_Ch: res_t = res1_QE[u_42] in
          let rtyp_Ch: rtyp_t = rtyp_QE[u_42] in
          let y1_Ch: user_data_t = rdata_other[u_8[u_4[u_12[u[u_42]]]]] in
          let x1_Ch: pkey = pk_TD[u_8[u_4[u_12[u[u_42]]]]] in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          let m2_Ch: bitstring = enc_r(x_1, y, r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], rdata_other[u_8[u_4[u_12[u[ri_29]]]]], rtyp_QE[ri_29], res1_QE[ri_29], csvn_QE[ri_29], tdih_QE[ri_29], tcbh_QE[ri_29], rdata_QE[ri_29], res2_QE[ri_29], rms_without_mac_QE[ri_29], tcbi_QE[ri_29], smr_without_mac_QE[ri_29], res4_QE[ri_29], tdi_QE[ri_29], tdr_without_mac_QE[ri_29], sig_QE[ri_29], quote_QE[ri_29], m1_3[ri_29]) && (m_5 = m1_3[ri_29]) then
        (
          let quote_Ch: quote_t = quote_QE[u_41] in
          let sig_Ch: signature = sig_QE[u_41] in
          let tdr_without_mac_Ch: tdr_without_mac_t = tdr_without_mac_QE[u_41] in
          let tdi_Ch: tdi_t = tdi_QE[u_41] in
          let res4_Ch: res_t = res4_QE[u_41] in
          let smr_without_mac_Ch: smr_without_mac_t = smr_without_mac_QE[u_41] in
          let tcbi_Ch: tcbi_t = tcbi_QE[u_41] in
          let rms_without_mac_Ch: rms_without_mac_t = rms_without_mac_QE[u_41] in
          let res2_Ch: res_t = res2_QE[u_41] in
          let rdata_Ch: rdata_t = rdata_QE[u_41] in
          let tcbh_CH: hashoutput2 = tcbh_QE[u_41] in
          let tdih_Ch: hashoutput1 = tdih_QE[u_41] in
          let csvn_Ch: csvn_t = csvn_QE[u_41] in
          let res1_Ch: res_t = res1_QE[u_41] in
          let rtyp_Ch: rtyp_t = rtyp_QE[u_41] in
          let y1_Ch: user_data_t = rdata_other[u_8[u_4[u_12[u[u_41]]]]] in
          let x1_Ch: pkey = pk_TD[u_8[u_4[u_12[u[u_41]]]]] in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          let m2_Ch: bitstring = enc_r(x_1, y, r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], rdata_other[u_8[u_4[u_12[u[ri_28]]]]], rtyp_QE[ri_28], res1_QE[ri_28], csvn_QE[ri_28], tdih_QE[ri_28], tcbh_QE[ri_28], rdata_QE[ri_28], res2_QE[ri_28], rms_without_mac_QE[ri_28], tcbi_QE[ri_28], smr_without_mac_QE[ri_28], res4_QE[ri_28], tdi_QE[ri_28], tdr_without_mac_QE[ri_28], sig_QE[ri_28], quote_QE[ri_28], m1_4[ri_28]) && (m_5 = m1_4[ri_28]) then
        (
          let quote_Ch: quote_t = quote_QE[u_40] in
          let sig_Ch: signature = sig_QE[u_40] in
          let tdr_without_mac_Ch: tdr_without_mac_t = tdr_without_mac_QE[u_40] in
          let tdi_Ch: tdi_t = tdi_QE[u_40] in
          let res4_Ch: res_t = res4_QE[u_40] in
          let smr_without_mac_Ch: smr_without_mac_t = smr_without_mac_QE[u_40] in
          let tcbi_Ch: tcbi_t = tcbi_QE[u_40] in
          let rms_without_mac_Ch: rms_without_mac_t = rms_without_mac_QE[u_40] in
          let res2_Ch: res_t = res2_QE[u_40] in
          let rdata_Ch: rdata_t = rdata_QE[u_40] in
          let tcbh_CH: hashoutput2 = tcbh_QE[u_40] in
          let tdih_Ch: hashoutput1 = tdih_QE[u_40] in
          let csvn_Ch: csvn_t = csvn_QE[u_40] in
          let res1_Ch: res_t = res1_QE[u_40] in
          let rtyp_Ch: rtyp_t = rtyp_QE[u_40] in
          let y1_Ch: user_data_t = rdata_other[u_8[u_4[u_12[u[u_40]]]]] in
          let x1_Ch: pkey = pk_TD[u_8[u_4[u_12[u[u_40]]]]] in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          let m2_Ch: bitstring = enc_r(x_1, y, r3) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m_5, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if y = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Z(x_1), y, r2) in
            let m2_Ch: bitstring = m2_1 in
            out(c23[i], m2_Ch)
          )
          else
            let m2_Ch: bitstring = enc_r(x_1, y, r3) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
          find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_16: enc_seed;
              let x1: bitstring = m_3 in
              let m1_1: bitstring = enc_r2(Z(x1), pkgen2_1(k_4), r_16) in
              let m1: bitstring = m1_1 in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_17: enc_seed;
              let x1_3: bitstring = m_3 in
              let m1_2: bitstring = enc_r2(Z(x1_3), pkgen2_1(k_4), r_17) in
              let m1: bitstring = m1_2 in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_18: enc_seed;
              let x1_4: bitstring = m_3 in
              let m1_3: bitstring = enc_r2(Z(x1_4), pkgen2_1(k_4), r_18) in
              let m1: bitstring = m1_3 in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_19: enc_seed;
              let x1_5: bitstring = m_3 in
              let m1_4: bitstring = enc_r2(Z(x1_5), pkgen2_1(k_4), r_19) in
              let m1: bitstring = m1_4 in
              out(c19[i_4], m1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on x1 (definition removed, all usages removed)
  - Remove assignments on m1 (definition removed, all usages removed)
  - Remove assignments on x1_3 (definition removed, all usages removed)
  - Remove assignments on m1 (definition removed, all usages removed)
  - Remove assignments on x1_4 (definition removed, all usages removed)
  - Remove assignments on m1 (definition removed, all usages removed)
  - Remove assignments on x1_5 (definition removed, all usages removed)
  - Remove assignments on m1 (definition removed, all usages removed)
  - Remove assignments on m_5 (definition removed, all usages removed)
  - Remove assignments on m2_Ch (definition removed, all usages removed)
  - Remove assignments on y (definition kept, array references kept)
  - Remove assignments on x_1 (definition kept, array references kept)
  - Remove assignments on m2_Ch (definition removed, all usages removed)
  - Remove assignments on y (definition kept, array references kept)
  - Remove assignments on x_1 (definition kept, array references kept)
  - Remove assignments on quote_Ch (definition removed, all usages removed)
  - Remove assignments on sig_Ch (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tdi_Ch (definition removed, all usages removed)
  - Remove assignments on res4_Ch (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tcbi_Ch (definition removed, all usages removed)
  - Remove assignments on rms_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on res2_Ch (definition removed, all usages removed)
  - Remove assignments on rdata_Ch (definition removed, all usages removed)
  - Remove assignments on tcbh_CH (definition removed, all usages removed)
  - Remove assignments on tdih_Ch (definition removed, all usages removed)
  - Remove assignments on csvn_Ch (definition removed, all usages removed)
  - Remove assignments on res1_Ch (definition removed, all usages removed)
  - Remove assignments on rtyp_Ch (definition removed, all usages removed)
  - Remove assignments on y1_Ch (definition removed, all usages removed)
  - Remove assignments on x1_Ch (definition removed, all usages removed)
  - Remove assignments on y (definition kept, array references kept)
  - Remove assignments on x_1 (definition kept, array references kept)
  - Remove assignments on quote_Ch (definition removed, all usages removed)
  - Remove assignments on sig_Ch (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tdi_Ch (definition removed, all usages removed)
  - Remove assignments on res4_Ch (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tcbi_Ch (definition removed, all usages removed)
  - Remove assignments on rms_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on res2_Ch (definition removed, all usages removed)
  - Remove assignments on rdata_Ch (definition removed, all usages removed)
  - Remove assignments on tcbh_CH (definition removed, all usages removed)
  - Remove assignments on tdih_Ch (definition removed, all usages removed)
  - Remove assignments on csvn_Ch (definition removed, all usages removed)
  - Remove assignments on res1_Ch (definition removed, all usages removed)
  - Remove assignments on rtyp_Ch (definition removed, all usages removed)
  - Remove assignments on y1_Ch (definition removed, all usages removed)
  - Remove assignments on x1_Ch (definition removed, all usages removed)
  - Remove assignments on y (definition kept, array references kept)
  - Remove assignments on x_1 (definition kept, array references kept)
  - Remove assignments on quote_Ch (definition removed, all usages removed)
  - Remove assignments on sig_Ch (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tdi_Ch (definition removed, all usages removed)
  - Remove assignments on res4_Ch (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tcbi_Ch (definition removed, all usages removed)
  - Remove assignments on rms_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on res2_Ch (definition removed, all usages removed)
  - Remove assignments on rdata_Ch (definition removed, all usages removed)
  - Remove assignments on tcbh_CH (definition removed, all usages removed)
  - Remove assignments on tdih_Ch (definition removed, all usages removed)
  - Remove assignments on csvn_Ch (definition removed, all usages removed)
  - Remove assignments on res1_Ch (definition removed, all usages removed)
  - Remove assignments on rtyp_Ch (definition removed, all usages removed)
  - Remove assignments on y1_Ch (definition removed, all usages removed)
  - Remove assignments on x1_Ch (definition removed, all usages removed)
  - Remove assignments on y (definition kept, array references kept)
  - Remove assignments on x_1 (definition kept, array references kept)
  - Remove assignments on quote_Ch (definition removed, all usages removed)
  - Remove assignments on sig_Ch (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tdi_Ch (definition removed, all usages removed)
  - Remove assignments on res4_Ch (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on tcbi_Ch (definition removed, all usages removed)
  - Remove assignments on rms_without_mac_Ch (definition removed, all usages removed)
  - Remove assignments on res2_Ch (definition removed, all usages removed)
  - Remove assignments on rdata_Ch (definition removed, all usages removed)
  - Remove assignments on tcbh_CH (definition removed, all usages removed)
  - Remove assignments on tdih_Ch (definition removed, all usages removed)
  - Remove assignments on csvn_Ch (definition removed, all usages removed)
  - Remove assignments on res1_Ch (definition removed, all usages removed)
  - Remove assignments on rtyp_Ch (definition removed, all usages removed)
  - Remove assignments on y1_Ch (definition removed, all usages removed)
  - Remove assignments on x1_Ch (definition removed, all usages removed)
  - Remove assignments on y (definition kept, array references kept)
  - Remove assignments on x_1 (definition kept, array references kept)
yields

Game 32 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
  {27}  find u_44 = ri_32 <= qChallenger suchthat defined(m2_1[ri_32], y[ri_32], x_1[ri_32]) && {31}((y[ri_32] = pkgen2_1(k_4)) && (m2 = m2_1[ri_32])) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = {43}x_1[u_44] in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = {107}enc_r2(Z(m_2), x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], rdata_other[u_8[u_4[u_12[u[ri_31]]]]], rtyp_QE[ri_31], res1_QE[ri_31], csvn_QE[ri_31], tdih_QE[ri_31], tcbh_QE[ri_31], rdata_QE[ri_31], res2_QE[ri_31], rms_without_mac_QE[ri_31], tcbi_QE[ri_31], smr_without_mac_QE[ri_31], res4_QE[ri_31], tdi_QE[ri_31], tdr_without_mac_QE[ri_31], sig_QE[ri_31], quote_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
 {207}    new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_43]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], rdata_other[u_8[u_4[u_12[u[ri_30]]]]], rtyp_QE[ri_30], res1_QE[ri_30], csvn_QE[ri_30], tdih_QE[ri_30], tcbh_QE[ri_30], rdata_QE[ri_30], res2_QE[ri_30], rms_without_mac_QE[ri_30], tcbi_QE[ri_30], smr_without_mac_QE[ri_30], res4_QE[ri_30], tdi_QE[ri_30], tdr_without_mac_QE[ri_30], sig_QE[ri_30], quote_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
 {303}    new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_42]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], rdata_other[u_8[u_4[u_12[u[ri_29]]]]], rtyp_QE[ri_29], res1_QE[ri_29], csvn_QE[ri_29], tdih_QE[ri_29], tcbh_QE[ri_29], rdata_QE[ri_29], res2_QE[ri_29], rms_without_mac_QE[ri_29], tcbi_QE[ri_29], smr_without_mac_QE[ri_29], res4_QE[ri_29], tdi_QE[ri_29], tdr_without_mac_QE[ri_29], sig_QE[ri_29], quote_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
 {399}    new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_41]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], rdata_other[u_8[u_4[u_12[u[ri_28]]]]], rtyp_QE[ri_28], res1_QE[ri_28], csvn_QE[ri_28], tdih_QE[ri_28], tcbh_QE[ri_28], rdata_QE[ri_28], res2_QE[ri_28], rms_without_mac_QE[ri_28], tcbi_QE[ri_28], smr_without_mac_QE[ri_28], res4_QE[ri_28], tdi_QE[ri_28], tdr_without_mac_QE[ri_28], sig_QE[ri_28], quote_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
 {495}    new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_40]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = {596}enc_r2(Z(m_2), x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
{1564}  find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
        (
{1572}    find [unique] u_27 = ri_15 <= qH2 suchthat defined(r_9[ri_15], x222[ri_15]) && (tcbi_QE = x222[ri_15]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_16: enc_seed;
              let m1_1: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_16) in
              out(c19[i_4], m1_1)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_25 = ri_13 <= qCPU suchthat defined(r_11[ri_13], tcbi_CPU[ri_13]) && (tcbi_QE = tcbi_CPU[ri_13]) then
          (
            if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_17: enc_seed;
              let m1_2: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_17) in
              out(c19[i_4], m1_2)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
          find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_18: enc_seed;
              let m1_3: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_18) in
              out(c19[i_4], m1_3)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_19: enc_seed;
              let m1_4: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_19) in
              out(c19[i_4], m1_4)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Simplified find at 1572 in branch of find at 1564
    - Replaced enc_r2(Z(m_2), x1_Ch, r2) with enc_r2(Zkey, x1_Ch, r2) at 596
    - Remove random number generation at 495
    - Replaced defined condition pk_TD[u_8[u_4[u_12[u[ri_28]]]]], rdata_other[u_8[u_4[u_12[u[ri_28]]]]], rtyp_QE[ri_28], res1_QE[ri_28], csvn_QE[ri_28], tdih_QE[ri_28], tcbh_QE[ri_28], rdata_QE[ri_28], res2_QE[ri_28], rms_without_mac_QE[ri_28], tcbi_QE[ri_28], smr_without_mac_QE[ri_28], res4_QE[ri_28], tdi_QE[ri_28], tdr_without_mac_QE[ri_28], sig_QE[ri_28], quote_QE[ri_28], m1_4[ri_28] with pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28] in find at 27
    - Remove random number generation at 399
    - Replaced defined condition pk_TD[u_8[u_4[u_12[u[ri_29]]]]], rdata_other[u_8[u_4[u_12[u[ri_29]]]]], rtyp_QE[ri_29], res1_QE[ri_29], csvn_QE[ri_29], tdih_QE[ri_29], tcbh_QE[ri_29], rdata_QE[ri_29], res2_QE[ri_29], rms_without_mac_QE[ri_29], tcbi_QE[ri_29], smr_without_mac_QE[ri_29], res4_QE[ri_29], tdi_QE[ri_29], tdr_without_mac_QE[ri_29], sig_QE[ri_29], quote_QE[ri_29], m1_3[ri_29] with pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29] in find at 27
    - Remove random number generation at 303
    - Replaced defined condition pk_TD[u_8[u_4[u_12[u[ri_30]]]]], rdata_other[u_8[u_4[u_12[u[ri_30]]]]], rtyp_QE[ri_30], res1_QE[ri_30], csvn_QE[ri_30], tdih_QE[ri_30], tcbh_QE[ri_30], rdata_QE[ri_30], res2_QE[ri_30], rms_without_mac_QE[ri_30], tcbi_QE[ri_30], smr_without_mac_QE[ri_30], res4_QE[ri_30], tdi_QE[ri_30], tdr_without_mac_QE[ri_30], sig_QE[ri_30], quote_QE[ri_30], m1_2[ri_30] with pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30] in find at 27
    - Remove random number generation at 207
    - Replaced defined condition pk_TD[u_8[u_4[u_12[u[ri_31]]]]], rdata_other[u_8[u_4[u_12[u[ri_31]]]]], rtyp_QE[ri_31], res1_QE[ri_31], csvn_QE[ri_31], tdih_QE[ri_31], tcbh_QE[ri_31], rdata_QE[ri_31], res2_QE[ri_31], rms_without_mac_QE[ri_31], tcbi_QE[ri_31], smr_without_mac_QE[ri_31], res4_QE[ri_31], tdi_QE[ri_31], tdr_without_mac_QE[ri_31], sig_QE[ri_31], quote_QE[ri_31], m1_1[ri_31] with pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31] in find at 27
    - Replaced ((y[ri_32] = pkgen2_1(k_4)) && (m2 = m2_1[ri_32])) with (m2 = m2_1[ri_32]) at 31
    - Replaced x_1[u_44] with key2bitstring(session_key[u_44]) at 43
    - Replaced enc_r2(Z(m_2), x1_Ch, r2) with enc_r2(Zkey, x1_Ch, r2) at 107
    - Replaced defined condition m2_1[ri_32], y[ri_32], x_1[ri_32] with session_key[ri_32], m2_1[ri_32] in find at 27
yields

Game 33 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_43]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_42]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_41]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_40]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
{1498}  find [unique] u_15 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_15 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
        (
{1872}    find [unique] u_30 = ri_18 <= qH2 suchthat defined(r_9[ri_18], x222[ri_18]) && (tcbi_QE = x222[ri_18]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_18: enc_seed;
              let m1_3: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_18) in
              out(c19[i_4], m1_3)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          orfind u_28 = ri_16 <= qCPU suchthat defined(r_11[ri_16], tcbi_CPU[ri_16]) && (tcbi_QE = tcbi_CPU[ri_16]) then
          (
            if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t in
              out(c15[i_4], ());
              in(c18[i_4], ());
              find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
              event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
              event QEaccepted2_14(smr_QE, tdi_QE);
              let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
              let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
              let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
              let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
              let m_3: bitstring = quote_t2bitstring(quote_QE) in
              new r_19: enc_seed;
              let m1_4: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_19) in
              out(c19[i_4], m1_4)
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Simplified find at 1872 in branch of find at 1498
yields

Game 34 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_43]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_42]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_41]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_40]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_15 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_13 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_13]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_13 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying SA rename u_13
  - Rename variable u_13 into u_47, u_46, u_45
yields

Game 35 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_43]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_42]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_41]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = pk_TD[u_8[u_4[u_12[u[u_40]]]]] in
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3: enc_seed;
          new r2: enc_seed;
          let x_1: bitstring = m_2 in
          let y: pkey = x1_Ch in
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_15 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Z(m_3), pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on x_1 (definition removed, all usages removed)
  - Remove assignments on y (definition removed, all usages removed)
  - Remove assignments on x_1 (definition removed, all usages removed)
  - Remove assignments on y (definition removed, all usages removed)
  - Remove assignments on x_1 (definition removed, all usages removed)
  - Remove assignments on y (definition removed, all usages removed)
  - Remove assignments on x_1 (definition removed, all usages removed)
  - Remove assignments on y (definition removed, all usages removed)
  - Remove assignments on x_1 (definition removed, all usages removed)
  - Remove assignments on y (definition removed, all usages removed)
  - Remove assignments on x_1 (definition removed, all usages removed)
  - Remove assignments on y (definition removed, all usages removed)
  - Rename variable r2 into r2_2, r2_1
  - Rename variable r3 into r3_6, r3_5, r3_4, r3_3, r3_2, r3_1
yields

Game 36 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_2: enc_seed;
          new r2_2: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_1: enc_seed;
          new r2_1: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_16: enc_seed;
            let m1_1: bitstring = {1589}enc_r2(Z(m_3), pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_15 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_17: enc_seed;
            let m1_2: bitstring = {1772}enc_r2(Z(m_3), pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_18: enc_seed;
            let m1_3: bitstring = {1955}enc_r2(Z(m_3), pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_19: enc_seed;
            let m1_4: bitstring = {2138}enc_r2(Z(m_3), pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Replaced enc_r2(Z(m_3), pkgen2_1(k_4), r_19) with enc_r2(Zkey, pkgen2_1(k_4), r_19) at 2138
    - Replaced enc_r2(Z(m_3), pkgen2_1(k_4), r_18) with enc_r2(Zkey, pkgen2_1(k_4), r_18) at 1955
    - Replaced enc_r2(Z(m_3), pkgen2_1(k_4), r_17) with enc_r2(Zkey, pkgen2_1(k_4), r_17) at 1772
    - Replaced enc_r2(Z(m_3), pkgen2_1(k_4), r_16) with enc_r2(Zkey, pkgen2_1(k_4), r_16) at 1589
yields

Game 37 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_2: enc_seed;
          new r2_2: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_1: enc_seed;
          new r2_1: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_15 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_15 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_15]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            find [unique] u_15 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying SA rename u_15
  - Rename variable u_15 into u_50, u_49, u_48
yields

Game 38 is
      in(start, ());
      new ks: skeyseed;
      let ssk1: sskey = sskgen(ks) in
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_2: enc_seed;
          new r2_2: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_1: enc_seed;
          new r2_1: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            let smr_without_mac_QE: smr_without_mac_t = smr_without_mac_f(rms_without_mac_QE, tcbi_QE) in
            let tdr_without_mac_QE: tdr_without_mac_t = tdr_without_mac_f(smr_without_mac_QE, res4_QE, tdi_QE) in
            let sig_QE: signature = sign(tdr_without_mac_t2bitstring(tdr_without_mac_QE), ssk1) in
            let quote_QE: quote_t = quote_f(tdr_without_mac_QE, sig_QE) in
            let m_3: bitstring = quote_t2bitstring(quote_QE) in
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            find [unique] u_50 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on m_3 (definition removed, all usages removed)
  - Remove assignments on m_3 (definition removed, all usages removed)
  - Remove assignments on m_3 (definition removed, all usages removed)
  - Remove assignments on m_3 (definition removed, all usages removed)
  - Remove assignments on quote_QE (definition removed, all usages removed)
  - Remove assignments on quote_QE (definition removed, all usages removed)
  - Remove assignments on quote_QE (definition removed, all usages removed)
  - Remove assignments on quote_QE (definition removed, all usages removed)
  - Remove assignments on sig_QE (definition removed, all usages removed)
  - Remove assignments on sig_QE (definition removed, all usages removed)
  - Remove assignments on sig_QE (definition removed, all usages removed)
  - Remove assignments on sig_QE (definition removed, all usages removed)
  - Remove assignments on ssk1 (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_QE (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_QE (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_QE (definition removed, all usages removed)
  - Remove assignments on tdr_without_mac_QE (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_QE (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_QE (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_QE (definition removed, all usages removed)
  - Remove assignments on smr_without_mac_QE (definition removed, all usages removed)
yields

Game 39 is
      in(start, ());
      new ks: skeyseed;
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_2: enc_seed;
          new r2_2: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_1: enc_seed;
          new r2_1: enc_seed;
          if x1_Ch = pkgen2_1(k_4) then
          (
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            out(c23[i], m2_1)
          )
          else
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            find [unique] u_50 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying move all binders
  - Move random number generation r2_1
  - Move random number generation r3_1
  - Move assignment to m_2
  - Move random number generation session_key
  - Move random number generation r2_2
  - Move random number generation r3_2
  - Move assignment to m_2
  - Move random number generation session_key
yields

Game 40 is
      in(start, ());
      new ks: skeyseed;
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_2: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_2: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_1: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_1: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
{2026}      find [unique] u_50 = ri_3 <= qH1 suchthat defined(r_4[ri_3], x111[ri_3]) && (tdi_QE = x111[ri_3]) then
            (
              let mes_QE_CPU_1: rms_t = cst_rms_t
            )
            else
              let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying merge branches
  - Merge all branches of find at 2026
yields

Game 41 is
      in(start, ());
      new ks: skeyseed;
      let spk1: spkey = spkgen(ks) in
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_2: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_2: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spk1, sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_1: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_1: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of binder spk1
  - Remove assignments on spk1 (definition removed, all usages removed)
yields

Game 42 is
      in(start, ());
      new ks: skeyseed;
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spkgen(ks), sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_2: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_2: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if verify(tdr_without_mac_t2bitstring(tdr_without_mac_Ch), spkgen(ks), sig_Ch) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_1: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_1: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying equivalence uf_cma(sign) with ks [probability Psign(time(context for game 42) + time + (-1 + qChallenger) * time(verify, length(tdr_without_mac_t2bitstring)), 0, -inf)]
  - Equivalence uf_cma(sign) with variables: ks -> r
yields

Game 43 is
      in(start, ());
      new ks: skeyseed;
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
          let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if (let m1_6: bitstring = tdr_without_mac_t2bitstring(tdr_without_mac_Ch) in (let si1_1: signature = sig_Ch in {45}find  else false)) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_2: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_2: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
          let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
          let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
          if (let m1_5: bitstring = tdr_without_mac_t2bitstring(tdr_without_mac_Ch) in (let si1: signature = sig_Ch in {419}find  else false)) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_1: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_1: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify (non-expanded game)
  - Simplification pass
    - Find at 45 removed (else branch kept if any)
    - Find at 419 removed (else branch kept if any)
yields

Game 44 is
      in(start, ());
      new ks: skeyseed;
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
        (
  {29}    let quote_t2bitstring(quote_Ch: quote_t) = key2bitstring(session_key[u_44]) in
  {34}    let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
  {37}    if {38}(let m1_6: bitstring = tdr_without_mac_t2bitstring(tdr_without_mac_Ch) in {42}(let si1_1: signature = sig_Ch in false)) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_2: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_2) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_2: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_2) in
            out(c23[i], m2_Ch)
        )
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
        else
 {401}    let injbot(quote_t2bitstring(quote_Ch: quote_t)) = dec2(m2, skgen2_1(k_4)) in
 {407}    let quote_f(tdr_without_mac_Ch: tdr_without_mac_t, sig_Ch: signature) = quote_Ch in
 {410}    if {411}(let m1_5: bitstring = tdr_without_mac_t2bitstring(tdr_without_mac_Ch) in {415}(let si1: signature = sig_Ch in false)) then
          let tdr_without_mac_f(smr_without_mac_Ch: smr_without_mac_t, res4_Ch: res_t, tdi_Ch: tdi_t) = tdr_without_mac_Ch in
          let smr_without_mac_f(rms_without_mac_Ch: rms_without_mac_t, tcbi_Ch: tcbi_t) = smr_without_mac_Ch in
          let rms_without_mac_f(rtyp_Ch: rtyp_t, res1_Ch: res_t, csvn_Ch: csvn_t, tdih_Ch: hashoutput1, tcbh_CH: hashoutput2, rdata_Ch: rdata_t, res2_Ch: res_t) = rms_without_mac_Ch in
          let rdata_f(x1_Ch: pkey, y1_Ch: user_data_t) = rdata_Ch in
          event QuoteVerified(rtyp_Ch, res1_Ch, csvn_Ch, tdih_Ch, tcbh_CH, rdata_Ch, res2_Ch);
          if x1_Ch = pkgen2_1(k_4) then
          (
            new r2_1: enc_seed;
            let m2_1: bitstring = enc_r2(Zkey, x1_Ch, r2_1) in
            new session_key: key;
            out(c23[i], m2_1)
          )
          else
            new r3_1: enc_seed;
            new session_key: key;
            let m_2: bitstring = key2bitstring(session_key) in
            let m2_Ch: bitstring = enc_r(m_2, x1_Ch, r3_1) in
            out(c23[i], m2_Ch)
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying expand
  - Expand if/find/let
    - Test at 410 always false
    - Remove let at 415
    - Remove let at 411
    - Remove let at 407
    - Remove let at 401
    - Test at 37 always false
    - Remove let at 42
    - Remove let at 38
    - Remove let at 34
    - Remove let at 29
yields

Game 45 is
      in(start, ());
   {2}new ks: skeyseed;
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
  {21}  find u_44 = ri_32 <= qChallenger suchthat defined(session_key[ri_32], m2_1[ri_32]) && (m2 = m2_1[ri_32]) then
          yield
        orfind u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Remove branch 1 in find at 21
    - Remove random number generation at 2
yields

Game 46 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
{1813}    find [unique] u_47 = ri_1 <= qTDXM suchthat defined(r_6[ri_1], tdi_TDXM[ri_1]) && (tdi_QE = tdi_TDXM[ri_1]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying merge branches
  - Merge all branches of find at 1813
yields

Game 47 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_43]]]]], r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_42]]]]], r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_41]]]]], r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(pk_TD[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pk_TD[u_8[u_4[u_12[u[u_40]]]]], r3_6) in
          out(c23[i], m2_Ch)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let pk_TD: pkey = pkgen(k_3) in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pk_TD, rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of binder pk_TD
  - Remove assignments on pk_TD (definition removed, all usages removed)
yields

Game 48 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(k_3[u_8[u_4[u_12[u[ri_31]]]]], k_3[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_3: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pkgen(k_3[u_8[u_4[u_12[u[u_43]]]]]), r3_3) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(k_3[u_8[u_4[u_12[u[ri_30]]]]], k_3[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_4: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pkgen(k_3[u_8[u_4[u_12[u[u_42]]]]]), r3_4) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(k_3[u_8[u_4[u_12[u[ri_29]]]]], k_3[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_5: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pkgen(k_3[u_8[u_4[u_12[u[u_41]]]]]), r3_5) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(k_3[u_8[u_4[u_12[u[ri_28]]]]], k_3[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_6: enc_seed;
          let m2_Ch: bitstring = enc_r(m_2, pkgen(k_3[u_8[u_4[u_12[u[u_40]]]]]), r3_6) in
          out(c23[i], m2_Ch)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_3: keyseed;
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pkgen(k_3), rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying equivalence ind_cca2(enc) with k_3, r3_3, r3_4, r3_5, r3_6 [probability qTD * qChallenger * Penc(time(context for game 48) + time + (-1 + qTD * qChallenger) * time(enc_r, maxlength(game 48: m_2)) + (-1 + qTD) * time(skgen) + (-1 + qTD) * time(pkgen), 0) + (0.5 * qTD * qTD + -0.5 * qTD) * Penccoll]
  - Equivalence ind_cca2(enc) with variables: r3_6 -> r1, r3_5 -> r1, r3_4 -> r1, r3_3 -> r1, k_3 -> r
yields

Game 49 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_7: enc_seed;
          let m2_Ch: bitstring = (let x1_6: bitstring = m_2 in (let m1_7: bitstring = enc_r2(Z(x1_6), pkgen2_1(k_5[u_8[u_4[u_12[u[u_43]]]]]), r3_7) in m1_7)) in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_8: enc_seed;
          let m2_Ch: bitstring = (let x1_7: bitstring = m_2 in (let m1_8: bitstring = enc_r2(Z(x1_7), pkgen2_1(k_5[u_8[u_4[u_12[u[u_42]]]]]), r3_8) in m1_8)) in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_9: enc_seed;
          let m2_Ch: bitstring = (let x1_8: bitstring = m_2 in (let m1_9: bitstring = enc_r2(Z(x1_8), pkgen2_1(k_5[u_8[u_4[u_12[u[u_41]]]]]), r3_9) in m1_9)) in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_10: enc_seed;
          let m2_Ch: bitstring = (let x1_9: bitstring = m_2 in (let m1_10: bitstring = enc_r2(Z(x1_9), pkgen2_1(k_5[u_8[u_4[u_12[u[u_40]]]]]), r3_10) in m1_10)) in
          out(c23[i], m2_Ch)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_5: keyseed;
        let k_3: keyseed = cst_keyseed in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pkgen2_1(k_5), rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying expand
  - Expand if/find/let
yields

Game 50 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_7: enc_seed;
          let x1_6: bitstring = m_2 in
          let m1_7: bitstring = enc_r2(Z(x1_6), pkgen2_1(k_5[u_8[u_4[u_12[u[u_43]]]]]), r3_7) in
          let m2_Ch: bitstring = m1_7 in
          out(c23[i], m2_Ch)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_8: enc_seed;
          let x1_7: bitstring = m_2 in
          let m1_8: bitstring = enc_r2(Z(x1_7), pkgen2_1(k_5[u_8[u_4[u_12[u[u_42]]]]]), r3_8) in
          let m2_Ch: bitstring = m1_8 in
          out(c23[i], m2_Ch)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_9: enc_seed;
          let x1_8: bitstring = m_2 in
          let m1_9: bitstring = enc_r2(Z(x1_8), pkgen2_1(k_5[u_8[u_4[u_12[u[u_41]]]]]), r3_9) in
          let m2_Ch: bitstring = m1_9 in
          out(c23[i], m2_Ch)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_10: enc_seed;
          let x1_9: bitstring = m_2 in
          let m1_10: bitstring = enc_r2(Z(x1_9), pkgen2_1(k_5[u_8[u_4[u_12[u[u_40]]]]]), r3_10) in
          let m2_Ch: bitstring = m1_10 in
          out(c23[i], m2_Ch)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_5: keyseed;
        let k_3: keyseed = cst_keyseed in
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pkgen2_1(k_5), rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on k_3 (definition removed, all usages removed)
  - Remove assignments on x1_6 (definition removed, all usages removed)
  - Remove assignments on m2_Ch (definition removed, all usages removed)
  - Remove assignments on x1_7 (definition removed, all usages removed)
  - Remove assignments on m2_Ch (definition removed, all usages removed)
  - Remove assignments on x1_8 (definition removed, all usages removed)
  - Remove assignments on m2_Ch (definition removed, all usages removed)
  - Remove assignments on x1_9 (definition removed, all usages removed)
  - Remove assignments on m2_Ch (definition removed, all usages removed)
yields

Game 51 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_7: enc_seed;
          let m1_7: bitstring = {71}enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_43]]]]]), r3_7) in
          out(c23[i], m1_7)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_8: enc_seed;
          let m1_8: bitstring = {142}enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_42]]]]]), r3_8) in
          out(c23[i], m1_8)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_9: enc_seed;
          let m1_9: bitstring = {213}enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_41]]]]]), r3_9) in
          out(c23[i], m1_9)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_10: enc_seed;
          let m1_10: bitstring = {284}enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_40]]]]]), r3_10) in
          out(c23[i], m1_10)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_5: keyseed;
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pkgen2_1(k_5), rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying simplify
  - Simplification pass
    - Replaced enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_40]]]]]), r3_10) with enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_40]]]]]), r3_10) at 284
    - Replaced enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_41]]]]]), r3_9) with enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_41]]]]]), r3_9) at 213
    - Replaced enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_42]]]]]), r3_8) with enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_42]]]]]), r3_8) at 142
    - Replaced enc_r2(Z(m_2), pkgen2_1(k_5[u_8[u_4[u_12[u[u_43]]]]]), r3_7) with enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_43]]]]]), r3_7) at 71
yields

Game 52 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_7: enc_seed;
          let m1_7: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_43]]]]]), r3_7) in
          out(c23[i], m1_7)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_8: enc_seed;
          let m1_8: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_42]]]]]), r3_8) in
          out(c23[i], m1_8)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_9: enc_seed;
          let m1_9: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_41]]]]]), r3_9) in
          out(c23[i], m1_9)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          let m_2: bitstring = key2bitstring(session_key) in
          new r3_10: enc_seed;
          let m1_10: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_40]]]]]), r3_10) in
          out(c23[i], m1_10)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_5: keyseed;
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pkgen2_1(k_5), rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Applying remove assignments of findcond
  - Remove assignments on m_2 (definition removed, all usages removed)
  - Remove assignments on m_2 (definition removed, all usages removed)
  - Remove assignments on m_2 (definition removed, all usages removed)
  - Remove assignments on m_2 (definition removed, all usages removed)
yields

Game 53 is
      in(start, ());
      new k_4: keyseed;
      new mkey: key;
      out(c1, ());
      ((
        ! i <= qChallenger
        in(c20[i], ());
        out(c21[i], ());
        in(c22[i], m2: bitstring);
        find u_43 = ri_31 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_31]]]]], res2_QE[ri_31], rdata_QE[ri_31], tcbh_QE[ri_31], tdih_QE[ri_31], csvn_QE[ri_31], res1_QE[ri_31], rtyp_QE[ri_31], m1_1[ri_31]) && (m2 = m1_1[ri_31]) then
        (
          event QuoteVerified(rtyp_QE[u_43], res1_QE[u_43], csvn_QE[u_43], tdih_QE[u_43], tcbh_QE[u_43], rdata_QE[u_43], res2_QE[u_43]);
          new session_key: key;
          new r3_7: enc_seed;
          let m1_7: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_43]]]]]), r3_7) in
          out(c23[i], m1_7)
        )
        orfind u_42 = ri_30 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_30]]]]], res2_QE[ri_30], rdata_QE[ri_30], tcbh_QE[ri_30], tdih_QE[ri_30], csvn_QE[ri_30], res1_QE[ri_30], rtyp_QE[ri_30], m1_2[ri_30]) && (m2 = m1_2[ri_30]) then
        (
          event QuoteVerified(rtyp_QE[u_42], res1_QE[u_42], csvn_QE[u_42], tdih_QE[u_42], tcbh_QE[u_42], rdata_QE[u_42], res2_QE[u_42]);
          new session_key: key;
          new r3_8: enc_seed;
          let m1_8: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_42]]]]]), r3_8) in
          out(c23[i], m1_8)
        )
        orfind u_41 = ri_29 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_29]]]]], res2_QE[ri_29], rdata_QE[ri_29], tcbh_QE[ri_29], tdih_QE[ri_29], csvn_QE[ri_29], res1_QE[ri_29], rtyp_QE[ri_29], m1_3[ri_29]) && (m2 = m1_3[ri_29]) then
        (
          event QuoteVerified(rtyp_QE[u_41], res1_QE[u_41], csvn_QE[u_41], tdih_QE[u_41], tcbh_QE[u_41], rdata_QE[u_41], res2_QE[u_41]);
          new session_key: key;
          new r3_9: enc_seed;
          let m1_9: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_41]]]]]), r3_9) in
          out(c23[i], m1_9)
        )
        orfind u_40 = ri_28 <= qQE suchthat defined(k_5[u_8[u_4[u_12[u[ri_28]]]]], res2_QE[ri_28], rdata_QE[ri_28], tcbh_QE[ri_28], tdih_QE[ri_28], csvn_QE[ri_28], res1_QE[ri_28], rtyp_QE[ri_28], m1_4[ri_28]) && (m2 = m1_4[ri_28]) then
        (
          event QuoteVerified(rtyp_QE[u_40], res1_QE[u_40], csvn_QE[u_40], tdih_QE[u_40], tcbh_QE[u_40], rdata_QE[u_40], res2_QE[u_40]);
          new session_key: key;
          new r3_10: enc_seed;
          let m1_10: bitstring = enc_r2(Zkey, pkgen2_1(k_5[u_8[u_4[u_12[u[u_40]]]]]), r3_10) in
          out(c23[i], m1_10)
        )
      ) | (
        ! iH <= qH1
        in(ch1[iH], x1_1: bitstring);
        let tdi_t2bitstring(x111: tdi_t) = x1_1 in
          find [unique] u_24 = ri_12 <= qH1 suchthat defined(r_4[ri_12], x111[ri_12]) && (x111 = x111[ri_12]) then
            out(ch2[iH], r_4[u_24])
          orfind u_22 = ri_10 <= qTDXM suchthat defined(r_6[ri_10], tdi_TDXM[ri_10]) && (x111 = tdi_TDXM[ri_10]) then
            out(ch2[iH], r_6[u_22])
          else
            new r_4: hashoutput1;
            out(ch2[iH], r_4)
        else
          find [unique] u_20 = ri_8 <= qH1 suchthat defined(r_5[ri_8], x1_1[ri_8]) && (x1_1 = x1_1[ri_8]) then
            out(ch2[iH], r_5[u_20])
          else
            new r_5: hashoutput1;
            out(ch2[iH], r_5)
      ) | (
        ! iH_1 <= qH2
        in(ch1_1[iH_1], x1_2: bitstring);
        let tcbi_t2bitstring(x222: tcbi_t) = x1_2 in
          find [unique] u_39 = ri_27 <= qH2 suchthat defined(r_9[ri_27], x222[ri_27]) && (x222 = x222[ri_27]) then
            out(ch2_1[iH_1], r_9[u_39])
          orfind u_37 = ri_25 <= qCPU suchthat defined(r_11[ri_25], tcbi_CPU[ri_25]) && (x222 = tcbi_CPU[ri_25]) then
            out(ch2_1[iH_1], r_11[u_37])
          else
            new r_9: hashoutput2;
            out(ch2_1[iH_1], r_9)
        else
          find [unique] u_35 = ri_23 <= qH2 suchthat defined(r_10[ri_23], x1_2[ri_23]) && (x1_2 = x1_2[ri_23]) then
            out(ch2_1[iH_1], r_10[u_35])
          else
            new r_10: hashoutput2;
            out(ch2_1[iH_1], r_10)
      ) | (
        ! i_1 <= qTD
        in(c4[i_1], ());
        new k_5: keyseed;
        let rdata_other: user_data_t = get_user_data in
        let rdata_TD: rdata_t = rdata_f(pkgen2_1(k_5), rdata_other) in
        out(c5[i_1], ());
        in(c12[i_1], ());
        find u_10 = u_11 <= qTDXM suchthat defined(tdr_TDXM[u_11]) then
        out(c13[i_1], tdr_TDXM[u_10])
      ) | (
        ! i_2 <= qTDXM
        in(c6[i_2], ());
        let tdi_TDXM: tdi_t = get_tdi in
        find [unique] u_18 = ri_6 <= qH1 suchthat defined(r_4[ri_6], x111[ri_6]) && (tdi_TDXM = x111[ri_6]) then
        (
          let tdih_TDXM: hashoutput1 = r_4[u_18] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        orfind u_16 = ri_4 <= qTDXM suchthat defined(r_6[ri_4]) then
        (
          let tdih_TDXM: hashoutput1 = r_6[u_16] in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
        )
        else
          new r_6: hashoutput1;
          let tdih_TDXM: hashoutput1 = r_6 in
          find u_8 = u_9 <= qTD suchthat defined(rdata_TD[u_9]) then
          (
            let rtyp_TDXM: rtyp_t = get_rtyp in
            out(c7[i_2], ());
            in(c10[i_2], ());
            find u_6 = u_7 <= qCPU suchthat defined(smr_CPU[u_7]) then
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            let res4_TDXM: res_t = get_res in
            let tdr_TDXM: tdr_t = tdr_f(smr_CPU[u_6], res4_TDXM, tdi_TDXM) in
            event TDXMsentTDR_8(smr_CPU[u_6], tdi_TDXM);
            out(c11[i_2], ())
          )
          else
            let rtyp_TDXM: rtyp_t = get_rtyp
      ) | (
        ! i_3 <= qCPU
        in(c8[i_3], ());
        find u_4 = u_5 <= qTDXM suchthat defined(rdata_TD[u_8[u_5]], tdih_TDXM[u_5], rtyp_TDXM[u_5]) then
        let tcbi_CPU: tcbi_t = get_tcbi in
        find [unique] u_33 = ri_21 <= qH2 suchthat defined(r_9[ri_21], x222[ri_21]) && (tcbi_CPU = x222[ri_21]) then
        (
          let tcbh_CPU: hashoutput2 = r_9[u_33] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_9[u_33], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        orfind u_31 = ri_19 <= qCPU suchthat defined(r_11[ri_19]) then
        (
          let tcbh_CPU: hashoutput2 = r_11[u_31] in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11[u_31], rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
        )
        else
          new r_11: hashoutput2;
          let tcbh_CPU: hashoutput2 = r_11 in
          let res2_CPU: res_t = get_res in
          let csvn_CPU: csvn_t = get_csvn in
          let res1_CPU: res_t = get_res in
          let rms_without_mac_CPU: rms_without_mac_t = rms_without_mac_f(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU) in
          let x: bitstring = rms_without_mac_t2bitstring(rms_without_mac_CPU) in
          let ma2: macres_t = mac'(x, mkey) in
          let rms_CPU: rms_t = rms_f(rms_without_mac_CPU, ma2) in
          let smr_CPU: smr_t = smr_f(rms_CPU, tcbi_CPU) in
          event CPUsentSMR(rtyp_TDXM[u_4], res1_CPU, csvn_CPU, tdih_TDXM[u_4], r_11, rdata_TD[u_8[u_4]], res2_CPU, ma2);
          out(c9[i_3], ());
          in(c16[i_3], ());
          find u_2 = u_3 <= qQE suchthat defined(mes_QE_CPU_1[u_3], macres_QE[u_3], rtyp_QE[u_3], res1_QE[u_3], csvn_QE[u_3], tdih_QE[u_3], tcbh_QE[u_3], rdata_QE[u_3], res2_QE[u_3]) then
          find u_12 = ri <= qCPU suchthat defined(ma2[ri], rtyp_TDXM[u_4[ri]], res1_CPU[ri], csvn_CPU[ri], tdih_TDXM[u_4[ri]], tcbh_CPU[ri], rdata_TD[u_8[u_4[ri]]], res2_CPU[ri]) && (res2_QE[u_2] = res2_CPU[ri]) && (rdata_QE[u_2] = rdata_TD[u_8[u_4[ri]]]) && (tcbh_QE[u_2] = tcbh_CPU[ri]) && (tdih_QE[u_2] = tdih_TDXM[u_4[ri]]) && (csvn_QE[u_2] = csvn_CPU[ri]) && (res1_QE[u_2] = res1_CPU[ri]) && (rtyp_QE[u_2] = rtyp_TDXM[u_4[ri]]) && (macres_QE[u_2] = ma2[ri]) then
          let mes_CPU_QE_1: rms_without_mac_t = cst_rms_without_mac_t in
          out(c17[i_3], ())
      ) | (
        ! i_4 <= qQE
        in(c14[i_4], tdr_QE: tdr_t);
        let tdr_f(smr_QE: smr_t, res4_QE: res_t, tdi_QE: tdi_t) = tdr_QE in
        let smr_f(rms_QE: rms_t, tcbi_QE: tcbi_t) = smr_QE in
        let rms_f(rms_without_mac_QE: rms_without_mac_t, macres_QE: macres_t) = rms_QE in
        let rms_without_mac_f(rtyp_QE: rtyp_t, res1_QE: res_t, csvn_QE: csvn_t, tdih_QE: hashoutput1, tcbh_QE: hashoutput2, rdata_QE: rdata_t, res2_QE: res_t) = rms_without_mac_QE in
        find [unique] u_48 = ri_3 <= qH1, u_27 = ri_15 <= qH2 suchthat defined(r_4[ri_3], x111[ri_3], r_9[ri_15], x222[ri_15]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = x222[ri_15]) then
        (
          if (tdih_QE = r_4[u_48]) && (tcbh_QE = r_9[u_27]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_16: enc_seed;
            let m1_1: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_16) in
            out(c19[i_4], m1_1)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_49 = ri_3 <= qH1, u_25 = ri_13 <= qCPU suchthat defined(r_4[ri_3], x111[ri_3], r_11[ri_13], tcbi_CPU[ri_13]) && (tdi_QE = x111[ri_3]) && (tcbi_QE = tcbi_CPU[ri_13]) then
        (
          if (tdih_QE = r_4[u_49]) && (tcbh_QE = r_11[u_25]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_17: enc_seed;
            let m1_2: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_17) in
            out(c19[i_4], m1_2)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_45 = ri_1 <= qTDXM, u_30 = ri_18 <= qH2 suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_9[ri_18], x222[ri_18]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = x222[ri_18]) then
        (
          if (tdih_QE = r_6[u_45]) && (tcbh_QE = r_9[u_30]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_18: enc_seed;
            let m1_3: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_18) in
            out(c19[i_4], m1_3)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        orfind u_46 = ri_1 <= qTDXM, u_28 = ri_16 <= qCPU suchthat defined(r_6[ri_1], tdi_TDXM[ri_1], r_11[ri_16], tcbi_CPU[ri_16]) && (tdi_QE = tdi_TDXM[ri_1]) && (tcbi_QE = tcbi_CPU[ri_16]) then
        (
          if (tdih_QE = r_6[u_46]) && (tcbh_QE = r_11[u_28]) then
          (
            let mes_QE_CPU_1: rms_t = cst_rms_t in
            out(c15[i_4], ());
            in(c18[i_4], ());
            find u = u_1 <= qCPU suchthat defined(mes_CPU_QE_1[u_1], rtyp_QE[u_2[u_1]], res1_QE[u_2[u_1]], csvn_QE[u_2[u_1]], tdih_QE[u_2[u_1]], tcbh_QE[u_2[u_1]], rdata_QE[u_2[u_1]], res2_QE[u_2[u_1]]) && (res2_QE[u_2[u_1]] = res2_QE) && (rdata_QE[u_2[u_1]] = rdata_QE) && (tcbh_QE[u_2[u_1]] = tcbh_QE) && (tdih_QE[u_2[u_1]] = tdih_QE) && (csvn_QE[u_2[u_1]] = csvn_QE) && (res1_QE[u_2[u_1]] = res1_QE) && (rtyp_QE[u_2[u_1]] = rtyp_QE) then
            event eve_QE(rtyp_QE, res1_QE, csvn_QE, tdih_QE, tcbh_QE, rdata_QE, res2_QE);
            event QEaccepted2_14(smr_QE, tdi_QE);
            new r_19: enc_seed;
            let m1_4: bitstring = enc_r2(Zkey, pkgen2_1(k_4), r_19) in
            out(c19[i_4], m1_4)
          )
          else
            let mes_QE_CPU_1: rms_t = cst_rms_t
        )
        else
          let mes_QE_CPU_1: rms_t = cst_rms_t
      ))


Proved secrecy of session_key in game 53
Proved event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8)) in game 53 up to probability (qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + (qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2|
Proved event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8)) in game 53 up to probability (qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + (qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2|
Proved event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) in game 53 up to probability (qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + (qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2|
Adv[Game 1: secrecy of session_key] <= 2 * qTD * qChallenger * Penc(time_1, 0) + (qTD * qTD + qTD) * Penccoll + 2 * Psign(time_2, 0, -inf) + (2 * qChallenger + 2 * qQE) * Penc(time_3, qChallenger) + 2 * qQE / |hashoutput2| + 2 * qQE / |hashoutput1| + 2 * Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring)) + Adv[Game 53: secrecy of session_key]
Adv[Game 53: secrecy of session_key] <= 0
RESULT Proved secrecy of session_key up to probability 2 * qTD * qChallenger * Penc(time_1, 0) + (qTD * qTD + qTD) * Penccoll + 2 * Psign(time_2, 0, -inf) + (2 * qChallenger + 2 * qQE) * Penc(time_3, qChallenger) + 2 * qQE / |hashoutput2| + 2 * qQE / |hashoutput1| + 2 * Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring))
Adv[Game 1: event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8))] <= qTD * qChallenger * Penc(time_1, 0) + (0.5 * qTD * qTD + 0.5 * qTD) * Penccoll + Psign(time_2, 0, -inf) + (qChallenger + qQE) * Penc(time_3, qChallenger) + qQE / |hashoutput2| + qQE / |hashoutput1| + Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring)) + Adv[Game 53: event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8))]
Adv[Game 53: event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8))] <= (qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + (qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2|
RESULT Proved event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8)) up to probability qTD * qChallenger * Penc(time_1, 0) + (0.5 * qTD * qTD + 0.5 * qTD) * Penccoll + Psign(time_2, 0, -inf) + (qChallenger + qQE) * Penc(time_3, qChallenger) + (qQE + qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2| + (qQE + qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring))
Adv[Game 1: event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8))] <= qTD * qChallenger * Penc(time_1, 0) + (0.5 * qTD * qTD + 0.5 * qTD) * Penccoll + Psign(time_2, 0, -inf) + (qChallenger + qQE) * Penc(time_3, qChallenger) + qQE / |hashoutput2| + qQE / |hashoutput1| + Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring)) + Adv[Game 53: event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8))]
Adv[Game 53: event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8))] <= (qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + (qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2|
RESULT Proved event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) ==> event(CPUsentSMR(x1, x2, x3, x4, x5, x6, x7, x8)) up to probability qTD * qChallenger * Penc(time_1, 0) + (0.5 * qTD * qTD + 0.5 * qTD) * Penccoll + Psign(time_2, 0, -inf) + (qChallenger + qQE) * Penc(time_3, qChallenger) + (qQE + qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2| + (qQE + qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring))
Adv[Game 1: event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(eve_QE(x1, x2, x3, x4, x5, x6, x7))] <= qTD * qChallenger * Penc(time_1, 0) + (0.5 * qTD * qTD + 0.5 * qTD) * Penccoll + Psign(time_2, 0, -inf) + (qChallenger + qQE) * Penc(time_3, qChallenger) + qQE / |hashoutput2| + qQE / |hashoutput1| + Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring)) + Adv[Game 53: event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(eve_QE(x1, x2, x3, x4, x5, x6, x7))]
Adv[Game 53: event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(eve_QE(x1, x2, x3, x4, x5, x6, x7))] <= (qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + (qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2|
RESULT Proved event(QuoteVerified(x1, x2, x3, x4, x5, x6, x7)) ==> event(eve_QE(x1, x2, x3, x4, x5, x6, x7)) up to probability qTD * qChallenger * Penc(time_1, 0) + (0.5 * qTD * qTD + 0.5 * qTD) * Penccoll + Psign(time_2, 0, -inf) + (qChallenger + qQE) * Penc(time_3, qChallenger) + (qQE + qCPU * qH2 + 0.5 * qH2 * qH2 + 0.5 * qCPU * qCPU) / |hashoutput2| + (qQE + qTDXM * qH1 + 0.5 * qH1 * qH1 + 0.5 * qTDXM * qTDXM) / |hashoutput1| + Pmac(time_4, qCPU, qCPU, 0, length(rms_without_mac_t2bitstring))
RESULT time_1 = time(context for game 48) + time + (-1 + qTD * qChallenger) * time(enc_r, maxlength(game 48: m_2)) + (-1 + qTD) * time(skgen) + (-1 + qTD) * time(pkgen)
RESULT time_2 = time(context for game 42) + time + (-1 + qChallenger) * time(verify, length(tdr_without_mac_t2bitstring))
RESULT time_3 = time(context for game 29) + time + (-1 + qChallenger + qQE) * time(enc_r, max(maxlength(game 29: m_2), maxlength(game 29: m_3)))
RESULT time_4 = time(context for game 6) + time
RESULT time(context for game 6) = time(sskgen) + time(spkgen) + time(skgen) + (1 + qTD) * time(pkgen) + qChallenger * time(dec, maxlength(game 6: m2)) + qChallenger * time(let injbot, length(quote_t2bitstring)) + qChallenger * time(let quote_t2bitstring) + qChallenger * time(let quote_f) + qChallenger * time(verify, length(tdr_without_mac_t2bitstring)) + (qChallenger + qQE) * time(tdr_without_mac_t2bitstring) + qChallenger * time(let tdr_without_mac_f) + qChallenger * time(let smr_without_mac_f) + (qChallenger + qQE) * time(let rms_without_mac_f) + qChallenger * time(let rdata_f) + qChallenger * time(([1,qChallenger])) + qChallenger * time(key2bitstring) + qChallenger * time(enc_r, maxlength(game 6: m_2)) + qH1 * time(hash1, maxlength(game 6: x1_1)) + qH2 * time(hash2, maxlength(game 6: x1_2)) + qTD * time(rdata_f) + (qTDXM + qQE) * time(hash1, length(tdi_t2bitstring)) + (qTDXM + qQE) * time(tdi_t2bitstring) + qTDXM * time(tdr_f) + 2 * qTDXM * time(([1,qTDXM])) + (qCPU + qQE) * time(hash2, length(tcbi_t2bitstring)) + (qCPU + qQE) * time(tcbi_t2bitstring) + qCPU * time(rms_without_mac_f) + qCPU * time(rms_f) + qCPU * time(smr_f) + qCPU * time(([1,qCPU])) + 2 * qCPU * time(rms_without_mac_t2bitstring) + qQE * time(let tdr_f) + qQE * time(let smr_f) + qQE * time(let rms_f) + 2 * qQE * time(([1,qQE])) + qQE * time(smr_without_mac_f) + qQE * time(tdr_without_mac_f) + qQE * time(sign, length(tdr_without_mac_t2bitstring)) + qQE * time(quote_f) + qQE * time(quote_t2bitstring) + qQE * time(enc_r, maxlength(game 6: m_3))
RESULT time(context for game 29) = time(sskgen) + time(spkgen) + qChallenger * time(let injbot, length(quote_t2bitstring)) + qChallenger * time(let quote_t2bitstring) + qChallenger * time(let quote_f) + qChallenger * time(verify, length(tdr_without_mac_t2bitstring)) + (qChallenger + qQE) * time(tdr_without_mac_t2bitstring) + qChallenger * time(let tdr_without_mac_f) + qChallenger * time(let smr_without_mac_f) + (qChallenger + qQE) * time(let rms_without_mac_f) + qChallenger * time(let rdata_f) + qChallenger * time(([1,qChallenger])) + qChallenger * time(key2bitstring) + qH1 * time(let tdi_t2bitstring) + qH1 * qH1 * time(= bitstring, maxlength(game 29: x1_1), maxlength(game 29: x1_1)) + qH2 * time(let tcbi_t2bitstring) + qH2 * qH2 * time(= bitstring, maxlength(game 29: x1_2), maxlength(game 29: x1_2)) + qTD * time(pkgen) + qTD * time(rdata_f) + qTDXM * time(tdr_f) + 2 * qTDXM * time(([1,qTDXM])) + qCPU * time(rms_without_mac_f) + qCPU * time(rms_without_mac_t2bitstring) + qCPU * time(mac', maxlength(game 29: x)) + qCPU * time(rms_f) + qCPU * time(smr_f) + qCPU * time(([1,qCPU])) + qQE * time(let tdr_f) + qQE * time(let smr_f) + qQE * time(let rms_f) + 2 * qQE * time(([1,qQE])) + qQE * time(smr_without_mac_f) + qQE * time(tdr_without_mac_f) + qQE * time(sign, length(tdr_without_mac_t2bitstring)) + qQE * time(quote_f) + qQE * time(quote_t2bitstring)
RESULT time(context for game 42) = qChallenger * qChallenger * time(= bitstring, maxlength(game 42: m2), maxlength(game 42: m2_1)) + qChallenger * qQE * time(= bitstring, maxlength(game 42: m2), maxlength(game 42: m1_1)) + qChallenger * qQE * time(= bitstring, maxlength(game 42: m2), maxlength(game 42: m1_2)) + qChallenger * qQE * time(= bitstring, maxlength(game 42: m2), maxlength(game 42: m1_3)) + qChallenger * qQE * time(= bitstring, maxlength(game 42: m2), maxlength(game 42: m1_4)) + qChallenger * time(dec2, maxlength(game 42: m2)) + qChallenger * time(skgen2_1) + qChallenger * time(let injbot, length(quote_t2bitstring)) + qChallenger * time(let quote_t2bitstring) + qChallenger * time(let quote_f) + qChallenger * time(tdr_without_mac_t2bitstring) + qChallenger * time(let tdr_without_mac_f) + qChallenger * time(let smr_without_mac_f) + (qChallenger + qQE) * time(let rms_without_mac_f) + qChallenger * time(let rdata_f) + qChallenger * time(([1,qChallenger])) + (qChallenger + qQE) * time(pkgen2_1) + (qChallenger + qQE) * time(enc_r2, length(Zkey)) + 2 * qChallenger * time(key2bitstring) + qChallenger * time(enc_r, maxlength(game 42: m_2)) + qH1 * time(let tdi_t2bitstring) + qH1 * qH1 * time(= bitstring, maxlength(game 42: x1_1), maxlength(game 42: x1_1)) + qH2 * time(let tcbi_t2bitstring) + qH2 * qH2 * time(= bitstring, maxlength(game 42: x1_2), maxlength(game 42: x1_2)) + qTD * time(pkgen) + qTD * time(rdata_f) + qTDXM * time(tdr_f) + 2 * qTDXM * time(([1,qTDXM])) + qCPU * time(rms_without_mac_f) + qCPU * time(rms_without_mac_t2bitstring) + qCPU * time(mac', maxlength(game 42: x)) + qCPU * time(rms_f) + qCPU * time(smr_f) + qCPU * time(([1,qCPU])) + qQE * time(let tdr_f) + qQE * time(let smr_f) + qQE * time(let rms_f) + 2 * qQE * time(([1,qQE]))
RESULT time(context for game 48) = qChallenger * qQE * time(= bitstring, maxlength(game 48: m2), maxlength(game 48: m1_1)) + qChallenger * qQE * time(= bitstring, maxlength(game 48: m2), maxlength(game 48: m1_2)) + qChallenger * qQE * time(= bitstring, maxlength(game 48: m2), maxlength(game 48: m1_3)) + qChallenger * qQE * time(= bitstring, maxlength(game 48: m2), maxlength(game 48: m1_4)) + qChallenger * time(([1,qChallenger])) + qChallenger * time(key2bitstring) + qH1 * time(let tdi_t2bitstring) + qH1 * qH1 * time(= bitstring, maxlength(game 48: x1_1), maxlength(game 48: x1_1)) + qH2 * time(let tcbi_t2bitstring) + qH2 * qH2 * time(= bitstring, maxlength(game 48: x1_2), maxlength(game 48: x1_2)) + qTD * time(rdata_f) + qTDXM * time(tdr_f) + 2 * qTDXM * time(([1,qTDXM])) + qCPU * time(rms_without_mac_f) + qCPU * time(rms_without_mac_t2bitstring) + qCPU * time(mac', maxlength(game 48: x)) + qCPU * time(rms_f) + qCPU * time(smr_f) + qCPU * time(([1,qCPU])) + qQE * time(let tdr_f) + qQE * time(let smr_f) + qQE * time(let rms_f) + qQE * time(let rms_without_mac_f) + 2 * qQE * time(([1,qQE])) + qQE * time(enc_r2, length(Zkey)) + qQE * time(pkgen2_1)
RESULT Could not prove event(QEaccepted2_14(x1, x2)) ==> event(TDXMsentTDR_8(x1, x2)).
