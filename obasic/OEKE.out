Doing expand get, insert... No change.
Doing simplify (non-expanded game)... No change.
Doing expand... No change.
Doing remove assignments of findcond... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
  {1}Ostart() :=
  {2}hk0_1 <-R hashkey;
  {3}hk1_1 <-R hashkey;
  {4}ck_1 <-R cipherkey;
  {5}pw0 <-R passwd;
  {6}return{7}();
  {8}((
 {13}  foreach iU <= NU do
 {14}  OC1() :=
 {16}  x <-R Z;
 {17}  X: G <- {18}exp({19}g, {20}x);
 {22}  return{23}({24}U, {25}X);
 {27}  OC2(={29}S, Ystar_u: G) :=
 {30}  Y_u: G <- {31}dec({32}ck_1, {33}Ystar_u, {35}pw0);
 {36}  K_u: G <- {37}exp({38}Y_u, {40}x);
 {42}  auth_u: hash1 <- {43}h1({44}hk1_1, {45}concat({46}U, {47}S, {48}X, {50}Y_u, {52}K_u));
 {54}  sk_u: hash0 <- {55}h0({56}hk0_1, {57}concat({58}U, {59}S, {60}X, {62}Y_u, {64}K_u));
 {66}  event {67}acceptU({70}U, {71}X, {73}S, {74}Ystar_u, {76}auth_u, {78}sk_u);
 {80}  return{81}({82}auth_u)
     ) | (
 {90}  foreach iS <= NS do
 {91}  OS1(={93}U, X_s: G) :=
 {94}  y <-R Z;
 {95}  Y: G <- {96}exp({97}g, {98}y);
{100}  Ystar: G <- {101}enc({102}ck_1, {103}Y, {105}pw0);
{106}  return{107}({108}S, {109}Ystar);
{111}  OS2(auth_s: hash1) :=
{113}  K_s: G <- {114}exp({115}X_s, {117}y);
{119}  if {120}({121}auth_s = {123}h1({124}hk1_1, {125}concat({126}U, {127}S, {128}X_s, {130}Y, {132}K_s))) then
{134}  sk_s: hash0 <- {135}h0({136}hk0_1, {137}concat({138}U, {139}S, {140}X_s, {142}Y, {144}K_s));
{146}  event {147}termS({150}U, {151}X_s, {153}S, {154}Ystar, {156}auth_s, {158}sk_s)
     ) | (
{166}  foreach iP <= NP do
{167}  OP() :=
{169}  xp <-R Z;
{170}  Xp: G <- {171}exp({172}g, {173}xp);
{175}  yp <-R Z;
{176}  Yp: G <- {177}exp({178}g, {179}yp);
{181}  Kp: G <- {182}exp({183}g, {184}mult({185}xp, {187}yp));
{189}  Ystarp: G <- {190}enc({191}ck_1, {192}Yp, {194}pw0);
{195}  authp: hash1 <- {196}h1({197}hk1_1, {198}concat({199}U, {200}S, {201}Xp, {203}Yp, {205}Kp));
{207}  return{208}({209}U, {210}Xp, {212}S, {213}Ystarp, {215}authp)
     ) | (
{224}  foreach iE <= qE do
{225}  Oenc(x_1: G, ke: passwd) :=
{227}  return{228}({229}enc({230}ck_1, {231}x_1, {233}ke))
     ) | (
{236}  foreach iD <= qD do
{237}  Odec(m: G, kd: passwd) :=
{239}  return{240}({241}dec({242}ck_1, {243}m, {245}kd))
     ) | (
{248}  foreach iH <= qH0 do
{249}  OH(x1: bitstring) :=
{251}  return{252}({253}h0({254}hk0_1, {255}x1))
     ) | (
{258}  foreach iH_1 <= qH1 do
{259}  OH_1(x1_1: bitstring) :=
{261}  return{262}({263}h1({264}hk1_1, {265}x1_1))
     ))

Doing insert instruction let concat(x11,x12,x13,x14,x15) = x1_1 in at occurrence 261... Done.
Trying equivalence rom(h1)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... Eliminated collisions between y and yp Probability: NS * NP / |Z|
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between x and xp Probability: NU * NP / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> xp, y_1 -> yp, z_1 -> mult(xp[ri_10], yp[ri_10]) Probability: NP * NP / |Z|
Done.
Doing expand... Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between xp and xp Probability: 0.5 / |Z| * NP * NP
Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 325, output message (U, Xp, S, Ystarp, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 325, output message (U, Xp, S, Ystarp, r_1) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 22, output message (U, X) depends on x.
No change
Doing global dependency analysis on y inside simplify... At 148, output message (S, Ystar) depends on y.
No change
Doing global dependency analysis on r_2 inside simplify... At 426, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 122, output message (r) depends on r.
No change
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp, X_1 -> g, Y_1 -> x13[ri_9] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp, X_1 -> g, Y_1 -> x14[ri_9] Probability: NP * qH1 / |Z|
Doing global dependency analysis on xp inside simplify... At 363, output message (U, Xp, S, Ystarp, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 363, output message (U, Xp, S, Ystarp, r_1) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 22, output message (U, X) depends on x.
No change
Doing global dependency analysis on y inside simplify... At 173, output message (S, Ystar) depends on y.
No change
Doing global dependency analysis on r_2 inside simplify... At 539, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 147, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
  {1}Ostart() :=
  {2}hk0_1 <-R hashkey;
  {3}ck_1 <-R cipherkey;
  {4}pw0 <-R passwd;
  {5}return{6}();
  {7}((
 {12}  foreach iU <= NU do
 {13}  OC1() :=
 {15}  x <-R Z;
 {16}  X: G <- {17}exp({18}g, {19}x);
 {21}  return{22}({23}U, {24}X);
 {26}  OC2(={28}S, Ystar_u: G) :=
 {29}  Y_u: G <- {30}dec({31}ck_1, {32}Ystar_u, {34}pw0);
 {35}  K_u: G <- {36}exp({37}Y_u, {39}x);
 {41}  find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{42}ri_17], x11[{43}ri_17], x12[{44}ri_17], x13[{45}ri_17], x14[{46}ri_17], x15[{47}ri_17]) && {48}({49}({50}({51}({52}({53}K_u = {55}x15[{56}ri_17]) && {57}({58}Y_u = {60}x14[{61}ri_17])) && {62}({63}X = {65}x13[{66}ri_17])) && {67}({68}S = {69}x12[{70}ri_17])) && {71}({72}U = {73}x11[{74}ri_17])) then
 {75}    sk_u: hash0 <- {76}h0({77}hk0_1, {78}concat({79}U, {80}S, {81}X, {83}Y_u, {85}K_u));
 {87}    event {88}acceptU({91}U, {92}X, {94}S, {95}Ystar_u, {97}r_2[{98}u_17], {100}sk_u);
{102}    return{103}({104}r_2[{105}u_17])
       else
{109}    r <-R hash1;
{110}    sk_u: hash0 <- {111}h0({112}hk0_1, {113}concat({114}U, {115}S, {116}X, {118}Y_u, {120}K_u));
{122}    event {123}acceptU({126}U, {127}X, {129}S, {130}Ystar_u, {132}r, {134}sk_u);
{136}    return{137}({138}r)
     ) | (
{145}  foreach iS <= NS do
{146}  OS1(={148}U, X_s: G) :=
{149}  y <-R Z;
{150}  Y: G <- {151}exp({152}g, {153}y);
{155}  Ystar: G <- {156}enc({157}ck_1, {158}Y, {160}pw0);
{161}  return{162}({163}S, {164}Ystar);
{166}  OS2(auth_s: hash1) :=
{168}  K_s: G <- {169}exp({170}X_s, {172}y);
{174}  find [unique] u_15 = ri_15 <= NU suchthat defined(r[{175}ri_15], Y_u[{176}ri_15], x[{177}ri_15]) && {178}({179}({180}X_s = {182}exp({183}g, {184}x[{185}ri_15])) && {186}({187}Y = {189}Y_u[{190}ri_15])) then
       (
{191}    if {192}({193}auth_s = {195}r[{196}u_15]) then
{198}    sk_s: hash0 <- {199}h0({200}hk0_1, {201}concat({202}U, {203}S, {204}X_s, {206}Y, {208}K_s));
{210}    event {211}termS({214}U, {215}X_s, {217}S, {218}Ystar, {220}auth_s, {222}sk_s)
       )
       orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[{227}ri_13], x11[{228}ri_13], x12[{229}ri_13], x13[{230}ri_13], x14[{231}ri_13], x15[{232}ri_13]) && {233}({234}({235}({236}({237}({238}K_s = {240}x15[{241}ri_13]) && {242}({243}Y = {245}x14[{246}ri_13])) && {247}({248}X_s = {250}x13[{251}ri_13])) && {252}({253}S = {254}x12[{255}ri_13])) && {256}({257}U = {258}x11[{259}ri_13])) then
       (
{260}    if {261}({262}auth_s = {264}r_2[{265}u_13]) then
{267}    sk_s: hash0 <- {268}h0({269}hk0_1, {270}concat({271}U, {272}S, {273}X_s, {275}Y, {277}K_s));
{279}    event {280}termS({283}U, {284}X_s, {286}S, {287}Ystar, {289}auth_s, {291}sk_s)
       )
     ) | (
{300}  foreach iP <= NP do
{301}  OP() :=
{303}  xp <-R Z;
{304}  Xp: G <- {305}exp({306}g, {307}xp);
{309}  yp <-R Z;
{310}  Yp: G <- {311}exp({312}g, {313}yp);
{315}  Kp: G <- {316}exp({317}g, {318}mult({319}xp, {321}yp));
{323}  Ystarp: G <- {324}enc({325}ck_1, {326}Yp, {328}pw0);
{329}  r_1 <-R hash1;
{330}  return{331}({332}U, {333}Xp, {335}S, {336}Ystarp, {338}r_1)
     ) | (
{346}  foreach iE <= qE do
{347}  Oenc(x_1: G, ke: passwd) :=
{349}  return{350}({351}enc({352}ck_1, {353}x_1, {355}ke))
     ) | (
{358}  foreach iD <= qD do
{359}  Odec(m: G, kd: passwd) :=
{361}  return{362}({363}dec({364}ck_1, {365}m, {367}kd))
     ) | (
{370}  foreach iH <= qH0 do
{371}  OH(x1: bitstring) :=
{373}  return{374}({375}h0({376}hk0_1, {377}x1))
     ) | (
{380}  foreach iH_1 <= qH1 do
{381}  OH_1(x1_1: bitstring) :=
{383}  let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = {384}x1_1 in
{386}    find [unique] u_7 = ri_7 <= NU suchthat defined(r[{387}ri_7], X[{388}ri_7], Y_u[{389}ri_7], K_u[{390}ri_7]) && {391}({392}({393}({394}({395}({396}x15 = {398}K_u[{399}ri_7]) && {400}({401}x14 = {403}Y_u[{404}ri_7])) && {405}({406}x13 = {408}X[{409}ri_7])) && {410}({411}x12 = {413}S)) && {414}({415}x11 = {417}U)) then
{418}      return{419}({420}r[{421}u_7])
         orfind u_6 = ri_6 <= NP suchthat defined(r_1[{424}ri_6], Xp[{425}ri_6], Yp[{426}ri_6], Kp[{427}ri_6]) && {428}({429}({430}({431}({432}({433}x15 = {435}Kp[{436}ri_6]) && {437}({438}x14 = {440}Yp[{441}ri_6])) && {442}({443}x13 = {445}Xp[{446}ri_6])) && {447}({448}x12 = {450}S)) && {451}({452}x11 = {454}U)) then
{455}      return{456}({457}r_1[{458}u_6])
         orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[{461}ri_5], x11[{462}ri_5], x12[{463}ri_5], x13[{464}ri_5], x14[{465}ri_5], x15[{466}ri_5]) && {467}({468}({469}({470}({471}({472}x15 = {474}x15[{475}ri_5]) && {476}({477}x14 = {479}x14[{480}ri_5])) && {481}({482}x13 = {484}x13[{485}ri_5])) && {486}({487}x12 = {489}x12[{490}ri_5])) && {491}({492}x11 = {494}x11[{495}ri_5])) then
{496}      return{497}({498}r_2[{499}u_5])
         else
{502}      r_2 <-R hash1;
{503}      return{504}({505}r_2)
       else
{508}    find [unique] u = ri <= qH1 suchthat defined(r_3[{509}ri], x1_1[{510}ri]) && {511}({512}x1_1 = {514}x1_1[{515}ri]) then
{516}      return{517}({518}r_3[{519}u])
         else
{522}      r_3 <-R hash1;
{523}      return{524}({525}r_3)
     ))

Doing insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then else find jh <= qH1 suchthat defined(x11[jh], x12[jh], x13[jh], x14[jh], r_2[jh]) && (U = x11[jh]) && (S = x12[jh]) && (X_s = x13[jh]) && (Y = x14[jh]) && (auth_s = r_2[jh]) then event_abort Auth at occurrence 168... Done.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 502, output message (U, Xp, S, Ystarp, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 502, output message (U, Xp, S, Ystarp, r_1) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 22, output message (U, X) depends on x.
No change
Doing global dependency analysis on y inside simplify... At 162, output message (S, Ystar) depends on y.
No change
Doing global dependency analysis on r_2 inside simplify... At 675, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 137, output message (r) depends on r.
No change
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Doing global dependency analysis on xp inside simplify... At 381, output message (U, Xp, S, Ystarp, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 381, output message (U, Xp, S, Ystarp, r_1) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 22, output message (U, X) depends on x.
No change
Doing global dependency analysis on y inside simplify... At 162, output message (S, Ystar) depends on y.
No change
Doing global dependency analysis on r_2 inside simplify... At 554, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 137, output message (r) depends on r.
No change
Doing global dependency analysis on xp inside simplify... At 375, output message (U, Xp, S, Ystarp, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 375, output message (U, Xp, S, Ystarp, r_1) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 22, output message (U, X) depends on x.
No change
Doing global dependency analysis on y inside simplify... At 162, output message (S, Ystar) depends on y.
No change
Doing global dependency analysis on r_2 inside simplify... At 548, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 137, output message (r) depends on r.
No change
Run simplify 3 time(s). Fixpoint reached.
Done.
Trying equivalence icm(enc)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... Eliminated collisions between yp and yp Probability: 0.5 / |Z| * NP * NP
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Eliminated collisions between y and yp Probability: NS * NP / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp, X_1 -> g, Y_1 -> me_O_dec[ri_34] Probability: NP * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp, X_1 -> g, Y_1 -> me_O_dec_1[ri_33] Probability: NP * qD / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> y, X_1 -> g, Y_1 -> me_O_dec[ri_39] Probability: NS * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> y, X_1 -> g, Y_1 -> me_O_dec_1[ri_38] Probability: NS * qD / |Z|
Done.
Doing expand... Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Eliminated collisions between yp and yp Probability: 0.5 / |Z| * NP * NP
Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 1240, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1454, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 21, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1366, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1240, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1008, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1434, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on me_O_dec_1 inside simplify... At 1483, output message (me_O_dec_1) depends on me_O_dec_1.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1392, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on r_2 inside simplify... At 1622, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 791, output message (r) depends on r.
No change
Eliminated collisions between me_O_dec and x14[ri_17] Probability: qH1 * NU / |G|
(me_O_dec collides with a value independent of me_O_dec with probability at most 1 / |G|;
 x14[ri_17] does not depend on me_O_dec)
Eliminated collisions between exp(g, y) and x_1[ri_35] Probability: qE * NS / |Z|
(exp(g, y) collides with a value independent of y with probability at most 1 / |Z|;
 x_1[ri_35] does not depend on y)
Eliminated collisions between exp(g, yp) and x_1[ri_30] Probability: qE * NP / |Z|
(exp(g, yp) collides with a value independent of yp with probability at most 1 / |Z|;
 x_1[ri_30] does not depend on yp)
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_370], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_370], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Doing global dependency analysis on xp inside simplify... At 931, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1127, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 21, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1047, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 931, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 728, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1109, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on me_O_dec_1 inside simplify... At 1154, output message (me_O_dec_1) depends on me_O_dec_1.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1071, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on r_2 inside simplify... At 1293, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 707, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
   {1}Ostart() :=
   {2}hk0_1 <-R hashkey;
   {3}pw0 <-R passwd;
   {4}return{5}();
   {6}((
  {11}  foreach iU <= NU do
  {12}  OC1() :=
  {14}  x <-R Z;
  {15}  X: G <- {16}exp({17}g, {18}x);
  {20}  return{21}({22}U, {23}X);
  {25}  OC2(={27}S, Ystar_u: G) :=
  {28}  find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[{29}ri_44], Ystar_u[{30}ri_44]) && {31}({32}Ystar_u = {34}Ystar_u[{35}ri_44]) then
  {36}    Y_u: G <- {37}me_O_dec[{38}u_44];
  {40}    K_u: G <- {41}exp({42}me_O_dec[{43}u_44], {45}x);
  {47}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{48}ri_17], x11[{49}ri_17], x12[{50}ri_17], x13[{51}ri_17], x14[{52}ri_17], x15[{53}ri_17]) && {54}({55}({56}({57}({58}({59}K_u = {61}x15[{62}ri_17]) && {63}({64}me_O_dec[{65}u_44] = {67}x14[{68}ri_17])) && {69}({70}X = {72}x13[{73}ri_17])) && {74}({75}S = {76}x12[{77}ri_17])) && {78}({79}U = {80}x11[{81}ri_17])) then
  {82}      sk_u: hash0 <- {83}h0({84}hk0_1, {85}concat({86}U, {87}S, {88}X, {90}me_O_dec[{91}u_44], {93}K_u));
  {95}      event {96}acceptU({99}U, {100}X, {102}S, {103}Ystar_u, {105}r_2[{106}u_17], {108}sk_u);
 {110}      return{111}({112}r_2[{113}u_17])
          else
 {117}      r <-R hash1;
 {118}      sk_u: hash0 <- {119}h0({120}hk0_1, {121}concat({122}U, {123}S, {124}X, {126}me_O_dec[{127}u_44], {129}K_u));
 {131}      event {132}acceptU({135}U, {136}X, {138}S, {139}Ystar_u, {141}r, {143}sk_u);
 {145}      return{146}({147}r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[{153}ri_43], kd[{154}ri_43], m[{155}ri_43]) && {156}({157}({158}Ystar_u = {160}m[{161}ri_43]) && {162}({163}pw0 = {164}kd[{165}ri_43])) then
 {166}    Y_u: G <- {167}me_O_dec_1[{168}u_43];
 {170}    K_u: G <- {171}exp({172}me_O_dec_1[{173}u_43], {175}x);
 {177}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{178}ri_17], x11[{179}ri_17], x12[{180}ri_17], x13[{181}ri_17], x14[{182}ri_17], x15[{183}ri_17]) && {184}({185}({186}({187}({188}({189}K_u = {191}x15[{192}ri_17]) && {193}({194}me_O_dec_1[{195}u_43] = {197}x14[{198}ri_17])) && {199}({200}X = {202}x13[{203}ri_17])) && {204}({205}S = {206}x12[{207}ri_17])) && {208}({209}U = {210}x11[{211}ri_17])) then
 {212}      sk_u: hash0 <- {213}h0({214}hk0_1, {215}concat({216}U, {217}S, {218}X, {220}me_O_dec_1[{221}u_43], {223}K_u));
 {225}      event {226}acceptU({229}U, {230}X, {232}S, {233}Ystar_u, {235}r_2[{236}u_17], {238}sk_u);
 {240}      return{241}({242}r_2[{243}u_17])
          else
 {247}      r <-R hash1;
 {248}      sk_u: hash0 <- {249}h0({250}hk0_1, {251}concat({252}U, {253}S, {254}X, {256}me_O_dec_1[{257}u_43], {259}K_u));
 {261}      event {262}acceptU({265}U, {266}X, {268}S, {269}Ystar_u, {271}r, {273}sk_u);
 {275}      return{276}({277}r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[{283}ri_42], Y[{284}ri_42], md_O_enc[{285}ri_42]) && {286}({287}Ystar_u = {289}md_O_enc[{290}ri_42]) then
 {291}    Y_u: G <- {292}Y[{293}u_42];
 {295}    K_u: G <- {296}exp({297}g, {298}mult({299}y[{300}u_42], {302}x));
 {304}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{305}ri_17], x11[{306}ri_17], x12[{307}ri_17], x13[{308}ri_17], x14[{309}ri_17], x15[{310}ri_17]) && {311}({312}({313}({314}({315}({316}K_u = {318}x15[{319}ri_17]) && {320}({321}Y[{322}u_42] = {324}x14[{325}ri_17])) && {326}({327}X = {329}x13[{330}ri_17])) && {331}({332}S = {333}x12[{334}ri_17])) && {335}({336}U = {337}x11[{338}ri_17])) then
 {339}      sk_u: hash0 <- {340}h0({341}hk0_1, {342}concat({343}U, {344}S, {345}X, {347}Y[{348}u_42], {350}K_u));
 {352}      event {353}acceptU({356}U, {357}X, {359}S, {360}Ystar_u, {362}r_2[{363}u_17], {365}sk_u);
 {367}      return{368}({369}r_2[{370}u_17])
          else
 {374}      r <-R hash1;
 {375}      sk_u: hash0 <- {376}h0({377}hk0_1, {378}concat({379}U, {380}S, {381}X, {383}Y[{384}u_42], {386}K_u));
 {388}      event {389}acceptU({392}U, {393}X, {395}S, {396}Ystar_u, {398}r, {400}sk_u);
 {402}      return{403}({404}r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[{410}ri_41], Yp[{411}ri_41], md_O_enc_1[{412}ri_41]) && {413}({414}Ystar_u = {416}md_O_enc_1[{417}ri_41]) then
 {418}    Y_u: G <- {419}Yp[{420}u_41];
 {422}    K_u: G <- {423}exp({424}g, {425}mult({426}yp[{427}u_41], {429}x));
 {431}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{432}ri_17], x11[{433}ri_17], x12[{434}ri_17], x13[{435}ri_17], x14[{436}ri_17], x15[{437}ri_17]) && {438}({439}({440}({441}({442}({443}K_u = {445}x15[{446}ri_17]) && {447}({448}Yp[{449}u_41] = {451}x14[{452}ri_17])) && {453}({454}X = {456}x13[{457}ri_17])) && {458}({459}S = {460}x12[{461}ri_17])) && {462}({463}U = {464}x11[{465}ri_17])) then
 {466}      sk_u: hash0 <- {467}h0({468}hk0_1, {469}concat({470}U, {471}S, {472}X, {474}Yp[{475}u_41], {477}K_u));
 {479}      event {480}acceptU({483}U, {484}X, {486}S, {487}Ystar_u, {489}r_2[{490}u_17], {492}sk_u);
 {494}      return{495}({496}r_2[{497}u_17])
          else
 {501}      r <-R hash1;
 {502}      sk_u: hash0 <- {503}h0({504}hk0_1, {505}concat({506}U, {507}S, {508}X, {510}Yp[{511}u_41], {513}K_u));
 {515}      event {516}acceptU({519}U, {520}X, {522}S, {523}Ystar_u, {525}r, {527}sk_u);
 {529}      return{530}({531}r)
        orfind u_40 = ri_40 <= qE suchthat defined(x_1[{537}ri_40], ke[{538}ri_40], md_O_enc_2[{539}ri_40]) && {540}({541}({542}Ystar_u = {544}md_O_enc_2[{545}ri_40]) && {546}({547}pw0 = {548}ke[{549}ri_40])) then
 {550}    Y_u: G <- {551}x_1[{552}u_40];
 {554}    K_u: G <- {555}exp({556}x_1[{557}u_40], {559}x);
 {561}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{562}ri_17], x11[{563}ri_17], x12[{564}ri_17], x13[{565}ri_17], x14[{566}ri_17], x15[{567}ri_17]) && {568}({569}({570}({571}({572}({573}K_u = {575}x15[{576}ri_17]) && {577}({578}x_1[{579}u_40] = {581}x14[{582}ri_17])) && {583}({584}X = {586}x13[{587}ri_17])) && {588}({589}S = {590}x12[{591}ri_17])) && {592}({593}U = {594}x11[{595}ri_17])) then
 {596}      sk_u: hash0 <- {597}h0({598}hk0_1, {599}concat({600}U, {601}S, {602}X, {604}x_1[{605}u_40], {607}K_u));
 {609}      event {610}acceptU({613}U, {614}X, {616}S, {617}Ystar_u, {619}r_2[{620}u_17], {622}sk_u);
 {624}      return{625}({626}r_2[{627}u_17])
          else
 {631}      r <-R hash1;
 {632}      sk_u: hash0 <- {633}h0({634}hk0_1, {635}concat({636}U, {637}S, {638}X, {640}x_1[{641}u_40], {643}K_u));
 {645}      event {646}acceptU({649}U, {650}X, {652}S, {653}Ystar_u, {655}r, {657}sk_u);
 {659}      return{660}({661}r)
        else
 {667}    me_O_dec <-R G;
 {668}    Y_u: G <- {669}me_O_dec;
 {671}    K_u: G <- {672}exp({673}me_O_dec, {675}x);
 {677}    r <-R hash1;
 {678}    sk_u: hash0 <- {679}h0({680}hk0_1, {681}concat({682}U, {683}S, {684}X, {686}me_O_dec, {688}K_u));
 {690}    event {691}acceptU({694}U, {695}X, {697}S, {698}Ystar_u, {700}r, {702}sk_u);
 {704}    return{705}({706}r)
      ) | (
 {713}  foreach iS <= NS do
 {714}  OS1(={716}U, X_s: G) :=
 {717}  y <-R Z;
 {718}  Y: G <- {719}exp({720}g, {721}y);
 {723}  md_O_enc <-R G;
 {724}  return{725}({726}S, {727}md_O_enc);
 {729}  OS2(auth_s: hash1) :=
 {731}  find j = j_1 <= NU suchthat defined(x[{732}j_1], X[{733}j_1]) && {734}({735}X[{736}j_1] = {737}X_s) then
        (
 {739}    K_s: G <- {740}exp({741}g, {742}mult({743}x[{744}j], {746}y));
 {748}    find [unique]  suchthat defined(r[{749}j], Y_u[{751}j]) && {753}({754}Y = {756}Y_u[{757}j]) then
          (
 {759}      if {760}({761}auth_s = {763}r[{764}j]) then
 {766}      sk_s: hash0 <- {767}h0({768}hk0_1, {769}concat({770}U, {771}S, {772}X_s, {774}Y, {776}K_s));
 {778}      event {779}termS({782}U, {783}X_s, {785}S, {786}md_O_enc, {788}auth_s, {790}sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[{795}ri_13], x11[{796}ri_13], x12[{797}ri_13], x13[{798}ri_13], x14[{799}ri_13], x15[{800}ri_13]) && {801}({802}({803}({804}({805}({806}K_s = {808}x15[{809}ri_13]) && {810}({811}Y = {813}x14[{814}ri_13])) && {815}({816}X_s = {818}x13[{819}ri_13])) && {820}({821}S = {822}x12[{823}ri_13])) && {824}({825}U = {826}x11[{827}ri_13])) then
          (
 {828}      if {829}({830}auth_s = {832}r_2[{833}u_13]) then
 {835}      sk_s: hash0 <- {836}h0({837}hk0_1, {838}concat({839}U, {840}S, {841}X_s, {843}Y, {845}K_s));
 {847}      event {848}termS({851}U, {852}X_s, {854}S, {855}md_O_enc, {857}auth_s, {859}sk_s)
          )
        )
        else
 {866}    find jh = jh_1 <= qH1 suchthat defined(x11[{867}jh_1], x12[{868}jh_1], x13[{869}jh_1], x14[{870}jh_1], r_2[{871}jh_1]) && {872}({873}({874}U = {875}x11[{876}jh_1]) && {877}({878}({879}S = {880}x12[{881}jh_1]) && {882}({883}({884}X_s = {886}x13[{887}jh_1]) && {888}({889}({890}Y = {892}x14[{893}jh_1]) && {894}({895}auth_s = {897}r_2[{898}jh_1]))))) then
 {899}    event_abort Auth
      ) | (
 {902}  foreach iP <= NP do
 {903}  OP() :=
 {905}  xp <-R Z;
 {906}  Xp: G <- {907}exp({908}g, {909}xp);
 {911}  yp <-R Z;
 {912}  Yp: G <- {913}exp({914}g, {915}yp);
 {917}  Kp: G <- {918}exp({919}g, {920}mult({921}xp, {923}yp));
 {925}  md_O_enc_1 <-R G;
 {926}  r_1 <-R hash1;
 {927}  return{928}({929}U, {930}Xp, {932}S, {933}md_O_enc_1, {935}r_1)
      ) | (
 {942}  foreach iE <= qE do
 {943}  Oenc(x_1: G, ke: passwd) :=
 {945}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[{946}ri_29], me_O_dec[{947}ri_29]) && {948}({949}({950}x_1 = {952}me_O_dec[{953}ri_29]) && {954}({955}ke = {957}pw0)) then
 {958}    return{959}({960}Ystar_u[{961}u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[{964}ri_28], kd[{965}ri_28], me_O_dec_1[{966}ri_28]) && {967}({968}({969}x_1 = {971}me_O_dec_1[{972}ri_28]) && {973}({974}ke = {976}kd[{977}ri_28])) then
 {978}    return{979}({980}m[{981}u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[{984}ri_27], Y[{985}ri_27]) && {986}({987}({988}x_1 = {990}Y[{991}ri_27]) && {992}({993}ke = {995}pw0)) then
 {996}    return{997}({998}md_O_enc[{999}u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[{1002}ri_26], Yp[{1003}ri_26]) && {1004}({1005}({1006}x_1 = {1008}Yp[{1009}ri_26]) && {1010}({1011}ke = {1013}pw0)) then
{1014}    return{1015}({1016}md_O_enc_1[{1017}u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[{1020}ri_25], ke[{1021}ri_25], x_1[{1022}ri_25]) && {1023}({1024}({1025}x_1 = {1027}x_1[{1028}ri_25]) && {1029}({1030}ke = {1032}ke[{1033}ri_25])) then
{1034}    return{1035}({1036}md_O_enc_2[{1037}u_25])
        else
{1040}    md_O_enc_2 <-R G;
{1041}    return{1042}({1043}md_O_enc_2)
      ) | (
{1046}  foreach iD <= qD do
{1047}  Odec(m: G, kd: passwd) :=
{1049}  find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[{1050}ri_24], Ystar_u[{1051}ri_24]) && {1052}({1053}({1054}m = {1056}Ystar_u[{1057}ri_24]) && {1058}({1059}kd = {1061}pw0)) then
{1062}    return{1063}({1064}me_O_dec[{1065}u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[{1068}ri_23], kd[{1069}ri_23], m[{1070}ri_23]) && {1071}({1072}({1073}m = {1075}m[{1076}ri_23]) && {1077}({1078}kd = {1080}kd[{1081}ri_23])) then
{1082}    return{1083}({1084}me_O_dec_1[{1085}u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[{1088}ri_22], md_O_enc[{1089}ri_22]) && {1090}({1091}({1092}m = {1094}md_O_enc[{1095}ri_22]) && {1096}({1097}kd = {1099}pw0)) then
{1100}    return{1101}({1102}Y[{1103}u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[{1106}ri_21], md_O_enc_1[{1107}ri_21]) && {1108}({1109}({1110}m = {1112}md_O_enc_1[{1113}ri_21]) && {1114}({1115}kd = {1117}pw0)) then
{1118}    return{1119}({1120}Yp[{1121}u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[{1124}ri_20], ke[{1125}ri_20], md_O_enc_2[{1126}ri_20]) && {1127}({1128}({1129}m = {1131}md_O_enc_2[{1132}ri_20]) && {1133}({1134}kd = {1136}ke[{1137}ri_20])) then
{1138}    return{1139}({1140}x_1[{1141}u_20])
        else
{1144}    me_O_dec_1 <-R G;
{1145}    return{1146}({1147}me_O_dec_1)
      ) | (
{1150}  foreach iH <= qH0 do
{1151}  OH(x1: bitstring) :=
{1153}  return{1154}({1155}h0({1156}hk0_1, {1157}x1))
      ) | (
{1160}  foreach iH_1 <= qH1 do
{1161}  OH_1(x1_1: bitstring) :=
{1163}  let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = {1164}x1_1 in
{1166}    find [unique] u_7 = ri_7 <= NU suchthat defined(r[{1167}ri_7], X[{1168}ri_7], Y_u[{1169}ri_7], K_u[{1170}ri_7]) && {1171}({1172}({1173}({1174}({1175}({1176}x15 = {1178}K_u[{1179}ri_7]) && {1180}({1181}x14 = {1183}Y_u[{1184}ri_7])) && {1185}({1186}x13 = {1188}X[{1189}ri_7])) && {1190}({1191}x12 = {1193}S)) && {1194}({1195}x11 = {1197}U)) then
{1198}      return{1199}({1200}r[{1201}u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[{1204}ri_6], Xp[{1205}ri_6], Yp[{1206}ri_6], Kp[{1207}ri_6]) && {1208}({1209}({1210}({1211}({1212}({1213}x15 = {1215}Kp[{1216}ri_6]) && {1217}({1218}x14 = {1220}Yp[{1221}ri_6])) && {1222}({1223}x13 = {1225}Xp[{1226}ri_6])) && {1227}({1228}x12 = {1230}S)) && {1231}({1232}x11 = {1234}U)) then
{1235}      return{1236}({1237}r_1[{1238}u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[{1241}ri_5], x11[{1242}ri_5], x12[{1243}ri_5], x13[{1244}ri_5], x14[{1245}ri_5], x15[{1246}ri_5]) && {1247}({1248}({1249}({1250}({1251}({1252}x15 = {1254}x15[{1255}ri_5]) && {1256}({1257}x14 = {1259}x14[{1260}ri_5])) && {1261}({1262}x13 = {1264}x13[{1265}ri_5])) && {1266}({1267}x12 = {1269}x12[{1270}ri_5])) && {1271}({1272}x11 = {1274}x11[{1275}ri_5])) then
{1276}      return{1277}({1278}r_2[{1279}u_5])
          else
{1282}      r_2 <-R hash1;
{1283}      return{1284}({1285}r_2)
        else
{1288}    find [unique] u = ri <= qH1 suchthat defined(r_3[{1289}ri], x1_1[{1290}ri]) && {1291}({1292}x1_1 = {1294}x1_1[{1295}ri]) then
{1296}      return{1297}({1298}r_3[{1299}u])
          else
{1302}      r_3 <-R hash1;
{1303}      return{1304}({1305}r_3)
      ))

Doing insert event Encrypt at occurrence 550... Done.
   {1}Ostart() :=
   {2}hk0_1 <-R hashkey;
   {3}pw0 <-R passwd;
   {4}return{5}();
   {6}((
  {11}  foreach iU <= NU do
  {12}  OC1() :=
  {14}  x <-R Z;
  {15}  X: G <- {16}exp({17}g, {18}x);
  {20}  return{21}({22}U, {23}X);
  {25}  OC2(={27}S, Ystar_u: G) :=
  {28}  find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[{29}ri_44], Ystar_u[{30}ri_44]) && {31}({32}Ystar_u = {34}Ystar_u[{35}ri_44]) then
  {36}    Y_u: G <- {37}me_O_dec[{38}u_44];
  {40}    K_u: G <- {41}exp({42}me_O_dec[{43}u_44], {45}x);
  {47}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{48}ri_17], x11[{49}ri_17], x12[{50}ri_17], x13[{51}ri_17], x14[{52}ri_17], x15[{53}ri_17]) && {54}({55}({56}({57}({58}({59}K_u = {61}x15[{62}ri_17]) && {63}({64}me_O_dec[{65}u_44] = {67}x14[{68}ri_17])) && {69}({70}X = {72}x13[{73}ri_17])) && {74}({75}S = {76}x12[{77}ri_17])) && {78}({79}U = {80}x11[{81}ri_17])) then
  {82}      sk_u: hash0 <- {83}h0({84}hk0_1, {85}concat({86}U, {87}S, {88}X, {90}me_O_dec[{91}u_44], {93}K_u));
  {95}      event {96}acceptU({99}U, {100}X, {102}S, {103}Ystar_u, {105}r_2[{106}u_17], {108}sk_u);
 {110}      return{111}({112}r_2[{113}u_17])
          else
 {117}      r <-R hash1;
 {118}      sk_u: hash0 <- {119}h0({120}hk0_1, {121}concat({122}U, {123}S, {124}X, {126}me_O_dec[{127}u_44], {129}K_u));
 {131}      event {132}acceptU({135}U, {136}X, {138}S, {139}Ystar_u, {141}r, {143}sk_u);
 {145}      return{146}({147}r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[{153}ri_43], kd[{154}ri_43], m[{155}ri_43]) && {156}({157}({158}Ystar_u = {160}m[{161}ri_43]) && {162}({163}pw0 = {164}kd[{165}ri_43])) then
 {166}    Y_u: G <- {167}me_O_dec_1[{168}u_43];
 {170}    K_u: G <- {171}exp({172}me_O_dec_1[{173}u_43], {175}x);
 {177}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{178}ri_17], x11[{179}ri_17], x12[{180}ri_17], x13[{181}ri_17], x14[{182}ri_17], x15[{183}ri_17]) && {184}({185}({186}({187}({188}({189}K_u = {191}x15[{192}ri_17]) && {193}({194}me_O_dec_1[{195}u_43] = {197}x14[{198}ri_17])) && {199}({200}X = {202}x13[{203}ri_17])) && {204}({205}S = {206}x12[{207}ri_17])) && {208}({209}U = {210}x11[{211}ri_17])) then
 {212}      sk_u: hash0 <- {213}h0({214}hk0_1, {215}concat({216}U, {217}S, {218}X, {220}me_O_dec_1[{221}u_43], {223}K_u));
 {225}      event {226}acceptU({229}U, {230}X, {232}S, {233}Ystar_u, {235}r_2[{236}u_17], {238}sk_u);
 {240}      return{241}({242}r_2[{243}u_17])
          else
 {247}      r <-R hash1;
 {248}      sk_u: hash0 <- {249}h0({250}hk0_1, {251}concat({252}U, {253}S, {254}X, {256}me_O_dec_1[{257}u_43], {259}K_u));
 {261}      event {262}acceptU({265}U, {266}X, {268}S, {269}Ystar_u, {271}r, {273}sk_u);
 {275}      return{276}({277}r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[{283}ri_42], Y[{284}ri_42], md_O_enc[{285}ri_42]) && {286}({287}Ystar_u = {289}md_O_enc[{290}ri_42]) then
 {291}    Y_u: G <- {292}Y[{293}u_42];
 {295}    K_u: G <- {296}exp({297}g, {298}mult({299}y[{300}u_42], {302}x));
 {304}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{305}ri_17], x11[{306}ri_17], x12[{307}ri_17], x13[{308}ri_17], x14[{309}ri_17], x15[{310}ri_17]) && {311}({312}({313}({314}({315}({316}K_u = {318}x15[{319}ri_17]) && {320}({321}Y[{322}u_42] = {324}x14[{325}ri_17])) && {326}({327}X = {329}x13[{330}ri_17])) && {331}({332}S = {333}x12[{334}ri_17])) && {335}({336}U = {337}x11[{338}ri_17])) then
 {339}      sk_u: hash0 <- {340}h0({341}hk0_1, {342}concat({343}U, {344}S, {345}X, {347}Y[{348}u_42], {350}K_u));
 {352}      event {353}acceptU({356}U, {357}X, {359}S, {360}Ystar_u, {362}r_2[{363}u_17], {365}sk_u);
 {367}      return{368}({369}r_2[{370}u_17])
          else
 {374}      r <-R hash1;
 {375}      sk_u: hash0 <- {376}h0({377}hk0_1, {378}concat({379}U, {380}S, {381}X, {383}Y[{384}u_42], {386}K_u));
 {388}      event {389}acceptU({392}U, {393}X, {395}S, {396}Ystar_u, {398}r, {400}sk_u);
 {402}      return{403}({404}r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[{410}ri_41], Yp[{411}ri_41], md_O_enc_1[{412}ri_41]) && {413}({414}Ystar_u = {416}md_O_enc_1[{417}ri_41]) then
 {418}    Y_u: G <- {419}Yp[{420}u_41];
 {422}    K_u: G <- {423}exp({424}g, {425}mult({426}yp[{427}u_41], {429}x));
 {431}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[{432}ri_17], x11[{433}ri_17], x12[{434}ri_17], x13[{435}ri_17], x14[{436}ri_17], x15[{437}ri_17]) && {438}({439}({440}({441}({442}({443}K_u = {445}x15[{446}ri_17]) && {447}({448}Yp[{449}u_41] = {451}x14[{452}ri_17])) && {453}({454}X = {456}x13[{457}ri_17])) && {458}({459}S = {460}x12[{461}ri_17])) && {462}({463}U = {464}x11[{465}ri_17])) then
 {466}      sk_u: hash0 <- {467}h0({468}hk0_1, {469}concat({470}U, {471}S, {472}X, {474}Yp[{475}u_41], {477}K_u));
 {479}      event {480}acceptU({483}U, {484}X, {486}S, {487}Ystar_u, {489}r_2[{490}u_17], {492}sk_u);
 {494}      return{495}({496}r_2[{497}u_17])
          else
 {501}      r <-R hash1;
 {502}      sk_u: hash0 <- {503}h0({504}hk0_1, {505}concat({506}U, {507}S, {508}X, {510}Yp[{511}u_41], {513}K_u));
 {515}      event {516}acceptU({519}U, {520}X, {522}S, {523}Ystar_u, {525}r, {527}sk_u);
 {529}      return{530}({531}r)
        orfind u_40 = ri_40 <= qE suchthat defined(x_1[{537}ri_40], ke[{538}ri_40], md_O_enc_2[{539}ri_40]) && {540}({541}({542}Ystar_u = {544}md_O_enc_2[{545}ri_40]) && {546}({547}pw0 = {548}ke[{549}ri_40])) then
 {550}    event_abort Encrypt
        else
 {551}    me_O_dec <-R G;
 {552}    Y_u: G <- {553}me_O_dec;
 {555}    K_u: G <- {556}exp({557}me_O_dec, {559}x);
 {561}    r <-R hash1;
 {562}    sk_u: hash0 <- {563}h0({564}hk0_1, {565}concat({566}U, {567}S, {568}X, {570}me_O_dec, {572}K_u));
 {574}    event {575}acceptU({578}U, {579}X, {581}S, {582}Ystar_u, {584}r, {586}sk_u);
 {588}    return{589}({590}r)
      ) | (
 {597}  foreach iS <= NS do
 {598}  OS1(={600}U, X_s: G) :=
 {601}  y <-R Z;
 {602}  Y: G <- {603}exp({604}g, {605}y);
 {607}  md_O_enc <-R G;
 {608}  return{609}({610}S, {611}md_O_enc);
 {613}  OS2(auth_s: hash1) :=
 {615}  find j = j_1 <= NU suchthat defined(x[{616}j_1], X[{617}j_1]) && {618}({619}X[{620}j_1] = {621}X_s) then
        (
 {623}    K_s: G <- {624}exp({625}g, {626}mult({627}x[{628}j], {630}y));
 {632}    find [unique]  suchthat defined(r[{633}j], Y_u[{635}j]) && {637}({638}Y = {640}Y_u[{641}j]) then
          (
 {643}      if {644}({645}auth_s = {647}r[{648}j]) then
 {650}      sk_s: hash0 <- {651}h0({652}hk0_1, {653}concat({654}U, {655}S, {656}X_s, {658}Y, {660}K_s));
 {662}      event {663}termS({666}U, {667}X_s, {669}S, {670}md_O_enc, {672}auth_s, {674}sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[{679}ri_13], x11[{680}ri_13], x12[{681}ri_13], x13[{682}ri_13], x14[{683}ri_13], x15[{684}ri_13]) && {685}({686}({687}({688}({689}({690}K_s = {692}x15[{693}ri_13]) && {694}({695}Y = {697}x14[{698}ri_13])) && {699}({700}X_s = {702}x13[{703}ri_13])) && {704}({705}S = {706}x12[{707}ri_13])) && {708}({709}U = {710}x11[{711}ri_13])) then
          (
 {712}      if {713}({714}auth_s = {716}r_2[{717}u_13]) then
 {719}      sk_s: hash0 <- {720}h0({721}hk0_1, {722}concat({723}U, {724}S, {725}X_s, {727}Y, {729}K_s));
 {731}      event {732}termS({735}U, {736}X_s, {738}S, {739}md_O_enc, {741}auth_s, {743}sk_s)
          )
        )
        else
 {750}    find jh = jh_1 <= qH1 suchthat defined(x11[{751}jh_1], x12[{752}jh_1], x13[{753}jh_1], x14[{754}jh_1], r_2[{755}jh_1]) && {756}({757}({758}U = {759}x11[{760}jh_1]) && {761}({762}({763}S = {764}x12[{765}jh_1]) && {766}({767}({768}X_s = {770}x13[{771}jh_1]) && {772}({773}({774}Y = {776}x14[{777}jh_1]) && {778}({779}auth_s = {781}r_2[{782}jh_1]))))) then
 {783}    event_abort Auth
      ) | (
 {786}  foreach iP <= NP do
 {787}  OP() :=
 {789}  xp <-R Z;
 {790}  Xp: G <- {791}exp({792}g, {793}xp);
 {795}  yp <-R Z;
 {796}  Yp: G <- {797}exp({798}g, {799}yp);
 {801}  Kp: G <- {802}exp({803}g, {804}mult({805}xp, {807}yp));
 {809}  md_O_enc_1 <-R G;
 {810}  r_1 <-R hash1;
 {811}  return{812}({813}U, {814}Xp, {816}S, {817}md_O_enc_1, {819}r_1)
      ) | (
 {826}  foreach iE <= qE do
 {827}  Oenc(x_1: G, ke: passwd) :=
 {829}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[{830}ri_29], me_O_dec[{831}ri_29]) && {832}({833}({834}x_1 = {836}me_O_dec[{837}ri_29]) && {838}({839}ke = {841}pw0)) then
 {842}    return{843}({844}Ystar_u[{845}u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[{848}ri_28], kd[{849}ri_28], me_O_dec_1[{850}ri_28]) && {851}({852}({853}x_1 = {855}me_O_dec_1[{856}ri_28]) && {857}({858}ke = {860}kd[{861}ri_28])) then
 {862}    return{863}({864}m[{865}u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[{868}ri_27], Y[{869}ri_27]) && {870}({871}({872}x_1 = {874}Y[{875}ri_27]) && {876}({877}ke = {879}pw0)) then
 {880}    return{881}({882}md_O_enc[{883}u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[{886}ri_26], Yp[{887}ri_26]) && {888}({889}({890}x_1 = {892}Yp[{893}ri_26]) && {894}({895}ke = {897}pw0)) then
 {898}    return{899}({900}md_O_enc_1[{901}u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[{904}ri_25], ke[{905}ri_25], x_1[{906}ri_25]) && {907}({908}({909}x_1 = {911}x_1[{912}ri_25]) && {913}({914}ke = {916}ke[{917}ri_25])) then
 {918}    return{919}({920}md_O_enc_2[{921}u_25])
        else
 {924}    md_O_enc_2 <-R G;
 {925}    return{926}({927}md_O_enc_2)
      ) | (
 {930}  foreach iD <= qD do
 {931}  Odec(m: G, kd: passwd) :=
 {933}  find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[{934}ri_24], Ystar_u[{935}ri_24]) && {936}({937}({938}m = {940}Ystar_u[{941}ri_24]) && {942}({943}kd = {945}pw0)) then
 {946}    return{947}({948}me_O_dec[{949}u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[{952}ri_23], kd[{953}ri_23], m[{954}ri_23]) && {955}({956}({957}m = {959}m[{960}ri_23]) && {961}({962}kd = {964}kd[{965}ri_23])) then
 {966}    return{967}({968}me_O_dec_1[{969}u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[{972}ri_22], md_O_enc[{973}ri_22]) && {974}({975}({976}m = {978}md_O_enc[{979}ri_22]) && {980}({981}kd = {983}pw0)) then
 {984}    return{985}({986}Y[{987}u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[{990}ri_21], md_O_enc_1[{991}ri_21]) && {992}({993}({994}m = {996}md_O_enc_1[{997}ri_21]) && {998}({999}kd = {1001}pw0)) then
{1002}    return{1003}({1004}Yp[{1005}u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[{1008}ri_20], ke[{1009}ri_20], md_O_enc_2[{1010}ri_20]) && {1011}({1012}({1013}m = {1015}md_O_enc_2[{1016}ri_20]) && {1017}({1018}kd = {1020}ke[{1021}ri_20])) then
{1022}    return{1023}({1024}x_1[{1025}u_20])
        else
{1028}    me_O_dec_1 <-R G;
{1029}    return{1030}({1031}me_O_dec_1)
      ) | (
{1034}  foreach iH <= qH0 do
{1035}  OH(x1: bitstring) :=
{1037}  return{1038}({1039}h0({1040}hk0_1, {1041}x1))
      ) | (
{1044}  foreach iH_1 <= qH1 do
{1045}  OH_1(x1_1: bitstring) :=
{1047}  let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = {1048}x1_1 in
{1050}    find [unique] u_7 = ri_7 <= NU suchthat defined(r[{1051}ri_7], X[{1052}ri_7], Y_u[{1053}ri_7], K_u[{1054}ri_7]) && {1055}({1056}({1057}({1058}({1059}({1060}x15 = {1062}K_u[{1063}ri_7]) && {1064}({1065}x14 = {1067}Y_u[{1068}ri_7])) && {1069}({1070}x13 = {1072}X[{1073}ri_7])) && {1074}({1075}x12 = {1077}S)) && {1078}({1079}x11 = {1081}U)) then
{1082}      return{1083}({1084}r[{1085}u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[{1088}ri_6], Xp[{1089}ri_6], Yp[{1090}ri_6], Kp[{1091}ri_6]) && {1092}({1093}({1094}({1095}({1096}({1097}x15 = {1099}Kp[{1100}ri_6]) && {1101}({1102}x14 = {1104}Yp[{1105}ri_6])) && {1106}({1107}x13 = {1109}Xp[{1110}ri_6])) && {1111}({1112}x12 = {1114}S)) && {1115}({1116}x11 = {1118}U)) then
{1119}      return{1120}({1121}r_1[{1122}u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[{1125}ri_5], x11[{1126}ri_5], x12[{1127}ri_5], x13[{1128}ri_5], x14[{1129}ri_5], x15[{1130}ri_5]) && {1131}({1132}({1133}({1134}({1135}({1136}x15 = {1138}x15[{1139}ri_5]) && {1140}({1141}x14 = {1143}x14[{1144}ri_5])) && {1145}({1146}x13 = {1148}x13[{1149}ri_5])) && {1150}({1151}x12 = {1153}x12[{1154}ri_5])) && {1155}({1156}x11 = {1158}x11[{1159}ri_5])) then
{1160}      return{1161}({1162}r_2[{1163}u_5])
          else
{1166}      r_2 <-R hash1;
{1167}      return{1168}({1169}r_2)
        else
{1172}    find [unique] u = ri <= qH1 suchthat defined(r_3[{1173}ri], x1_1[{1174}ri]) && {1175}({1176}x1_1 = {1178}x1_1[{1179}ri]) then
{1180}      return{1181}({1182}r_3[{1183}u])
          else
{1186}      r_3 <-R hash1;
{1187}      return{1188}({1189}r_3)
      ))

Doing insert instruction let concat(x01,x02,x03,x04,x05) = x1 in at occurrence 1037... Done.
Trying equivalence rom(h0)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... Eliminated collisions between yp and y Probability: NP * NS / |Z|
Eliminated collisions between r_2 and r Probability: qH1 * NU / |hash1|
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between me_O_dec_1 and me_O_dec_1 Probability: 0.5 / |G| * qD * qD
Eliminated collisions between me_O_dec and me_O_dec Probability: 0.5 / |G| * NU * NU
Eliminated collisions between me_O_dec and me_O_dec_1 Probability: NU * qD / |G|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> x[i2_766], y_1 -> y, z_1 -> mult(yp[i2_769], x[ri_75]) Probability: NU * NS * NU * NP / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> x[i2_766], y_1 -> y, z_1 -> mult(x[i2_767], y[ri_73]) Probability: NU * NS * NS * NU / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> yp[i2_735], y_1 -> x, z_1 -> mult(yp[i2_738], x[ri_205]) Probability: NP * NU * NU * NP / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> yp[i2_735], y_1 -> x, z_1 -> mult(x[i2_736], y[ri_203]) Probability: NP * NU * NS * NU / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> y[i2_714], y_1 -> x, z_1 -> mult(yp[i2_717], x[ri_179]) Probability: NS * NU * NU * NP / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> y[i2_714], y_1 -> x, z_1 -> mult(x[i2_715], y[ri_177]) Probability: NS * NU * NS * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec_1[i2_689], Y_1 -> exp(me_O_dec[i2_698], x[ri_159]) Probability: NU * qD * NU * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec_1[i2_689], Y_1 -> exp(me_O_dec_1[i2_696], x[ri_157]) Probability: NU * qD * NU * qD / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec_1[i2_689], Y_1 -> exp(g, mult(yp[i2_692], x[ri_153])) Probability: NU * qD * NU * NP / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_692], X_1 -> g, Y_1 -> me_O_dec_1[i2_689] Probability: NP * qD / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> y[ri_151], X_1 -> g, Y_1 -> me_O_dec_1[i2_689] Probability: NS * qD / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec_1[i2_689], Y_1 -> exp(g, mult(x[i2_690], y[ri_151])) Probability: NU * qD * NS * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec[i2_664], Y_1 -> exp(me_O_dec[i2_677], x[ri_133]) Probability: NU * NU * NU * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec[i2_664], Y_1 -> exp(me_O_dec_1[i2_675], x[ri_131]) Probability: NU * NU * NU * qD / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec[i2_664], Y_1 -> exp(g, mult(yp[i2_667], x[ri_127])) Probability: NU * NU * NU * NP / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_667], X_1 -> g, Y_1 -> me_O_dec[i2_668] Probability: NP * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> y[ri_125], X_1 -> g, Y_1 -> me_O_dec[i2_664] Probability: NS * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec[i2_664], Y_1 -> exp(g, mult(x[i2_665], y[ri_125])) Probability: NU * NU * NS * NU / |Z|
Done.
Doing expand... Eliminated collisions between exp(me_O_dec[i2_1669], x) and x15[u_17] Probability: NU * NU / |G|
(exp(me_O_dec[i2_1669], x) collides with a value independent of me_O_dec[i2_1669] with probability at most 1 / |G|;
 x15[u_17] does not depend on me_O_dec[i2_1669])
Eliminated collisions between exp(me_O_dec[i2_1662], x[i2_1662]) and x15[ri_17] Probability: qH1 * NU / |G|
(exp(me_O_dec[i2_1662], x[i2_1662]) collides with a value independent of me_O_dec[i2_1662] with probability at most 1 / |G|;
 x15[ri_17] does not depend on me_O_dec[i2_1662])
Eliminated collisions between exp(g, mult(yp[i2_1277], x)) and x15[u_17] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_1277], x)) collides with a value independent of yp[i2_1277] with probability at most 1 / |Z|;
 x15[u_17] does not depend on yp[i2_1277])
Eliminated collisions between me_O_dec[i2_978] and x14[u_17[ri_68]] Probability: NU * NU / |G|
(me_O_dec[i2_978] collides with a value independent of me_O_dec[i2_978] with probability at most 1 / |G|;
 x14[u_17[ri_68]] does not depend on me_O_dec[i2_978])
Eliminated collisions between me_O_dec and me_O_dec Probability: 0.5 / |G| * NU * NU
Eliminated collisions between x and xp Probability: NU * NP / |Z|
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec[i2_1638], Y_1 -> exp(me_O_dec[i2_1636], x[ri_120]) Probability: NU * NU * NU * NU / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> me_O_dec_1[i2_1546], Y_1 -> exp(me_O_dec_1[i2_1544], x[ri_144]) Probability: NU * qD * NU * qD / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_1270], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_1270], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> yp[i2_1244], y_1 -> x[ri_192], z_1 -> mult(xp[i2_1246], yp[i2_1246]) Probability: NP * NU * NP / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> yp[i2_1246], y_1 -> x, z_1 -> mult(yp[i2_1244], x[ri_192]) Probability: NP * NU * NU * NP / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> y[i2_1100], y_1 -> x[ri_90], z_1 -> mult(x[i2_1101], y) Probability: NS * NU * NS * NU / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> x[i2_1059], y_1 -> y, z_1 -> mult(x[i2_1058], y[ri_86]) Probability: NU * NS * NS * NU / |Z|
Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 1307, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1498, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on y inside simplify... At 1480, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on r_2 inside simplify... At 1850, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 961, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1307, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 982, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on me_O_dec_1 inside simplify... At 1525, output message (me_O_dec_1) depends on me_O_dec_1.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1442, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1421, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Eliminated collisions between exp(me_O_dec[i2_2615], x[i2_2615]) and x15[ri_17] Probability: qH1 * NU / |G|
(exp(me_O_dec[i2_2615], x[i2_2615]) collides with a value independent of me_O_dec[i2_2615] with probability at most 1 / |G|;
 x15[ri_17] does not depend on me_O_dec[i2_2615])
Eliminated collisions between exp(g, mult(y[i2_2489], x)) and exp(g, mult(x[i2_2490], y[ri_177])) Probability: NU * NS * NU * NS / |Z|
(assuming (u_42 <> ri_177), exp(g, mult(y[i2_2489], x)) collides with a value independent of y[i2_2489] with probability at most 1 / |Z|;
 exp(g, mult(x[i2_2490], y[ri_177])) does not depend on y[i2_2489])
Eliminated collisions between exp(me_O_dec, x) and x05[ri_98] Probability: qH0 * NU / |G|
(exp(me_O_dec, x) collides with a value independent of me_O_dec with probability at most 1 / |G|;
 x05[ri_98] does not depend on me_O_dec)
Eliminated collisions between exp(g, mult(x[i2_2230], y)) and exp(g, mult(y[i2_2231], x[ri_90])) Probability: NS * NU * NS * NU / |Z|
(assuming (j <> ri_90), exp(g, mult(x[i2_2230], y)) collides with a value independent of x[i2_2230] with probability at most 1 / |Z|;
 exp(g, mult(y[i2_2231], x[ri_90])) does not depend on x[i2_2230])
Eliminated collisions between exp(me_O_dec[i2_2048], x[ri_68]) and x15[u_17[ri_68]] Probability: NU * NU / |G|
(exp(me_O_dec[i2_2048], x[ri_68]) collides with a value independent of me_O_dec[i2_2048] with probability at most 1 / |G|;
 x15[u_17[ri_68]] does not depend on me_O_dec[i2_2048])
Eliminated collisions between exp(g, mult(yp[i2_1820], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_1820], x[ri_62])) collides with a value independent of yp[i2_1820] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_1820])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_2321], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_2321], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> y[i2_2208], y_1 -> x[ri_90], z_1 -> mult(x[i2_2209], y) Probability: NS * NU * NS * NU / |Z|
Applied collision x_1 <-R Z; forall y_1: Z, z_1: Z; return((mult(x_1, y_1) = z_1)) <=(1 / |Z|)=> return(false) if y_1 independent-of x_1 && z_1 independent-of x_1 with x_1 -> x[i2_2209], y_1 -> y, z_1 -> mult(y[i2_2208], x[ri_90]) Probability: NU * NS * NU * NS / |Z|
Doing global dependency analysis on xp inside simplify... At 1576, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1767, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r_2 inside simplify... At 2425, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on y inside simplify... At 1749, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on r inside simplify... At 1150, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1576, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1171, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on me_O_dec_1 inside simplify... At 1794, output message (me_O_dec_1) depends on me_O_dec_1.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1711, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1690, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Eliminated collisions between exp(me_O_dec[i2_3486], x[i2_3486]) and x15[ri_17] Probability: qH1 * NU / |G|
(exp(me_O_dec[i2_3486], x[i2_3486]) collides with a value independent of me_O_dec[i2_3486] with probability at most 1 / |G|;
 x15[ri_17] does not depend on me_O_dec[i2_3486])
Eliminated collisions between exp(me_O_dec[i2_3458], x[i2_3458]) and x05[ri_111] Probability: qH0 * NU / |G|
(exp(me_O_dec[i2_3458], x[i2_3458]) collides with a value independent of me_O_dec[i2_3458] with probability at most 1 / |G|;
 x05[ri_111] does not depend on me_O_dec[i2_3458])
Eliminated collisions between exp(me_O_dec[i2_2960], x[ri_68]) and x15[u_17[ri_68]] Probability: NU * NU / |G|
(exp(me_O_dec[i2_2960], x[ri_68]) collides with a value independent of me_O_dec[i2_2960] with probability at most 1 / |G|;
 x15[u_17[ri_68]] does not depend on me_O_dec[i2_2960])
Eliminated collisions between exp(g, mult(yp[i2_2757], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_2757], x[ri_62])) collides with a value independent of yp[i2_2757] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_2757])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_3205], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_3205], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Doing global dependency analysis on xp inside simplify... At 1543, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1734, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r_2 inside simplify... At 2392, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on y inside simplify... At 1716, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on r inside simplify... At 1141, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1543, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1162, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on me_O_dec_1 inside simplify... At 1761, output message (me_O_dec_1) depends on me_O_dec_1.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1678, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1657, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Run simplify 3 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
Doing SA rename Y_u... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 1880, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 2071, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 2015, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1880, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1043, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 2053, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on me_O_dec_1 inside simplify... At 2098, output message (me_O_dec_1) depends on me_O_dec_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 2884, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1024, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1994, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Eliminated collisions between exp(me_O_dec[i2_5348], x[i2_5348]) and x15[ri_17] Probability: qH1 * NU / |G|
(exp(me_O_dec[i2_5348], x[i2_5348]) collides with a value independent of me_O_dec[i2_5348] with probability at most 1 / |G|;
 x15[ri_17] does not depend on me_O_dec[i2_5348])
Eliminated collisions between exp(me_O_dec[i2_5320], x[i2_5320]) and x05[ri_111] Probability: qH0 * NU / |G|
(exp(me_O_dec[i2_5320], x[i2_5320]) collides with a value independent of me_O_dec[i2_5320] with probability at most 1 / |G|;
 x05[ri_111] does not depend on me_O_dec[i2_5320])
Eliminated collisions between exp(g, y) and me_O_dec_1[i2_4905] Probability: qD * NS / |Z|
(exp(g, y) collides with a value independent of y with probability at most 1 / |Z|;
 me_O_dec_1[i2_4905] does not depend on y)
Eliminated collisions between exp(g, y) and me_O_dec[i2_4902] Probability: NU * NS / |Z|
(exp(g, y) collides with a value independent of y with probability at most 1 / |Z|;
 me_O_dec[i2_4902] does not depend on y)
Eliminated collisions between exp(me_O_dec[i2_4823], x[ri_68]) and x15[u_17[ri_68]] Probability: NU * NU / |G|
(exp(me_O_dec[i2_4823], x[ri_68]) collides with a value independent of me_O_dec[i2_4823] with probability at most 1 / |G|;
 x15[u_17[ri_68]] does not depend on me_O_dec[i2_4823])
Eliminated collisions between exp(g, mult(yp[i2_4620], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_4620], x[ri_62])) collides with a value independent of yp[i2_4620] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_4620])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and yp Probability: NS * NP / |Z|
Eliminated collisions between md_O_enc_1 and md_O_enc Probability: NP * NS / |G|
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_5067], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_5067], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Doing global dependency analysis on xp inside simplify... At 1393, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1584, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1528, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1393, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1043, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1566, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on me_O_dec_1 inside simplify... At 1611, output message (me_O_dec_1) depends on me_O_dec_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 2392, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1024, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1507, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Proof of (one-session) secrecy of sk_u failed:
  sk_u is defined from r_15; at 2082, bad usage(s) of r_15.
Proof of (one-session) secrecy of sk_s failed:
  sk_s is defined from r_9; at 1850, bad usage(s) of r_9.
Proof of inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s failed:
  Found termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72]) at 1146
  but could not prove inj-event(acceptU(x, X, y, Ystar, a, k))
Eliminated collisions between r_10 and r_4 Probability: NU * NU / |hash0|
Eliminated collisions between r_2 and r_2 Probability: 0.5 / |hash1| * qH1 * qH1
Eliminated collisions between r_14 and r_10 Probability: NS * NU / |hash0|
Eliminated collisions between y and yp Probability: NS * NP / |Z|
Eliminated collisions between r_14 and r_13 Probability: NS * NS / |hash0|
Eliminated collisions between r_15 and r_4 Probability: qH0 * NU / |hash0|
Eliminated collisions between r_15 and r_10 Probability: qH0 * NU / |hash0|
Eliminated collisions between r_15 and r_15 Probability: 0.5 / |hash0| * qH0 * qH0
Eliminated collisions between r and r_2 Probability: NU * qH1 / |hash1|
Eliminated collisions between r_9 and r_4 Probability: NU * NU / |hash0|
Eliminated collisions between r_14 and r_15 Probability: NS * qH0 / |hash0|
Eliminated collisions between md_O_enc_1 and md_O_enc Probability: NP * NS / |G|
Eliminated collisions between r_9 and r_10 Probability: NU * NU / |hash0|
Eliminated collisions between r_14 and r_9 Probability: NS * NU / |hash0|
Eliminated collisions between md_O_enc and md_O_enc Probability: 0.5 / |G| * NS * NS
Eliminated collisions between r_9 and r_7 Probability: NU * NU / |hash0|
Eliminated collisions between r_9 and r_8 Probability: NU * NU / |hash0|
Eliminated collisions between r_9 and r_5 Probability: NU * NU / |hash0|
Eliminated collisions between r_9 and r_6 Probability: NU * NU / |hash0|
Eliminated collisions between r_9 and r_15 Probability: NU * qH0 / |hash0|
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> y[i2_6418], X_1 -> g, Y_1 -> me_O_dec_1[i2_6422] Probability: NS * qD / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> y[iS_8], X_1 -> g, Y_1 -> me_O_dec[iU_28] Probability: NS * NU / |Z|
Proved query event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s Probability: (0.5 * qH1 * qH1 + NU * qH1) / |hash1| + (NS * NP + 0.5 * NU * NU + NS * qD + NS * NU) / |Z| + (NS * NS + 0.5 * qH0 * qH0 + NS * qH0 + 2 * NS * NU + 7 * NU * NU + 3 * NU * qH0) / |hash0| + (NP * NS + 0.5 * NS * NS) / |G|
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 1364
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 996
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Failed.
Trying equivalence exp_to_group(exp)... Failed.
Trying equivalence group_to_exp_strict(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Eliminated collisions between exp(me_O_dec[i2_6767], x[i2_6767]) and x15[ri_17] Probability: qH1 * NU / |G|
(exp(me_O_dec[i2_6767], x[i2_6767]) collides with a value independent of me_O_dec[i2_6767] with probability at most 1 / |G|;
 x15[ri_17] does not depend on me_O_dec[i2_6767])
Eliminated collisions between exp(me_O_dec[i2_6760], x[i2_6760]) and x05[ri_111] Probability: qH0 * NU / |G|
(exp(me_O_dec[i2_6760], x[i2_6760]) collides with a value independent of me_O_dec[i2_6760] with probability at most 1 / |G|;
 x05[ri_111] does not depend on me_O_dec[i2_6760])
Eliminated collisions between exp(me_O_dec[i2_6570], x[ri_68]) and x15[u_17[ri_68]] Probability: NU * NU / |G|
(exp(me_O_dec[i2_6570], x[ri_68]) collides with a value independent of me_O_dec[i2_6570] with probability at most 1 / |G|;
 x15[u_17[ri_68]] does not depend on me_O_dec[i2_6570])
Eliminated collisions between exp(g, mult(yp[i2_6474], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_6474], x[ri_62])) collides with a value independent of yp[i2_6474] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_6474])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_6674], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_6674], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 1390, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1587, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1528, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1390, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1040, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1569, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 1614, output message (exp(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on r_2 inside simplify... At 2403, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1021, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1507, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Eliminated collisions between exp(me_O_dec[i2_7741], x[i2_7741]) and x15[ri_17] Probability: qH1 * NU / |G|
(exp(me_O_dec[i2_7741], x[i2_7741]) collides with a value independent of me_O_dec[i2_7741] with probability at most 1 / |G|;
 x15[ri_17] does not depend on me_O_dec[i2_7741])
Eliminated collisions between exp(me_O_dec[i2_7713], x[i2_7713]) and x05[ri_111] Probability: qH0 * NU / |G|
(exp(me_O_dec[i2_7713], x[i2_7713]) collides with a value independent of me_O_dec[i2_7713] with probability at most 1 / |G|;
 x05[ri_111] does not depend on me_O_dec[i2_7713])
Eliminated collisions between exp(me_O_dec[i2_7222], x[ri_68]) and x15[u_17[ri_68]] Probability: NU * NU / |G|
(exp(me_O_dec[i2_7222], x[ri_68]) collides with a value independent of me_O_dec[i2_7222] with probability at most 1 / |G|;
 x15[u_17[ri_68]] does not depend on me_O_dec[i2_7222])
Eliminated collisions between exp(g, mult(yp[i2_6995], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_6995], x[ri_62])) collides with a value independent of yp[i2_6995] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_6995])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_7462], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_7462], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Doing global dependency analysis on xp inside simplify... At 1389, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1584, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on me_O_dec inside simplify... At 1526, output message (me_O_dec[u_24]) depends on me_O_dec.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1389, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1039, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1566, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 1611, output message (exp(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on r_2 inside simplify... At 2400, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1020, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1505, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of (one-session) secrecy of sk_u failed:
  sk_u is defined from r_15; at 2088, bad usage(s) of r_15.
Proof of (one-session) secrecy of sk_s failed:
  sk_s is defined from r_9; at 1856, bad usage(s) of r_9.
Proof of inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s failed:
  Found termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72]) at 1142
  but could not prove inj-event(acceptU(x, X, y, Ystar, a, k))
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 1360
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 992
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Failed.
Trying equivalence exp_to_group(exp)... Failed.
Trying equivalence group_to_exp_strict(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Eliminated collisions between exp(g, mult(yp[i2_8913], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_8913], x[ri_62])) collides with a value independent of yp[i2_8913] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_8913])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x_3[i2_9233], X_1 -> g, Y_1 -> x14[ri_17] Probability: NU * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x_3[i2_9226], X_1 -> g, Y_1 -> x04[ri_111] Probability: NU * qH0 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_9140], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_9140], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 1400, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1601, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x_3 inside simplify... At 1541, output message (exp(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1400, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1050, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1583, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 1628, output message (exp(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on r_2 inside simplify... At 2427, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1031, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1519, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Eliminated collisions between exp(g, mult(x_3[i2_9704], x[ri_68])) and x15[u_17[ri_68]] Probability: NU * NU / |Z|
(exp(g, mult(x_3[i2_9704], x[ri_68])) collides with a value independent of x_3[i2_9704] with probability at most 1 / |Z|;
 x15[u_17[ri_68]] does not depend on x_3[i2_9704])
Eliminated collisions between exp(g, mult(yp[i2_9472], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_9472], x[ri_62])) collides with a value independent of yp[i2_9472] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_9472])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x_3[i2_10244], X_1 -> g, Y_1 -> x14[ri_17] Probability: NU * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x_3[i2_10217], X_1 -> g, Y_1 -> x04[ri_111] Probability: NU * qH0 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_9966], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_9966], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Doing global dependency analysis on xp inside simplify... At 1399, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1598, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x_3 inside simplify... At 1538, output message (exp(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1399, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1049, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1580, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 1625, output message (exp(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on r_2 inside simplify... At 2424, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1030, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1517, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of (one-session) secrecy of sk_u failed:
  sk_u is defined from r_15; at 2108, bad usage(s) of r_15.
Proof of (one-session) secrecy of sk_s failed:
  sk_s is defined from r_9; at 1876, bad usage(s) of r_9.
Proof of inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s failed:
  Found termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72]) at 1152
  but could not prove inj-event(acceptU(x, X, y, Ystar, a, k))
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 1370
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 1000
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Failed.
Trying equivalence exp_to_group(exp)... Failed.
Trying equivalence group_to_exp_strict(exp)... Failed.
Doing SA rename K_u... Done.
Doing remove assignments of findcond... No change.
Doing simplify... Doing global dependency analysis on xp inside simplify... At 1399, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1598, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x_3 inside simplify... At 1538, output message (exp(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1399, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1049, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1580, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 1625, output message (exp(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on r_2 inside simplify... At 3064, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1030, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1517, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Eliminated collisions between exp(g, mult(x_3[i2_11814], x[ri_68])) and x15[u_17[ri_68]] Probability: NU * NU / |Z|
(exp(g, mult(x_3[i2_11814], x[ri_68])) collides with a value independent of x_3[i2_11814] with probability at most 1 / |Z|;
 x15[u_17[ri_68]] does not depend on x_3[i2_11814])
Eliminated collisions between exp(g, mult(yp[i2_11582], x[ri_62])) and x15[u_17[ri_62]] Probability: NU * NP / |Z|
(exp(g, mult(yp[i2_11582], x[ri_62])) collides with a value independent of yp[i2_11582] with probability at most 1 / |Z|;
 x15[u_17[ri_62]] does not depend on yp[i2_11582])
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x_3[i2_12354], X_1 -> g, Y_1 -> x14[ri_17] Probability: NU * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x_3[i2_12327], X_1 -> g, Y_1 -> x04[ri_111] Probability: NU * qH0 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> xp[i2_12076], X_1 -> g, Y_1 -> x13[ri_17] Probability: NP * qH1 / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> yp[i2_12076], X_1 -> g, Y_1 -> x14[ri_17] Probability: NP * qH1 / |Z|
Doing global dependency analysis on xp inside simplify... At 1399, output message (U, Xp, S, md_O_enc_1, r_1) depends on xp.
No change
Doing global dependency analysis on yp inside simplify... At 1598, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on x_3 inside simplify... At 1538, output message (exp(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 1399, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 1049, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on y inside simplify... At 1580, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 1625, output message (exp(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on r_2 inside simplify... At 2424, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on r inside simplify... At 1030, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 1517, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Trying equivalence cdh(exp) with x_2, x... Failed.
Doing remove assignments of binder K_u_5... Done.
Doing remove assignments of binder K_u_1... Done.
Doing remove assignments of binder K_u_2... Done.
Doing remove assignments of binder K_u_3... Done.
Doing remove assignments of binder K_u_4... Done.
Doing remove assignments of binder K_s... Done.
Trying equivalence cdh(exp) with x_2, x... Failed.
Doing remove assignments of binder Kp... Done.
Trying equivalence cdh(exp) with x_2, x... Transf. OK Eliminated collisions between yp and y Probability: NP * NS / |Z|
Eliminated collisions between md_O_enc and md_O_enc_1 Probability: NS * NP / |G|
Eliminated collisions between xp and x Probability: NP * NU / |Z|
Eliminated collisions between yp and yp Probability: 0.5 / |Z| * NP * NP
Eliminated collisions between y and y Probability: 0.5 / |Z| * NS * NS
Eliminated collisions between x and x Probability: 0.5 / |Z| * NU * NU
Eliminated collisions between xp and xp Probability: 0.5 / |Z| * NP * NP
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> g, Y_1 -> exp'(g, xp[i2_13462]) Probability: NU * NP / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> y[i2_13490], X_1 -> g, Y_1 -> exp'(g, yp[i2_13495]) Probability: NS * NP / |Z|
Applied collision x_1 <-R Z; forall X_1: G, Y_1: G; return((exp(X_1, x_1) = Y_1)) <=(1 / |Z|)=> return(false) if X_1 independent-of x_1 && Y_1 independent-of x_1 with x_1 -> x, X_1 -> g, Y_1 -> exp'(g, x[i2_13491]) Probability: NU * NU / |Z|
Transf. done Succeeded.
Doing simplify (non-expanded game)... Done.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 460, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 343, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 212, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on yp inside simplify... At 541, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on y inside simplify... At 523, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 568, output message (exp'(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on x_3 inside simplify... At 481, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 698, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 194, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 438, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 321, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 212, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on yp inside simplify... At 519, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on y inside simplify... At 501, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on x_2 inside simplify... At 546, output message (exp'(g, x_2)) depends on x_2.
No change
Doing global dependency analysis on x_3 inside simplify... At 459, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 676, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 194, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proved one-session secrecy of sk_u
Proved secrecy of sk_u
Proved one-session secrecy of sk_s
Proved secrecy of sk_s
Proved query inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 300
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 172
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... No change.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 437, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 321, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 212, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on yp inside simplify... At 517, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on y inside simplify... At 499, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on X_1 inside simplify... At 544, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on x_3 inside simplify... At 458, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 672, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 194, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 351, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 236, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 142, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on yp inside simplify... At 430, output message (Yp[u_21]) depends on yp.
No change
Doing global dependency analysis on y inside simplify... At 412, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on X_1 inside simplify... At 457, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on x_3 inside simplify... At 372, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 585, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 215
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 116
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... No change.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 346, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 231, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 142, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 426, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on y inside simplify... At 407, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on X_1 inside simplify... At 453, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on x_3 inside simplify... At 367, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 581, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 345, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 231, output message (U, Xp, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 142, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 424, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on y inside simplify... At 406, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on X_1 inside simplify... At 451, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on x_3 inside simplify... At 366, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 579, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 215
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 116
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... No change.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 339, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 226, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 142, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 418, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on y inside simplify... At 400, output message (Y[u_22]) depends on y.
No change
Doing global dependency analysis on X_1 inside simplify... At 445, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on x_3 inside simplify... At 360, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 573, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 215
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 116
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... No change.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 334, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 220, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 137, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 414, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 396, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 441, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on x_3 inside simplify... At 355, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 569, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 333, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 220, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 137, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 412, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 394, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 439, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on x_3 inside simplify... At 354, output message (exp'(g, x_3[u_24])) depends on x_3.
No change
Doing global dependency analysis on r_2 inside simplify... At 567, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 210
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 116
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... No change.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 332, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 220, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 137, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 410, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 392, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 437, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on X_5 inside simplify... At 354, output message (X_5[u_24]) depends on X_5.
No change
Doing global dependency analysis on r_2 inside simplify... At 565, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 331, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 220, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 137, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 408, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 390, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 435, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on X_5 inside simplify... At 352, output message (X_5[u_24]) depends on X_5.
No change
Doing global dependency analysis on r_2 inside simplify... At 563, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on x inside simplify... At 20, output message (U, X) depends on x.
No change
Doing global dependency analysis on r inside simplify... At 124, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 210
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 116
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... No change.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 326, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 215, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 131, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 403, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 385, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 430, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on X_5 inside simplify... At 347, output message (X_5[u_24]) depends on X_5.
No change
Doing global dependency analysis on r_2 inside simplify... At 558, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 119, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 325, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 214, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 131, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 402, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 384, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 429, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on X_5 inside simplify... At 346, output message (X_5[u_24]) depends on X_5.
No change
Doing global dependency analysis on r_2 inside simplify... At 557, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 119, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of findcond... No change.
Doing merge branches... No change.
Proof of event(Auth) ==> false with public variables sk_s, sk_u failed:
  Found Auth at 204
  but could not prove false
Proof of event(Encrypt) ==> false with public variables sk_u, sk_s failed:
  Found Encrypt at 111
  but could not prove false
Trying equivalence rom(h1)... Failed.
Trying equivalence rom(h0)... Failed.
Trying equivalence icm(enc)... Failed.
Trying equivalence cdh(exp)... Failed.
Trying equivalence exp'_to_group(exp)... Failed.
Trying equivalence exp_to_group(exp)... Failed.
Trying equivalence group_to_exp_strict(exp)... Failed.
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5 <-R G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], X_5[ri_29]) && (x_1 = X_5[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(X_5[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))

Trying equivalence move_array(G) with X_5.... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on X_4 inside simplify... At 407, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on r_2 inside simplify... At 580, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 130, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on r inside simplify... At 118, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 334, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 213, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 331, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 213, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 130, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 442, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 424, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 488, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on Y_1 inside simplify... At 482, output message (Y_1) depends on Y_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 616, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 118, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 337, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 213, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 130, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 421, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 403, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 467, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on Y_1 inside simplify... At 461, output message (Y_1) depends on Y_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 595, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 118, output message (r) depends on r.
No change
Run simplify 3 time(s). Maximum reached.
Done.
Doing SA rename u_24... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 327, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 213, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 130, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 411, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 393, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 457, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on Y_1 inside simplify... At 451, output message (Y_1) depends on Y_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 585, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 118, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 326, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 213, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 130, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 416, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 398, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 462, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on Y_1 inside simplify... At 456, output message (Y_1) depends on Y_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 590, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 118, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 326, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 213, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 130, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 410, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 392, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 456, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on Y_1 inside simplify... At 450, output message (Y_1) depends on Y_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 584, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 118, output message (r) depends on r.
No change
Run simplify 3 time(s). Fixpoint reached.
Done.
Doing simplify... Doing global dependency analysis on md_O_enc_2 inside simplify... At 326, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 213, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 130, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on X_2 inside simplify... At 410, output message (X_2[u_21]) depends on X_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 392, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 456, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on Y_1 inside simplify... At 450, output message (Y_1) depends on Y_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 584, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 118, output message (r) depends on r.
No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
Doing merge variables (X_1, Y_1) (no branch variables)... No change.
Doing move binder r... Done.
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(Ystar_u[u_218[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          return(Ystar_u[u_218[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_214 = ri_214 <= qD suchthat defined(Y_1[ri_214], Ystar_u[u_218[ri_214]]) && (m = Ystar_u[u_218[ri_214]]) && (kd = pw0) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))

Doing merge variables (X_1, Y_1)... Done.
Doing merge branches... Done.
Trying equivalence move_array(G) with X_2.... Transf. OK Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on X_4 inside simplify... At 347, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on r_2 inside simplify... At 482, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 71, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 255, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 153, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 71, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 252, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 363, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on Y_3 inside simplify... At 382, output message (Y_3) depends on Y_3.
No change
Doing global dependency analysis on X_1 inside simplify... At 388, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 516, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Eliminated collisions between md_O_enc_1 and md_O_enc_1 Probability: 0.5 / |G| * NP * NP
Doing global dependency analysis on md_O_enc_1 inside simplify... At 153, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 71, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 259, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 344, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on Y_3 inside simplify... At 363, output message (Y_3) depends on Y_3.
No change
Doing global dependency analysis on X_1 inside simplify... At 369, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 497, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Run simplify 3 time(s). Maximum reached.
Done.
Doing SA rename u_21... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc_1 inside simplify... At 153, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 71, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 249, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 334, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on Y_3 inside simplify... At 353, output message (Y_3) depends on Y_3.
No change
Doing global dependency analysis on X_1 inside simplify... At 359, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 487, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 153, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 71, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 248, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 340, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on Y_3 inside simplify... At 359, output message (Y_3) depends on Y_3.
No change
Doing global dependency analysis on X_1 inside simplify... At 365, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 493, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_1 inside simplify... At 153, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 71, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 248, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 334, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on Y_3 inside simplify... At 353, output message (Y_3) depends on Y_3.
No change
Doing global dependency analysis on X_1 inside simplify... At 359, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 487, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Run simplify 3 time(s). Fixpoint reached.
Done.
Doing simplify... Doing global dependency analysis on md_O_enc_1 inside simplify... At 153, output message (U, X_3, S, md_O_enc_1, r_1) depends on md_O_enc_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 71, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 248, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_4 inside simplify... At 334, output message (X_4[u_22]) depends on X_4.
No change
Doing global dependency analysis on Y_3 inside simplify... At 353, output message (Y_3) depends on Y_3.
No change
Doing global dependency analysis on X_1 inside simplify... At 359, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 487, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
Doing merge variables (X_1, Y_3) (no branch variables)... Done.
Doing merge branches... Done.
Trying equivalence move_array(G) with X_4.... Transf. OK Eliminated collisions between r_2 and r_2 Probability: 0.5 / |hash1| * qH1 * qH1
Transf. done Succeeded.
Doing simplify (non-expanded game)... No change.
Doing expand... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 246, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 240, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on Y_4 inside simplify... At 352, output message (Y_4) depends on Y_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 358, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 486, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Eliminated collisions between md_O_enc and md_O_enc Probability: 0.5 / |G| * NS * NS
Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 247, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on Y_4 inside simplify... At 333, output message (Y_4) depends on Y_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 339, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 467, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Run simplify 3 time(s). Maximum reached.
Done.
Doing SA rename u_22... Done.
Doing remove assignments of findcond... Done.
Doing simplify... Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 237, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on Y_4 inside simplify... At 323, output message (Y_4) depends on Y_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 329, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 457, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 236, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on Y_4 inside simplify... At 329, output message (Y_4) depends on Y_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 335, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 463, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 236, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on Y_4 inside simplify... At 323, output message (Y_4) depends on Y_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 329, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 457, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Run simplify 3 time(s). Fixpoint reached.
Done.
Doing simplify... Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 236, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on Y_4 inside simplify... At 323, output message (Y_4) depends on Y_4.
No change
Doing global dependency analysis on X_1 inside simplify... At 329, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 457, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of findcond... Done.
Doing merge branches... No change.
Doing merge variables (X_1, Y_4) (no branch variables)... Done.
Doing merge branches... No change.
   {1}Ostart() :=
   {2}pw0 <-R passwd;
   {3}return{4}();
   {5}((
  {10}  foreach iU <= NU do
  {11}  OC1() :=
  {13}  X_6 <-R G;
  {14}  return{15}({16}U, {17}X_6);
  {19}  OC2(={21}S, Ystar_u: G) :=
  {22}  find [unique] u_40 = ri_40 <= qE suchthat defined(ke[{23}ri_40], md_O_enc_2[{24}ri_40]) && {25}({26}({27}Ystar_u = {29}md_O_enc_2[{30}ri_40]) && {31}({32}pw0 = {33}ke[{34}ri_40])) then
  {35}    event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[{36}ri_42]) && {37}({38}Ystar_u = {40}md_O_enc[{41}ri_42]) then
  {42}    r_9 <-R hash0;
  {43}    sk_u: hash0 <- {44}r_9;
  {46}    r <-R hash1;
  {47}    return{48}({49}r)
        else
  {53}    r_4 <-R hash0;
  {54}    sk_u: hash0 <- {55}r_4;
  {57}    r <-R hash1;
  {58}    return{59}({60}r)
      ) | (
  {64}  foreach iS <= NS do
  {65}  OS1(={67}U, X_s: G) :=
  {68}  md_O_enc <-R G;
  {69}  return{70}({71}S, {72}md_O_enc);
  {74}  OS2(auth_s: hash1) :=
  {76}  find j = j_1 <= NU suchthat defined(X_6[{77}j_1]) && {78}({79}X_6[{80}j_1] = {81}X_s) then
        (
  {83}    if defined(r_9[{84}j], r[{86}j], u_42[{88}j]) && {90}({91}iS = {92}u_42[{93}j]) then
  {95}    if {96}({97}auth_s = {99}r[{100}j]) then
 {102}    sk_s: hash0 <- {103}r_9[{104}j]
        )
        else
 {110}    find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[{111}jh_1], x12[{112}jh_1], x13[{113}jh_1], x14[{114}jh_1], r_2[{115}jh_1], u_230[{116}ri_220], X_1[{117}ri_220]) && {118}({119}({120}u_230[{121}ri_220] = {122}iS) && {123}({124}({125}U = {126}x11[{127}jh_1]) && {128}({129}({130}S = {131}x12[{132}jh_1]) && {133}({134}({135}X_s = {137}x13[{138}jh_1]) && {139}({140}({141}x14[{142}jh_1] = {143}X_1[{144}ri_220]) && {145}({146}auth_s = {148}r_2[{149}jh_1])))))) then
 {150}    event_abort Auth
      ) | (
 {152}  foreach iP <= NP do
 {153}  OP() :=
 {155}  X_3 <-R G;
 {156}  md_O_enc_1 <-R G;
 {157}  r_1 <-R hash1;
 {158}  return{159}({160}U, {161}X_3, {163}S, {164}md_O_enc_1, {166}r_1)
      ) | (
 {170}  foreach iE <= qE do
 {171}  Oenc(x_1: G, ke: passwd) :=
 {173}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[{174}ri_28], kd[{175}ri_28], X_1[{176}ri_28]) && {177}({178}({179}x_1 = {181}X_1[{182}ri_28]) && {183}({184}ke = {186}kd[{187}ri_28])) then
 {188}    return{189}({190}m[{191}u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[{194}ri_25], ke[{195}ri_25], x_1[{196}ri_25]) && {197}({198}({199}x_1 = {201}x_1[{202}ri_25]) && {203}({204}ke = {206}ke[{207}ri_25])) then
 {208}    return{209}({210}md_O_enc_2[{211}u_25])
        else
 {214}    md_O_enc_2 <-R G;
 {215}    return{216}({217}md_O_enc_2)
      ) | (
 {220}  foreach iD <= qD do
 {221}  Odec(m: G, kd: passwd) :=
 {223}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[{224}ri_23], kd[{225}ri_23], m[{226}ri_23]) && {227}({228}({229}m = {231}m[{232}ri_23]) && {233}({234}kd = {236}kd[{237}ri_23])) then
 {238}    return{239}({240}X_1[{241}u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[{244}ri_20], ke[{245}ri_20], md_O_enc_2[{246}ri_20]) && {247}({248}({249}m = {251}md_O_enc_2[{252}ri_20]) && {253}({254}kd = {256}ke[{257}ri_20])) then
 {258}    return{259}({260}x_1[{261}u_20])
        else
 {264}    find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[{265}ri_22]) && {266}({267}({268}m = {270}md_O_enc[{271}ri_22]) && {272}({273}kd = {275}pw0)) then
 {276}      X_1 <-R G;
 {277}      return{278}({279}X_1)
          else
 {282}      X_1 <-R G;
 {283}      return{284}({285}X_1)
      ) | (
 {288}  foreach iH <= qH0 do
 {289}  OH(x1: bitstring) :=
 {291}  let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = {292}x1 in
 {294}    find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[{295}ri_59], x01[{296}ri_59], x02[{297}ri_59], x03[{298}ri_59], x04[{299}ri_59], x05[{300}ri_59]) && {301}({302}({303}({304}({305}({306}x05 = {308}x05[{309}ri_59]) && {310}({311}x04 = {313}x04[{314}ri_59])) && {315}({316}x03 = {318}x03[{319}ri_59])) && {320}({321}x02 = {323}x02[{324}ri_59])) && {325}({326}x01 = {328}x01[{329}ri_59])) then
 {330}      return{331}({332}r_15[{333}u_59])
          else
 {336}      r_15 <-R hash0;
 {337}      return{338}({339}r_15)
        else
 {342}    find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[{343}ri_45], x1[{344}ri_45]) && {345}({346}x1 = {348}x1[{349}ri_45]) then
 {350}      return{351}({352}r_16[{353}u_45])
          else
 {356}      r_16 <-R hash0;
 {357}      return{358}({359}r_16)
      ) | (
 {362}  foreach iH_1 <= qH1 do
 {363}  OH_1(x1_1: bitstring) :=
 {365}  let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = {366}x1_1 in
 {368}    find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[{369}ri_5], x11[{370}ri_5], x12[{371}ri_5], x13[{372}ri_5], x14[{373}ri_5], x15[{374}ri_5]) && {375}({376}({377}({378}({379}({380}x15 = {382}x15[{383}ri_5]) && {384}({385}x14 = {387}x14[{388}ri_5])) && {389}({390}x13 = {392}x13[{393}ri_5])) && {394}({395}x12 = {397}x12[{398}ri_5])) && {399}({400}x11 = {402}x11[{403}ri_5])) then
 {404}      return{405}({406}r_2[{407}u_5])
          else
 {410}      r_2 <-R hash1;
 {411}      return{412}({413}r_2)
        else
 {416}    find [unique] u = ri <= qH1 suchthat defined(r_3[{417}ri], x1_1[{418}ri]) && {419}({420}x1_1 = {422}x1_1[{423}ri]) then
 {424}      return{425}({426}r_3[{427}u])
          else
 {430}      r_3 <-R hash1;
 {431}      return{432}({433}r_3)
      ))

Doing insert instruction find jh' <= qH1, jd <= qD suchthat defined(x11[jh'], x12[jh'], x13[jh'], x14[jh'], r_2[jh'], m[jd], kd[jd], X_1[jd]) && (m[jd] = md_O_enc) && (U = x11[jh']) && (S = x12[jh']) && (X_s = x13[jh']) && (x14[jh'] = X_1[jd]) && (auth_s = r_2[jh'])  && (kd[jd] = pw0) then at occurrence 110... Done.
   {1}Ostart() :=
   {2}pw0 <-R passwd;
   {3}return{4}();
   {5}((
  {10}  foreach iU <= NU do
  {11}  OC1() :=
  {13}  X_6 <-R G;
  {14}  return{15}({16}U, {17}X_6);
  {19}  OC2(={21}S, Ystar_u: G) :=
  {22}  find [unique] u_40 = ri_40 <= qE suchthat defined(ke[{23}ri_40], md_O_enc_2[{24}ri_40]) && {25}({26}({27}Ystar_u = {29}md_O_enc_2[{30}ri_40]) && {31}({32}pw0 = {33}ke[{34}ri_40])) then
  {35}    event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[{36}ri_42]) && {37}({38}Ystar_u = {40}md_O_enc[{41}ri_42]) then
  {42}    r_9 <-R hash0;
  {43}    sk_u: hash0 <- {44}r_9;
  {46}    r <-R hash1;
  {47}    return{48}({49}r)
        else
  {53}    r_4 <-R hash0;
  {54}    sk_u: hash0 <- {55}r_4;
  {57}    r <-R hash1;
  {58}    return{59}({60}r)
      ) | (
  {64}  foreach iS <= NS do
  {65}  OS1(={67}U, X_s: G) :=
  {68}  md_O_enc <-R G;
  {69}  return{70}({71}S, {72}md_O_enc);
  {74}  OS2(auth_s: hash1) :=
  {76}  find j = j_1 <= NU suchthat defined(X_6[{77}j_1]) && {78}({79}X_6[{80}j_1] = {81}X_s) then
        (
  {83}    if defined(r_9[{84}j], r[{86}j], u_42[{88}j]) && {90}({91}iS = {92}u_42[{93}j]) then
  {95}    if {96}({97}auth_s = {99}r[{100}j]) then
 {102}    sk_s: hash0 <- {103}r_9[{104}j]
        )
        else
 {110}    find jh' = jh'_1 <= qH1, jd = jd_1 <= qD suchthat defined(x11[{111}jh'_1], x12[{112}jh'_1], x13[{113}jh'_1], x14[{114}jh'_1], r_2[{115}jh'_1], m[{116}jd_1], kd[{117}jd_1], X_1[{118}jd_1]) && {119}({120}({121}m[{122}jd_1] = {123}md_O_enc) && {125}({126}({127}U = {128}x11[{129}jh'_1]) && {130}({131}({132}S = {133}x12[{134}jh'_1]) && {135}({136}({137}X_s = {139}x13[{140}jh'_1]) && {141}({142}({143}x14[{144}jh'_1] = {145}X_1[{146}jd_1]) && {147}({148}({149}auth_s = {151}r_2[{152}jh'_1]) && {153}({154}kd[{155}jd_1] = {156}pw0))))))) then
          (
 {157}      find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[{158}jh_1], x12[{159}jh_1], x13[{160}jh_1], x14[{161}jh_1], r_2[{162}jh_1], u_230[{163}ri_220], X_1[{164}ri_220]) && {165}({166}({167}u_230[{168}ri_220] = {169}iS) && {170}({171}({172}U = {173}x11[{174}jh_1]) && {175}({176}({177}S = {178}x12[{179}jh_1]) && {180}({181}({182}X_s = {184}x13[{185}jh_1]) && {186}({187}({188}x14[{189}jh_1] = {190}X_1[{191}ri_220]) && {192}({193}auth_s = {195}r_2[{196}jh_1])))))) then
 {197}      event_abort Auth
          )
          else
 {199}      find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[{200}jh_1], x12[{201}jh_1], x13[{202}jh_1], x14[{203}jh_1], r_2[{204}jh_1], u_230[{205}ri_220], X_1[{206}ri_220]) && {207}({208}({209}u_230[{210}ri_220] = {211}iS) && {212}({213}({214}U = {215}x11[{216}jh_1]) && {217}({218}({219}S = {220}x12[{221}jh_1]) && {222}({223}({224}X_s = {226}x13[{227}jh_1]) && {228}({229}({230}x14[{231}jh_1] = {232}X_1[{233}ri_220]) && {234}({235}auth_s = {237}r_2[{238}jh_1])))))) then
 {239}      event_abort Auth
      ) | (
 {241}  foreach iP <= NP do
 {242}  OP() :=
 {244}  X_3 <-R G;
 {245}  md_O_enc_1 <-R G;
 {246}  r_1 <-R hash1;
 {247}  return{248}({249}U, {250}X_3, {252}S, {253}md_O_enc_1, {255}r_1)
      ) | (
 {259}  foreach iE <= qE do
 {260}  Oenc(x_1: G, ke: passwd) :=
 {262}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[{263}ri_28], kd[{264}ri_28], X_1[{265}ri_28]) && {266}({267}({268}x_1 = {270}X_1[{271}ri_28]) && {272}({273}ke = {275}kd[{276}ri_28])) then
 {277}    return{278}({279}m[{280}u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[{283}ri_25], ke[{284}ri_25], x_1[{285}ri_25]) && {286}({287}({288}x_1 = {290}x_1[{291}ri_25]) && {292}({293}ke = {295}ke[{296}ri_25])) then
 {297}    return{298}({299}md_O_enc_2[{300}u_25])
        else
 {303}    md_O_enc_2 <-R G;
 {304}    return{305}({306}md_O_enc_2)
      ) | (
 {309}  foreach iD <= qD do
 {310}  Odec(m: G, kd: passwd) :=
 {312}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[{313}ri_23], kd[{314}ri_23], m[{315}ri_23]) && {316}({317}({318}m = {320}m[{321}ri_23]) && {322}({323}kd = {325}kd[{326}ri_23])) then
 {327}    return{328}({329}X_1[{330}u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[{333}ri_20], ke[{334}ri_20], md_O_enc_2[{335}ri_20]) && {336}({337}({338}m = {340}md_O_enc_2[{341}ri_20]) && {342}({343}kd = {345}ke[{346}ri_20])) then
 {347}    return{348}({349}x_1[{350}u_20])
        else
 {353}    find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[{354}ri_22]) && {355}({356}({357}m = {359}md_O_enc[{360}ri_22]) && {361}({362}kd = {364}pw0)) then
 {365}      X_1 <-R G;
 {366}      return{367}({368}X_1)
          else
 {371}      X_1 <-R G;
 {372}      return{373}({374}X_1)
      ) | (
 {377}  foreach iH <= qH0 do
 {378}  OH(x1: bitstring) :=
 {380}  let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = {381}x1 in
 {383}    find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[{384}ri_59], x01[{385}ri_59], x02[{386}ri_59], x03[{387}ri_59], x04[{388}ri_59], x05[{389}ri_59]) && {390}({391}({392}({393}({394}({395}x05 = {397}x05[{398}ri_59]) && {399}({400}x04 = {402}x04[{403}ri_59])) && {404}({405}x03 = {407}x03[{408}ri_59])) && {409}({410}x02 = {412}x02[{413}ri_59])) && {414}({415}x01 = {417}x01[{418}ri_59])) then
 {419}      return{420}({421}r_15[{422}u_59])
          else
 {425}      r_15 <-R hash0;
 {426}      return{427}({428}r_15)
        else
 {431}    find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[{432}ri_45], x1[{433}ri_45]) && {434}({435}x1 = {437}x1[{438}ri_45]) then
 {439}      return{440}({441}r_16[{442}u_45])
          else
 {445}      r_16 <-R hash0;
 {446}      return{447}({448}r_16)
      ) | (
 {451}  foreach iH_1 <= qH1 do
 {452}  OH_1(x1_1: bitstring) :=
 {454}  let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = {455}x1_1 in
 {457}    find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[{458}ri_5], x11[{459}ri_5], x12[{460}ri_5], x13[{461}ri_5], x14[{462}ri_5], x15[{463}ri_5]) && {464}({465}({466}({467}({468}({469}x15 = {471}x15[{472}ri_5]) && {473}({474}x14 = {476}x14[{477}ri_5])) && {478}({479}x13 = {481}x13[{482}ri_5])) && {483}({484}x12 = {486}x12[{487}ri_5])) && {488}({489}x11 = {491}x11[{492}ri_5])) then
 {493}      return{494}({495}r_2[{496}u_5])
          else
 {499}      r_2 <-R hash1;
 {500}      return{501}({502}r_2)
        else
 {505}    find [unique] u = ri <= qH1 suchthat defined(r_3[{506}ri], x1_1[{507}ri]) && {508}({509}x1_1 = {511}x1_1[{512}ri]) then
 {513}      return{514}({515}r_3[{516}u])
          else
 {519}      r_3 <-R hash1;
 {520}      return{521}({522}r_3)
      ))

Doing insert event Auth2 at occurrence 157... Done.
Doing simplify... Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 264, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_1 inside simplify... At 326, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 460, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 223, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_1 inside simplify... At 285, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on r_2 inside simplify... At 419, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on r inside simplify... At 59, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Doing merge branches... Done.
Doing simplify with collision elimination at variables: pw0... Doing global dependency analysis on md_O_enc_2 inside simplify... At 223, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_1 inside simplify... At 273, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 70, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on r_2 inside simplify... At 401, output message (r_2) depends on r_2.
No change
Doing global dependency analysis on pw0 inside simplify... Done. Restarting simplify
Eliminated collisions between pw0 and kd[jd_1] Probability: NS / |passwd|
(pw0 collides with a value independent of pw0[...] with probability at most 1 / |passwd|;
 kd[jd_1] does not depend on pw0[...])
Eliminated collisions between pw0 and ke[ri_40] Probability: NU / |passwd|
(pw0 collides with a value independent of pw0[...] with probability at most 1 / |passwd|;
 ke[ri_40] does not depend on pw0[...])
Eliminated collisions between X_1 and X_1 Probability: 0.5 / |G| * qD * qD
Eliminated collisions between r_2 and r_2 Probability: 0.5 / |hash1| * qH1 * qH1
Eliminated collisions between md_O_enc_2 and md_O_enc_2 Probability: 0.5 / |G| * qE * qE
Doing global dependency analysis on md_O_enc_2 inside simplify... At 163, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_1 inside simplify... At 213, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on X_6 inside simplify... At 15, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 57, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on r inside simplify... At 46, output message (r) depends on r.
No change
Doing global dependency analysis on md_O_enc_2 inside simplify... At 161, output message (md_O_enc_2) depends on md_O_enc_2.
No change
Doing global dependency analysis on X_1 inside simplify... At 211, output message (X_1) depends on X_1.
No change
Doing global dependency analysis on X_6 inside simplify... At 14, output message (U, X_6) depends on X_6.
No change
Doing global dependency analysis on md_O_enc inside simplify... At 56, output message (S, md_O_enc) depends on md_O_enc.
No change
Doing global dependency analysis on r inside simplify... At 45, output message (r) depends on r.
No change
Run simplify 2 time(s). Fixpoint reached.
Done.
Proved query event(Auth) ==> false with public variables sk_s, sk_u
Proved query event(Encrypt) ==> false with public variables sk_u, sk_s
Proved query event(Auth2) ==> false with public variables sk_s, sk_u
===================== Proof starts =======================
Initial state
Game 1 is
      Ostart() :=
      hk0_1 <-R hashkey;
      hk1_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        auth_u: hash1 <- h1(hk1_1, concat(U, S, X, Y_u, K_u));
        sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
        event acceptU(U, X, S, Ystar_u, auth_u, sk_u);
        return(auth_u)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        if auth_s = h1(hk1_1, concat(U, S, X_s, Y, K_s)) then
        sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        authp: hash1 <- h1(hk1_1, concat(U, S, Xp, Yp, Kp));
        sk_p: hash0 <- h0(hk0_1, concat(U, S, Xp, Yp, Kp));
        return(U, Xp, S, Ystarp, authp)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        return(h1(hk1_1, x1_1))
      ))


Applying remove assignments of findcond
  - Remove assignments on sk_p (definition removed, all usages removed)
yields

Game 2 is
      Ostart() :=
      hk0_1 <-R hashkey;
      hk1_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        auth_u: hash1 <- h1(hk1_1, concat(U, S, X, Y_u, K_u));
        sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
        event acceptU(U, X, S, Ystar_u, auth_u, sk_u);
        return(auth_u)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        if auth_s = h1(hk1_1, concat(U, S, X_s, Y, K_s)) then
        sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        authp: hash1 <- h1(hk1_1, concat(U, S, Xp, Yp, Kp));
        return(U, Xp, S, Ystarp, authp)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
 {261}  return(h1(hk1_1, x1_1))
      ))


Applying insert instruction let concat(x11,x12,x13,x14,x15) = x1_1 in at occurrence 261
yields

Game 3 is
      Ostart() :=
      hk0_1 <-R hashkey;
      hk1_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        auth_u: hash1 <- h1(hk1_1, concat(U, S, X, Y_u, K_u));
        sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
        event acceptU(U, X, S, Ystar_u, auth_u, sk_u);
        return(auth_u)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        if auth_s = h1(hk1_1, concat(U, S, X_s, Y, K_s)) then
        sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        authp: hash1 <- h1(hk1_1, concat(U, S, Xp, Yp, Kp));
        return(U, Xp, S, Ystarp, authp)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          return(h1(hk1_1, x1_1))
        else
          return(h1(hk1_1, x1_1))
      ))


Applying equivalence rom(h1) [probability NS / |hash1|]
  - Equivalence rom(h1) with variables: hk1_1 -> hk
yields

Game 4 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        auth_u: hash1 <- (x_O: bitstring <- concat(U, S, X, Y_u, K_u); {52}find [unique] u_19 = ri_19 <= NU suchthat defined(x_O[ri_19], r[ri_19]) && (x_O = x_O[ri_19]) then r[u_19] orfind u_18 = ri_18 <= NP suchthat defined(x_O_1[ri_18], r_1[ri_18]) && {65}(x_O = x_O_1[ri_18]) then r_1[u_18] orfind u_17 = ri_17 <= qH1 suchthat defined(x_O_2[ri_17], r_2[ri_17]) && (x_O = x_O_2[ri_17]) then r_2[u_17] orfind u_16 = ri_16 <= qH1 suchthat defined(x_O_3[ri_16], r_3[ri_16]) && {85}(x_O = x_O_3[ri_16]) then r_3[u_16] else r <-R hash1; r);
        sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
        event acceptU(U, X, S, Ystar_u, auth_u, sk_u);
        return(auth_u)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        if (x_Oeq: bitstring <- concat(U, S, X_s, Y, K_s); X_Oeq: hash1 <- auth_s; {175}find [unique] u_15 = ri_15 <= NU suchthat defined(x_O[ri_15], r[ri_15]) && (x_Oeq = x_O[ri_15]) then (X_Oeq = r[u_15]) orfind u_14 = ri_14 <= NP suchthat defined(x_O_1[ri_14], r_1[ri_14]) && {191}(x_Oeq = x_O_1[ri_14]) then (X_Oeq = r_1[u_14]) orfind u_13 = ri_13 <= qH1 suchthat defined(x_O_2[ri_13], r_2[ri_13]) && (x_Oeq = x_O_2[ri_13]) then (X_Oeq = r_2[u_13]) orfind u_12 = ri_12 <= qH1 suchthat defined(x_O_3[ri_12], r_3[ri_12]) && {217}(x_Oeq = x_O_3[ri_12]) then (X_Oeq = r_3[u_12]) else false) then
        sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        authp: hash1 <- (x_O_1: bitstring <- concat(U, S, Xp, Yp, Kp); {301}find [unique] u_11 = ri_11 <= NU suchthat defined(x_O[ri_11], r[ri_11]) && {304}(x_O_1 = x_O[ri_11]) then r[u_11] orfind u_10 = ri_10 <= NP suchthat defined(x_O_1[ri_10], r_1[ri_10]) && (x_O_1 = x_O_1[ri_10]) then r_1[u_10] orfind u_9 = ri_9 <= qH1 suchthat defined(x_O_2[ri_9], r_2[ri_9]) && (x_O_1 = x_O_2[ri_9]) then r_2[u_9] orfind u_8 = ri_8 <= qH1 suchthat defined(x_O_3[ri_8], r_3[ri_8]) && {334}(x_O_1 = x_O_3[ri_8]) then r_3[u_8] else r_1 <-R hash1; r_1);
        return(U, Xp, S, Ystarp, authp)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          return((x_O_2: bitstring <- x1_1; {407}find [unique] u_7 = ri_7 <= NU suchthat defined(x_O[ri_7], r[ri_7]) && (x_O_2 = x_O[ri_7]) then r[u_7] orfind u_6 = ri_6 <= NP suchthat defined(x_O_1[ri_6], r_1[ri_6]) && (x_O_2 = x_O_1[ri_6]) then r_1[u_6] orfind u_5 = ri_5 <= qH1 suchthat defined(x_O_2[ri_5], r_2[ri_5]) && (x_O_2 = x_O_2[ri_5]) then r_2[u_5] orfind u_4 = ri_4 <= qH1 suchthat defined(x_O_3[ri_4], r_3[ri_4]) && {440}(x_O_2 = x_O_3[ri_4]) then r_3[u_4] else r_2 <-R hash1; r_2))
        else
          return((x_O_3: bitstring <- x1_1; {457}find [unique] u_3 = ri_3 <= NU suchthat defined(x_O[ri_3], r[ri_3]) && {460}(x_O_3 = x_O[ri_3]) then r[u_3] orfind u_2 = ri_2 <= NP suchthat defined(x_O_1[ri_2], r_1[ri_2]) && {470}(x_O_3 = x_O_1[ri_2]) then r_1[u_2] orfind u_1 = ri_1 <= qH1 suchthat defined(x_O_2[ri_1], r_2[ri_1]) && {480}(x_O_3 = x_O_2[ri_1]) then r_2[u_1] orfind u = ri <= qH1 suchthat defined(x_O_3[ri], r_3[ri]) && (x_O_3 = x_O_3[ri]) then r_3[u] else r_3 <-R hash1; r_3))
      ))


Applying simplify (non-expanded game) [probability (NS * NP + 0.5 * NU * NU + NU * NP + NP * NP) / |Z|]
  - Simplification pass
    - Replaced (x_O = x_O_3[ri_16]) with false at 85
    - Remove branch 4 in find at 52
    - Replaced (x_O = x_O_1[ri_18]) with false at 65
    - Remove branch 2 in find at 52
    - Replaced (x_Oeq = x_O_3[ri_12]) with false at 217
    - Remove branch 4 in find at 175
    - Replaced (x_Oeq = x_O_1[ri_14]) with false at 191
    - Remove branch 2 in find at 175
    - Replaced (x_O_1 = x_O_3[ri_8]) with false at 334
    - Remove branch 4 in find at 301
    - Replaced (x_O_1 = x_O[ri_11]) with false at 304
    - Remove branch 1 in find at 301
    - Replaced (x_O_2 = x_O_3[ri_4]) with false at 440
    - Remove branch 4 in find at 407
    - Replaced (x_O_3 = x_O_2[ri_1]) with false at 480
    - Remove branch 3 in find at 457
    - Replaced (x_O_3 = x_O_1[ri_2]) with false at 470
    - Remove branch 2 in find at 457
    - Replaced (x_O_3 = x_O[ri_3]) with false at 460
    - Remove branch 1 in find at 457
yields

Game 5 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        auth_u: hash1 <- (x_O: bitstring <- concat(U, S, X, Y_u, K_u); {52}find [unique] u_19 = ri_19 <= NU suchthat defined(x_O[ri_19], r[ri_19]) && (x_O = x_O[ri_19]) then r[u_19] orfind u_17 = ri_17 <= qH1 suchthat defined(x_O_2[ri_17], r_2[ri_17]) && (x_O = x_O_2[ri_17]) then r_2[u_17] else r <-R hash1; r);
        sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
        event acceptU(U, X, S, Ystar_u, auth_u, sk_u);
        return(auth_u)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
 {141}  if (x_Oeq: bitstring <- concat(U, S, X_s, Y, K_s); X_Oeq: hash1 <- auth_s; find [unique] u_15 = ri_15 <= NU suchthat defined(x_O[ri_15], r[ri_15]) && (x_Oeq = x_O[ri_15]) then (X_Oeq = r[u_15]) orfind u_13 = ri_13 <= qH1 suchthat defined(x_O_2[ri_13], r_2[ri_13]) && (x_Oeq = x_O_2[ri_13]) then (X_Oeq = r_2[u_13]) else false) then
        sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        authp: hash1 <- (x_O_1: bitstring <- concat(U, S, Xp, Yp, Kp); {255}find [unique] u_10 = ri_10 <= NP suchthat defined(x_O_1[ri_10], r_1[ri_10]) && (x_O_1 = x_O_1[ri_10]) then r_1[u_10] orfind u_9 = ri_9 <= qH1 suchthat defined(x_O_2[ri_9], r_2[ri_9]) && (x_O_1 = x_O_2[ri_9]) then r_2[u_9] else r_1 <-R hash1; r_1);
        return(U, Xp, S, Ystarp, authp)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          return((x_O_2: bitstring <- x1_1; find [unique] u_7 = ri_7 <= NU suchthat defined(x_O[ri_7], r[ri_7]) && (x_O_2 = x_O[ri_7]) then r[u_7] orfind u_6 = ri_6 <= NP suchthat defined(x_O_1[ri_6], r_1[ri_6]) && (x_O_2 = x_O_1[ri_6]) then r_1[u_6] orfind u_5 = ri_5 <= qH1 suchthat defined(x_O_2[ri_5], r_2[ri_5]) && (x_O_2 = x_O_2[ri_5]) then r_2[u_5] else r_2 <-R hash1; r_2))
        else
          return((x_O_3: bitstring <- x1_1; find [unique] u = ri <= qH1 suchthat defined(x_O_3[ri], r_3[ri]) && (x_O_3 = x_O_3[ri]) then r_3[u] else r_3 <-R hash1; r_3))
      ))


Applying expand [probability (0.5 * NU * NU + 0.5 * NP * NP) / |Z|]
  - Expand if/find/let
    - Remove branch 1 in find at 255
    - Test at 141 always false
    - Remove branch 1 in find at 52
yields

Game 6 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        x_O: bitstring <- concat(U, S, X, Y_u, K_u);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(x_O_2[ri_17], r_2[ri_17]) && (x_O = x_O_2[ri_17]) then
          auth_u: hash1 <- r_2[u_17];
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, auth_u, sk_u);
          return(auth_u)
        else
          r <-R hash1;
          auth_u: hash1 <- r;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, auth_u, sk_u);
          return(auth_u)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        x_Oeq: bitstring <- concat(U, S, X_s, Y, K_s);
        X_Oeq: hash1 <- auth_s;
        find [unique] u_15 = ri_15 <= NU suchthat defined(x_O[ri_15], r[ri_15]) && (x_Oeq = x_O[ri_15]) then
        (
          if X_Oeq = r[u_15] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
        orfind u_13 = ri_13 <= qH1 suchthat defined(x_O_2[ri_13], r_2[ri_13]) && (x_Oeq = x_O_2[ri_13]) then
        (
          if X_Oeq = r_2[u_13] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        x_O_1: bitstring <- concat(U, S, Xp, Yp, Kp);
        find [unique] u_9 = ri_9 <= qH1 suchthat defined(x_O_2[ri_9], r_2[ri_9]) && (x_O_1 = x_O_2[ri_9]) then
          authp: hash1 <- r_2[u_9];
          return(U, Xp, S, Ystarp, authp)
        else
          r_1 <-R hash1;
          authp: hash1 <- r_1;
          return(U, Xp, S, Ystarp, authp)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          x_O_2: bitstring <- x1_1;
          find [unique] u_7 = ri_7 <= NU suchthat defined(x_O[ri_7], r[ri_7]) && (x_O_2 = x_O[ri_7]) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(x_O_1[ri_6], r_1[ri_6]) && (x_O_2 = x_O_1[ri_6]) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(x_O_2[ri_5], r_2[ri_5]) && (x_O_2 = x_O_2[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          x_O_3: bitstring <- x1_1;
          find [unique] u = ri <= qH1 suchthat defined(x_O_3[ri], r_3[ri]) && (x_O_3 = x_O_3[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on x_O_3 (definition point kept, all usages removed)
  - Remove assignments on x_O_2 (definition point kept, all usages removed)
  - Remove assignments on authp (definition removed, all usages removed)
  - Remove assignments on authp (definition removed, all usages removed)
  - Remove assignments on X_Oeq (definition removed, all usages removed)
  - Remove assignments on auth_u (definition removed, all usages removed)
  - Remove assignments on auth_u (definition removed, all usages removed)
yields

Game 7 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        x_O: bitstring <- concat(U, S, X, Y_u, K_u);
  {51}  find [unique] u_17 = ri_17 <= qH1 suchthat defined(x1_1[ri_17], x_O_2[ri_17], r_2[ri_17]) && {55}(x_O = x1_1[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        x_Oeq: bitstring <- concat(U, S, X_s, Y, K_s);
 {170}  find [unique] u_15 = ri_15 <= NU suchthat defined(x_O[ri_15], r[ri_15]) && {173}(x_Oeq = x_O[ri_15]) then
        (
          if auth_s = r[u_15] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
        orfind u_13 = ri_13 <= qH1 suchthat defined(x1_1[ri_13], x_O_2[ri_13], r_2[ri_13]) && {217}(x_Oeq = x1_1[ri_13]) then
        (
          if auth_s = r_2[u_13] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        x_O_1: bitstring <- concat(U, S, Xp, Yp, Kp);
 {302}  find [unique] u_9 = ri_9 <= qH1 suchthat defined(x1_1[ri_9], x_O_2[ri_9], r_2[ri_9]) && {306}(x_O_1 = x1_1[ri_9]) then
          return(U, Xp, S, Ystarp, r_2[u_9])
        else
          r_1 <-R hash1;
          return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          x_O_2: bitstring <- cst_bitstring;
 {383}    find [unique] u_7 = ri_7 <= NU suchthat defined(x_O[ri_7], r[ri_7]) && {386}(x1_1 = x_O[ri_7]) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(x_O_1[ri_6], r_1[ri_6]) && {399}(x1_1 = x_O_1[ri_6]) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(x1_1[ri_5], x_O_2[ri_5], r_2[ri_5]) && {413}(x1_1 = x1_1[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          x_O_3: bitstring <- cst_bitstring;
 {433}    find [unique] u = ri <= qH1 suchthat defined(x1_1[ri], x_O_3[ri], r_3[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability 2 * NP * qH1 / |Z|]
  - Simplification pass
    - Replaced defined condition x1_1[ri], x_O_3[ri], r_3[ri] with r_3[ri], x1_1[ri] in find at 433
    - Replaced (x1_1 = x1_1[ri_5]) with ((x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5])) at 413
    - Replaced defined condition x1_1[ri_5], x_O_2[ri_5], r_2[ri_5] with r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5] in find at 383
    - Replaced (x1_1 = x_O_1[ri_6]) with ((x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U)) at 399
    - Replaced defined condition x_O_1[ri_6], r_1[ri_6] with r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6] in find at 383
    - Replaced (x1_1 = x_O[ri_7]) with ((x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U)) at 386
    - Replaced defined condition x_O[ri_7], r[ri_7] with r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7] in find at 383
    - Replaced (x_O_1 = x1_1[ri_9]) with false at 306
    - Remove branch 1 in find at 302
    - Find at 302 removed (else branch kept if any)
    - Replaced (x_Oeq = x1_1[ri_13]) with ((K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13])) at 217
    - Replaced defined condition x1_1[ri_13], x_O_2[ri_13], r_2[ri_13] with r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13] in find at 170
    - Replaced (x_Oeq = x_O[ri_15]) with ((X_s = exp(g, x[ri_15])) && (Y = Y_u[ri_15])) at 173
    - Replaced defined condition x_O[ri_15], r[ri_15] with r[ri_15], Y_u[ri_15], x[ri_15] in find at 170
    - Replaced (x_O = x1_1[ri_17]) with ((K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17])) at 55
    - Replaced defined condition x1_1[ri_17], x_O_2[ri_17], r_2[ri_17] with r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17] in find at 51
yields

Game 8 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        x_O: bitstring <- concat(U, S, X, Y_u, K_u);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        x_Oeq: bitstring <- concat(U, S, X_s, Y, K_s);
        find [unique] u_15 = ri_15 <= NU suchthat defined(r[ri_15], Y_u[ri_15], x[ri_15]) && (X_s = exp(g, x[ri_15])) && (Y = Y_u[ri_15]) then
        (
          if auth_s = r[u_15] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
        orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
        (
          if auth_s = r_2[u_13] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        x_O_1: bitstring <- concat(U, S, Xp, Yp, Kp);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          x_O_2: bitstring <- cst_bitstring;
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          x_O_3: bitstring <- cst_bitstring;
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying move all binders
  - Move assignment to x_O_3
  - Move assignment to x_O_2
  - Move assignment to x_Oeq
  - Move assignment to x_O
yields

Game 9 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        K_s: G <- exp(X_s, y);
        find [unique] u_15 = ri_15 <= NU suchthat defined(r[ri_15], Y_u[ri_15], x[ri_15]) && (X_s = exp(g, x[ri_15])) && (Y = Y_u[ri_15]) then
        (
          if auth_s = r[u_15] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
        orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
        (
          if auth_s = r_2[u_13] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        x_O_1: bitstring <- concat(U, S, Xp, Yp, Kp);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on x_O_1 (definition removed, all usages removed)
yields

Game 10 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
 {168}  K_s: G <- exp(X_s, y);
        find [unique] u_15 = ri_15 <= NU suchthat defined(r[ri_15], Y_u[ri_15], x[ri_15]) && (X_s = exp(g, x[ri_15])) && (Y = Y_u[ri_15]) then
        (
          if auth_s = r[u_15] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
        orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
        (
          if auth_s = r_2[u_13] then
          sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
        )
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then else find jh <= qH1 suchthat defined(x11[jh], x12[jh], x13[jh], x14[jh], r_2[jh]) && (U = x11[jh]) && (S = x12[jh]) && (X_s = x13[jh]) && (Y = x14[jh]) && (auth_s = r_2[jh]) then event_abort Auth at occurrence 168 [probability Pr[event Auth in game 11 with public variables sk_s, sk_u]]
yields

Game 11 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
 {168}  find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- {176}exp(X_s, y);
 {181}    find [unique] u_15 = ri_15 <= NU suchthat defined(r[ri_15], Y_u[ri_15], x[ri_15]) && {185}((X_s = exp(g, x[ri_15])) && (Y = Y_u[ri_15])) then
          (
            if auth_s = r[u_15] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
          else
 {339}      K_s: G <- exp(X_s, y);
 {345}      find [unique] u_15 = ri_15 <= NU suchthat defined(r[ri_15], Y_u[ri_15], x[ri_15]) && (X_s = exp(g, x[ri_15])) && (Y = Y_u[ri_15]) then
            (
              if auth_s = r[u_15] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, Ystar, auth_s, sk_s)
            )
            orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
            (
 {431}        if {432}(auth_s = r_2[u_13]) then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, Ystar, auth_s, sk_s)
            )
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability 0.5 * NU * NU / |Z|]
  - Simplification pass
    - Replaced (auth_s = r_2[u_13]) with false at 432
    - Test at 431 always false
    - Remove branch 1 in find at 345
    - Find at 345 removed (else branch kept if any)
    - Remove let at 339
    - Replaced exp(X_s, y) with exp(g, mult(x[j], y)) at 176
    - Replaced ((X_s = exp(g, x[ri_15])) && (Y = Y_u[ri_15])) with ((j = ri_15) && (Y = Y_u[ri_15])) at 185
    - In branch 1 of find at 181, substituting u_15 with j
    - Replaced defined condition r[ri_15], Y_u[ri_15], x[ri_15] with r[j], Y_u[j] in find at 181
    - Replaced defined condition X[j_1] with x[j_1], X[j_1] in find at 168
yields

Game 12 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && {190}((j = j) && (Y = Y_u[j])) then
          (
            u_15 <= NU <- j;
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((j = j) && (Y = Y_u[j])) with (Y = Y_u[j]) at 190
yields

Game 13 is
      Ostart() :=
      hk0_1 <-R hashkey;
      ck_1 <-R cipherkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- dec(ck_1, Ystar_u, pw0);
        K_u: G <- exp(Y_u, x);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- enc(ck_1, Y, pw0);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            u_15 <= NU <- j;
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- enc(ck_1, Yp, pw0);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return(enc(ck_1, x_1, ke))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return(dec(ck_1, m, kd))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence icm(enc) [probability (qE * qE + 2 * NS * qE + 2 * NP * qE + 2 * qD * qE + 2 * NU * qE + NS * NS + 2 * NP * NS + 2 * qD * NS + 2 * NU * NS + NP * NP + 2 * qD * NP + 2 * NU * NP + qD * qD + 2 * NU * qD + NU * NU + -1 * qE + -1 * NS + -1 * NP + -1 * qD + -1 * NU) / |G|]
  - Equivalence icm(enc) with variables: ck_1 -> ck_2
yields

Game 14 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- (md_O_dec: G <- Ystar_u; k_O_dec: passwd <- pw0; find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], md_O_dec[ri_44], k_O_dec[ri_44]) && (md_O_dec = md_O_dec[ri_44]) && (k_O_dec = k_O_dec[ri_44]) then me_O_dec[u_44] orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], md_O_dec_1[ri_43], k_O_dec_1[ri_43]) && (md_O_dec = md_O_dec_1[ri_43]) && (k_O_dec = k_O_dec_1[ri_43]) then me_O_dec_1[u_43] orfind u_42 = ri_42 <= NS suchthat defined(me_O_enc[ri_42], md_O_enc[ri_42], k_O_enc[ri_42]) && (md_O_dec = md_O_enc[ri_42]) && (k_O_dec = k_O_enc[ri_42]) then me_O_enc[u_42] orfind u_41 = ri_41 <= NP suchthat defined(me_O_enc_1[ri_41], md_O_enc_1[ri_41], k_O_enc_1[ri_41]) && (md_O_dec = md_O_enc_1[ri_41]) && (k_O_dec = k_O_enc_1[ri_41]) then me_O_enc_1[u_41] orfind u_40 = ri_40 <= qE suchthat defined(me_O_enc_2[ri_40], md_O_enc_2[ri_40], k_O_enc_2[ri_40]) && (md_O_dec = md_O_enc_2[ri_40]) && (k_O_dec = k_O_enc_2[ri_40]) then me_O_enc_2[u_40] else me_O_dec <-R G; me_O_dec);
        K_u: G <- exp(Y_u, x);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- (me_O_enc: G <- Y; k_O_enc: passwd <- pw0; {249}find [unique] u_39 = ri_39 <= NU suchthat defined(md_O_dec[ri_39], me_O_dec[ri_39], k_O_dec[ri_39]) && {253}((me_O_enc = me_O_dec[ri_39]) && (k_O_enc = k_O_dec[ri_39])) then md_O_dec[u_39] orfind u_38 = ri_38 <= qD suchthat defined(md_O_dec_1[ri_38], me_O_dec_1[ri_38], k_O_dec_1[ri_38]) && {270}((me_O_enc = me_O_dec_1[ri_38]) && (k_O_enc = k_O_dec_1[ri_38])) then md_O_dec_1[u_38] orfind u_37 = ri_37 <= NS suchthat defined(md_O_enc[ri_37], me_O_enc[ri_37], k_O_enc[ri_37]) && (me_O_enc = me_O_enc[ri_37]) && (k_O_enc = k_O_enc[ri_37]) then md_O_enc[u_37] orfind u_36 = ri_36 <= NP suchthat defined(md_O_enc_1[ri_36], me_O_enc_1[ri_36], k_O_enc_1[ri_36]) && {304}((me_O_enc = me_O_enc_1[ri_36]) && (k_O_enc = k_O_enc_1[ri_36])) then md_O_enc_1[u_36] orfind u_35 = ri_35 <= qE suchthat defined(md_O_enc_2[ri_35], me_O_enc_2[ri_35], k_O_enc_2[ri_35]) && (me_O_enc = me_O_enc_2[ri_35]) && (k_O_enc = k_O_enc_2[ri_35]) then md_O_enc_2[u_35] else md_O_enc <-R G; md_O_enc);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            u_15 <= NU <- j;
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- (me_O_enc_1: G <- Yp; k_O_enc_1: passwd <- pw0; {550}find [unique] u_34 = ri_34 <= NU suchthat defined(md_O_dec[ri_34], me_O_dec[ri_34], k_O_dec[ri_34]) && {554}((me_O_enc_1 = me_O_dec[ri_34]) && (k_O_enc_1 = k_O_dec[ri_34])) then md_O_dec[u_34] orfind u_33 = ri_33 <= qD suchthat defined(md_O_dec_1[ri_33], me_O_dec_1[ri_33], k_O_dec_1[ri_33]) && {571}((me_O_enc_1 = me_O_dec_1[ri_33]) && (k_O_enc_1 = k_O_dec_1[ri_33])) then md_O_dec_1[u_33] orfind u_32 = ri_32 <= NS suchthat defined(md_O_enc[ri_32], me_O_enc[ri_32], k_O_enc[ri_32]) && {588}((me_O_enc_1 = me_O_enc[ri_32]) && (k_O_enc_1 = k_O_enc[ri_32])) then md_O_enc[u_32] orfind u_31 = ri_31 <= NP suchthat defined(md_O_enc_1[ri_31], me_O_enc_1[ri_31], k_O_enc_1[ri_31]) && (me_O_enc_1 = me_O_enc_1[ri_31]) && (k_O_enc_1 = k_O_enc_1[ri_31]) then md_O_enc_1[u_31] orfind u_30 = ri_30 <= qE suchthat defined(md_O_enc_2[ri_30], me_O_enc_2[ri_30], k_O_enc_2[ri_30]) && (me_O_enc_1 = me_O_enc_2[ri_30]) && (k_O_enc_1 = k_O_enc_2[ri_30]) then md_O_enc_2[u_30] else md_O_enc_1 <-R G; md_O_enc_1);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return((me_O_enc_2: G <- x_1; k_O_enc_2: passwd <- ke; find [unique] u_29 = ri_29 <= NU suchthat defined(md_O_dec[ri_29], me_O_dec[ri_29], k_O_dec[ri_29]) && (me_O_enc_2 = me_O_dec[ri_29]) && (k_O_enc_2 = k_O_dec[ri_29]) then md_O_dec[u_29] orfind u_28 = ri_28 <= qD suchthat defined(md_O_dec_1[ri_28], me_O_dec_1[ri_28], k_O_dec_1[ri_28]) && (me_O_enc_2 = me_O_dec_1[ri_28]) && (k_O_enc_2 = k_O_dec_1[ri_28]) then md_O_dec_1[u_28] orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], me_O_enc[ri_27], k_O_enc[ri_27]) && (me_O_enc_2 = me_O_enc[ri_27]) && (k_O_enc_2 = k_O_enc[ri_27]) then md_O_enc[u_27] orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], me_O_enc_1[ri_26], k_O_enc_1[ri_26]) && (me_O_enc_2 = me_O_enc_1[ri_26]) && (k_O_enc_2 = k_O_enc_1[ri_26]) then md_O_enc_1[u_26] orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], me_O_enc_2[ri_25], k_O_enc_2[ri_25]) && (me_O_enc_2 = me_O_enc_2[ri_25]) && (k_O_enc_2 = k_O_enc_2[ri_25]) then md_O_enc_2[u_25] else md_O_enc_2 <-R G; md_O_enc_2))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return((md_O_dec_1: G <- m; k_O_dec_1: passwd <- kd; find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], md_O_dec[ri_24], k_O_dec[ri_24]) && (md_O_dec_1 = md_O_dec[ri_24]) && (k_O_dec_1 = k_O_dec[ri_24]) then me_O_dec[u_24] orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], md_O_dec_1[ri_23], k_O_dec_1[ri_23]) && (md_O_dec_1 = md_O_dec_1[ri_23]) && (k_O_dec_1 = k_O_dec_1[ri_23]) then me_O_dec_1[u_23] orfind u_22 = ri_22 <= NS suchthat defined(me_O_enc[ri_22], md_O_enc[ri_22], k_O_enc[ri_22]) && (md_O_dec_1 = md_O_enc[ri_22]) && (k_O_dec_1 = k_O_enc[ri_22]) then me_O_enc[u_22] orfind u_21 = ri_21 <= NP suchthat defined(me_O_enc_1[ri_21], md_O_enc_1[ri_21], k_O_enc_1[ri_21]) && (md_O_dec_1 = md_O_enc_1[ri_21]) && (k_O_dec_1 = k_O_enc_1[ri_21]) then me_O_enc_1[u_21] orfind u_20 = ri_20 <= qE suchthat defined(me_O_enc_2[ri_20], md_O_enc_2[ri_20], k_O_enc_2[ri_20]) && (md_O_dec_1 = md_O_enc_2[ri_20]) && (k_O_dec_1 = k_O_enc_2[ri_20]) then me_O_enc_2[u_20] else me_O_dec_1 <-R G; me_O_dec_1))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify (non-expanded game) [probability (0.5 * NP * NP + 0.5 * NS * NS + NS * NP + NP * NU + NP * qD + NS * NU + NS * qD) / |Z|]
  - Simplification pass
    - Replaced ((me_O_enc = me_O_enc_1[ri_36]) && (k_O_enc = k_O_enc_1[ri_36])) with false at 304
    - Remove branch 4 in find at 249
    - Replaced ((me_O_enc = me_O_dec_1[ri_38]) && (k_O_enc = k_O_dec_1[ri_38])) with false at 270
    - Remove branch 2 in find at 249
    - Replaced ((me_O_enc = me_O_dec[ri_39]) && (k_O_enc = k_O_dec[ri_39])) with false at 253
    - Remove branch 1 in find at 249
    - Replaced ((me_O_enc_1 = me_O_enc[ri_32]) && (k_O_enc_1 = k_O_enc[ri_32])) with false at 588
    - Remove branch 3 in find at 550
    - Replaced ((me_O_enc_1 = me_O_dec_1[ri_33]) && (k_O_enc_1 = k_O_dec_1[ri_33])) with false at 571
    - Remove branch 2 in find at 550
    - Replaced ((me_O_enc_1 = me_O_dec[ri_34]) && (k_O_enc_1 = k_O_dec[ri_34])) with false at 554
    - Remove branch 1 in find at 550
yields

Game 15 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        Y_u: G <- (md_O_dec: G <- Ystar_u; k_O_dec: passwd <- pw0; find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], md_O_dec[ri_44], k_O_dec[ri_44]) && (md_O_dec = md_O_dec[ri_44]) && (k_O_dec = k_O_dec[ri_44]) then me_O_dec[u_44] orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], md_O_dec_1[ri_43], k_O_dec_1[ri_43]) && (md_O_dec = md_O_dec_1[ri_43]) && (k_O_dec = k_O_dec_1[ri_43]) then me_O_dec_1[u_43] orfind u_42 = ri_42 <= NS suchthat defined(me_O_enc[ri_42], md_O_enc[ri_42], k_O_enc[ri_42]) && (md_O_dec = md_O_enc[ri_42]) && (k_O_dec = k_O_enc[ri_42]) then me_O_enc[u_42] orfind u_41 = ri_41 <= NP suchthat defined(me_O_enc_1[ri_41], md_O_enc_1[ri_41], k_O_enc_1[ri_41]) && (md_O_dec = md_O_enc_1[ri_41]) && (k_O_dec = k_O_enc_1[ri_41]) then me_O_enc_1[u_41] orfind u_40 = ri_40 <= qE suchthat defined(me_O_enc_2[ri_40], md_O_enc_2[ri_40], k_O_enc_2[ri_40]) && (md_O_dec = md_O_enc_2[ri_40]) && (k_O_dec = k_O_enc_2[ri_40]) then me_O_enc_2[u_40] else me_O_dec <-R G; me_O_dec);
        K_u: G <- exp(Y_u, x);
        find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
          return(r_2[u_17])
        else
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        Ystar: G <- (me_O_enc: G <- Y; k_O_enc: passwd <- pw0; {249}find [unique] u_37 = ri_37 <= NS suchthat defined(md_O_enc[ri_37], me_O_enc[ri_37], k_O_enc[ri_37]) && (me_O_enc = me_O_enc[ri_37]) && (k_O_enc = k_O_enc[ri_37]) then md_O_enc[u_37] orfind u_35 = ri_35 <= qE suchthat defined(md_O_enc_2[ri_35], me_O_enc_2[ri_35], k_O_enc_2[ri_35]) && (me_O_enc = me_O_enc_2[ri_35]) && (k_O_enc = k_O_enc_2[ri_35]) then md_O_enc_2[u_35] else md_O_enc <-R G; md_O_enc);
        return(S, Ystar);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            u_15 <= NU <- j;
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, Ystar, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        Ystarp: G <- (me_O_enc_1: G <- Yp; k_O_enc_1: passwd <- pw0; {499}find [unique] u_31 = ri_31 <= NP suchthat defined(md_O_enc_1[ri_31], me_O_enc_1[ri_31], k_O_enc_1[ri_31]) && (me_O_enc_1 = me_O_enc_1[ri_31]) && (k_O_enc_1 = k_O_enc_1[ri_31]) then md_O_enc_1[u_31] orfind u_30 = ri_30 <= qE suchthat defined(md_O_enc_2[ri_30], me_O_enc_2[ri_30], k_O_enc_2[ri_30]) && (me_O_enc_1 = me_O_enc_2[ri_30]) && (k_O_enc_1 = k_O_enc_2[ri_30]) then md_O_enc_2[u_30] else md_O_enc_1 <-R G; md_O_enc_1);
        r_1 <-R hash1;
        return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        return((me_O_enc_2: G <- x_1; k_O_enc_2: passwd <- ke; find [unique] u_29 = ri_29 <= NU suchthat defined(md_O_dec[ri_29], me_O_dec[ri_29], k_O_dec[ri_29]) && (me_O_enc_2 = me_O_dec[ri_29]) && (k_O_enc_2 = k_O_dec[ri_29]) then md_O_dec[u_29] orfind u_28 = ri_28 <= qD suchthat defined(md_O_dec_1[ri_28], me_O_dec_1[ri_28], k_O_dec_1[ri_28]) && (me_O_enc_2 = me_O_dec_1[ri_28]) && (k_O_enc_2 = k_O_dec_1[ri_28]) then md_O_dec_1[u_28] orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], me_O_enc[ri_27], k_O_enc[ri_27]) && (me_O_enc_2 = me_O_enc[ri_27]) && (k_O_enc_2 = k_O_enc[ri_27]) then md_O_enc[u_27] orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], me_O_enc_1[ri_26], k_O_enc_1[ri_26]) && (me_O_enc_2 = me_O_enc_1[ri_26]) && (k_O_enc_2 = k_O_enc_1[ri_26]) then md_O_enc_1[u_26] orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], me_O_enc_2[ri_25], k_O_enc_2[ri_25]) && (me_O_enc_2 = me_O_enc_2[ri_25]) && (k_O_enc_2 = k_O_enc_2[ri_25]) then md_O_enc_2[u_25] else md_O_enc_2 <-R G; md_O_enc_2))
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        return((md_O_dec_1: G <- m; k_O_dec_1: passwd <- kd; find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], md_O_dec[ri_24], k_O_dec[ri_24]) && (md_O_dec_1 = md_O_dec[ri_24]) && (k_O_dec_1 = k_O_dec[ri_24]) then me_O_dec[u_24] orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], md_O_dec_1[ri_23], k_O_dec_1[ri_23]) && (md_O_dec_1 = md_O_dec_1[ri_23]) && (k_O_dec_1 = k_O_dec_1[ri_23]) then me_O_dec_1[u_23] orfind u_22 = ri_22 <= NS suchthat defined(me_O_enc[ri_22], md_O_enc[ri_22], k_O_enc[ri_22]) && (md_O_dec_1 = md_O_enc[ri_22]) && (k_O_dec_1 = k_O_enc[ri_22]) then me_O_enc[u_22] orfind u_21 = ri_21 <= NP suchthat defined(me_O_enc_1[ri_21], md_O_enc_1[ri_21], k_O_enc_1[ri_21]) && (md_O_dec_1 = md_O_enc_1[ri_21]) && (k_O_dec_1 = k_O_enc_1[ri_21]) then me_O_enc_1[u_21] orfind u_20 = ri_20 <= qE suchthat defined(me_O_enc_2[ri_20], md_O_enc_2[ri_20], k_O_enc_2[ri_20]) && (md_O_dec_1 = md_O_enc_2[ri_20]) && (k_O_dec_1 = k_O_enc_2[ri_20]) then me_O_enc_2[u_20] else me_O_dec_1 <-R G; me_O_dec_1))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand [probability (0.5 * NS * NS + 0.5 * NP * NP) / |Z|]
  - Expand if/find/let
    - Remove branch 1 in find at 499
    - Remove branch 1 in find at 249
yields

Game 16 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        md_O_dec: G <- Ystar_u;
        k_O_dec: passwd <- pw0;
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], md_O_dec[ri_44], k_O_dec[ri_44]) && (md_O_dec = md_O_dec[ri_44]) && (k_O_dec = k_O_dec[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(Y_u, x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], md_O_dec_1[ri_43], k_O_dec_1[ri_43]) && (md_O_dec = md_O_dec_1[ri_43]) && (k_O_dec = k_O_dec_1[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(Y_u, x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(me_O_enc[ri_42], md_O_enc[ri_42], k_O_enc[ri_42]) && (md_O_dec = md_O_enc[ri_42]) && (k_O_dec = k_O_enc[ri_42]) then
          Y_u: G <- me_O_enc[u_42];
          K_u: G <- exp(Y_u, x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(me_O_enc_1[ri_41], md_O_enc_1[ri_41], k_O_enc_1[ri_41]) && (md_O_dec = md_O_enc_1[ri_41]) && (k_O_dec = k_O_enc_1[ri_41]) then
          Y_u: G <- me_O_enc_1[u_41];
          K_u: G <- exp(Y_u, x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(me_O_enc_2[ri_40], md_O_enc_2[ri_40], k_O_enc_2[ri_40]) && (md_O_dec = md_O_enc_2[ri_40]) && (k_O_dec = k_O_enc_2[ri_40]) then
          Y_u: G <- me_O_enc_2[u_40];
          K_u: G <- exp(Y_u, x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(Y_u, x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y_u = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y_u, K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        me_O_enc: G <- Y;
        k_O_enc: passwd <- pw0;
        find [unique] u_35 = ri_35 <= qE suchthat defined(md_O_enc_2[ri_35], me_O_enc_2[ri_35], k_O_enc_2[ri_35]) && (me_O_enc = me_O_enc_2[ri_35]) && (k_O_enc = k_O_enc_2[ri_35]) then
        (
          Ystar: G <- md_O_enc_2[u_35];
          return(S, Ystar);
          OS2(auth_s: hash1) :=
          find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
          (
            K_s: G <- exp(g, mult(x[j], y));
            find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
            (
              u_15 <= NU <- j;
              if auth_s = r[j] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, Ystar, auth_s, sk_s)
            )
            orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
            (
              if auth_s = r_2[u_13] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, Ystar, auth_s, sk_s)
            )
          )
          else
            find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
        )
        else
          md_O_enc <-R G;
          Ystar: G <- md_O_enc;
          return(S, Ystar);
          OS2(auth_s: hash1) :=
          find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
          (
            K_s: G <- exp(g, mult(x[j], y));
            find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
            (
              u_15 <= NU <- j;
              if auth_s = r[j] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, Ystar, auth_s, sk_s)
            )
            orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
            (
              if auth_s = r_2[u_13] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, Ystar, auth_s, sk_s)
            )
          )
          else
            find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        me_O_enc_1: G <- Yp;
        k_O_enc_1: passwd <- pw0;
        find [unique] u_30 = ri_30 <= qE suchthat defined(md_O_enc_2[ri_30], me_O_enc_2[ri_30], k_O_enc_2[ri_30]) && (me_O_enc_1 = me_O_enc_2[ri_30]) && (k_O_enc_1 = k_O_enc_2[ri_30]) then
          Ystarp: G <- md_O_enc_2[u_30];
          r_1 <-R hash1;
          return(U, Xp, S, Ystarp, r_1)
        else
          md_O_enc_1 <-R G;
          Ystarp: G <- md_O_enc_1;
          r_1 <-R hash1;
          return(U, Xp, S, Ystarp, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        me_O_enc_2: G <- x_1;
        k_O_enc_2: passwd <- ke;
        find [unique] u_29 = ri_29 <= NU suchthat defined(md_O_dec[ri_29], me_O_dec[ri_29], k_O_dec[ri_29]) && (me_O_enc_2 = me_O_dec[ri_29]) && (k_O_enc_2 = k_O_dec[ri_29]) then
          return(md_O_dec[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(md_O_dec_1[ri_28], me_O_dec_1[ri_28], k_O_dec_1[ri_28]) && (me_O_enc_2 = me_O_dec_1[ri_28]) && (k_O_enc_2 = k_O_dec_1[ri_28]) then
          return(md_O_dec_1[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], me_O_enc[ri_27], k_O_enc[ri_27]) && (me_O_enc_2 = me_O_enc[ri_27]) && (k_O_enc_2 = k_O_enc[ri_27]) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], me_O_enc_1[ri_26], k_O_enc_1[ri_26]) && (me_O_enc_2 = me_O_enc_1[ri_26]) && (k_O_enc_2 = k_O_enc_1[ri_26]) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], me_O_enc_2[ri_25], k_O_enc_2[ri_25]) && (me_O_enc_2 = me_O_enc_2[ri_25]) && (k_O_enc_2 = k_O_enc_2[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        md_O_dec_1: G <- m;
        k_O_dec_1: passwd <- kd;
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], md_O_dec[ri_24], k_O_dec[ri_24]) && (md_O_dec_1 = md_O_dec[ri_24]) && (k_O_dec_1 = k_O_dec[ri_24]) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], md_O_dec_1[ri_23], k_O_dec_1[ri_23]) && (md_O_dec_1 = md_O_dec_1[ri_23]) && (k_O_dec_1 = k_O_dec_1[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(me_O_enc[ri_22], md_O_enc[ri_22], k_O_enc[ri_22]) && (md_O_dec_1 = md_O_enc[ri_22]) && (k_O_dec_1 = k_O_enc[ri_22]) then
          return(me_O_enc[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(me_O_enc_1[ri_21], md_O_enc_1[ri_21], k_O_enc_1[ri_21]) && (md_O_dec_1 = md_O_enc_1[ri_21]) && (k_O_dec_1 = k_O_enc_1[ri_21]) then
          return(me_O_enc_1[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(me_O_enc_2[ri_20], md_O_enc_2[ri_20], k_O_enc_2[ri_20]) && (md_O_dec_1 = md_O_enc_2[ri_20]) && (k_O_dec_1 = k_O_enc_2[ri_20]) then
          return(me_O_enc_2[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on md_O_dec_1 (definition point kept, all usages removed)
  - Remove assignments on k_O_dec_1 (definition removed, all usages removed)
  - Remove assignments on me_O_enc_2 (definition point kept, all usages removed)
  - Remove assignments on k_O_enc_2 (definition removed, all usages removed)
  - Remove assignments on me_O_enc_1 (definition removed, all usages removed)
  - Remove assignments on k_O_enc_1 (definition removed, all usages removed)
  - Remove assignments on Ystarp (definition removed, all usages removed)
  - Remove assignments on Ystarp (definition removed, all usages removed)
  - Remove assignments on me_O_enc (definition removed, all usages removed)
  - Remove assignments on k_O_enc (definition removed, all usages removed)
  - Remove assignments on Ystar (definition removed, all usages removed)
  - Remove assignments on u_15 (definition removed, all usages removed)
  - Remove assignments on Ystar (definition removed, all usages removed)
  - Remove assignments on u_15 (definition removed, all usages removed)
  - Remove assignments on md_O_dec (definition point kept, all usages removed)
  - Remove assignments on k_O_dec (definition removed, all usages removed)
  - Remove assignments on Y_u (definition kept, array references kept)
  - Remove assignments on Y_u (definition kept, array references kept)
  - Remove assignments on Y_u (definition kept, array references kept)
  - Remove assignments on Y_u (definition kept, array references kept)
  - Remove assignments on Y_u (definition kept, array references kept)
  - Remove assignments on Y_u (definition kept, array references kept)
yields

Game 17 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        md_O_dec: G <- cst_G;
  {30}  find [unique] u_44 = ri_44 <= NU suchthat defined(Ystar_u[ri_44], pw0, md_O_dec[ri_44], md_O_dec[ri_44], me_O_dec[ri_44]) && {35}((Ystar_u = Ystar_u[ri_44]) && (pw0 = pw0)) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(m[ri_43], kd[ri_43], md_O_dec_1[ri_43], md_O_dec_1[ri_43], me_O_dec_1[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(Y[ri_42], pw0, Y[ri_42], Y[ri_42], md_O_enc[ri_42]) && {297}((Ystar_u = md_O_enc[ri_42]) && (pw0 = pw0)) then
          Y_u: G <- Y[u_42];
          K_u: G <- {311}exp(Y[u_42], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(Yp[ri_41], pw0, Kp[ri_41], Kp[ri_41], md_O_enc_1[ri_41]) && {427}((Ystar_u = md_O_enc_1[ri_41]) && (pw0 = pw0)) then
          Y_u: G <- Yp[u_41];
          K_u: G <- {441}exp(Yp[u_41], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(x_1[ri_40], ke[ri_40], me_O_enc_2[ri_40], me_O_enc_2[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          Y_u: G <- x_1[u_40];
          K_u: G <- exp(x_1[u_40], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (x_1[u_40] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, x_1[u_40], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, x_1[u_40], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
 {695}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && {702}((K_u = x15[ri_17]) && (me_O_dec = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17])) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec, K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec, K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
 {810}  find [unique] u_35 = ri_35 <= qE suchthat defined(x_1[ri_35], ke[ri_35], me_O_enc_2[ri_35], me_O_enc_2[ri_35], md_O_enc_2[ri_35]) && {816}((Y = x_1[ri_35]) && (pw0 = ke[ri_35])) then
        (
          return(S, md_O_enc_2[u_35]);
          OS2(auth_s: hash1) :=
          find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
          (
            K_s: G <- exp(g, mult(x[j], y));
            find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
            (
              if auth_s = r[j] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, md_O_enc_2[u_35], auth_s, sk_s)
            )
            orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
            (
              if auth_s = r_2[u_13] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, md_O_enc_2[u_35], auth_s, sk_s)
            )
          )
          else
            find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
        )
        else
          md_O_enc <-R G;
          return(S, md_O_enc);
          OS2(auth_s: hash1) :=
          find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
          (
            K_s: G <- exp(g, mult(x[j], y));
            find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
            (
              if auth_s = r[j] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
            )
            orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
            (
              if auth_s = r_2[u_13] then
              sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
            )
          )
          else
            find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
{1208}  find [unique] u_30 = ri_30 <= qE suchthat defined(x_1[ri_30], ke[ri_30], me_O_enc_2[ri_30], me_O_enc_2[ri_30], md_O_enc_2[ri_30]) && {1214}((Yp = x_1[ri_30]) && (pw0 = ke[ri_30])) then
          r_1 <-R hash1;
          return(U, Xp, S, md_O_enc_2[u_30], r_1)
        else
          md_O_enc_1 <-R G;
          r_1 <-R hash1;
          return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        me_O_enc_2: G <- cst_G;
{1259}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], pw0, md_O_dec[ri_29], md_O_dec[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], md_O_dec_1[ri_28], md_O_dec_1[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(Y[ri_27], pw0, Y[ri_27], Y[ri_27], md_O_enc[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(Yp[ri_26], pw0, Kp[ri_26], Kp[ri_26], md_O_enc_1[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(x_1[ri_25], ke[ri_25], me_O_enc_2[ri_25], me_O_enc_2[ri_25], md_O_enc_2[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        md_O_dec_1: G <- cst_G;
{1376}  find [unique] u_24 = ri_24 <= NU suchthat defined(Ystar_u[ri_24], pw0, md_O_dec[ri_24], md_O_dec[ri_24], me_O_dec[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(m[ri_23], kd[ri_23], md_O_dec_1[ri_23], md_O_dec_1[ri_23], me_O_dec_1[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], pw0, Y[ri_22], Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], pw0, Kp[ri_21], Kp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], me_O_enc_2[ri_20], me_O_enc_2[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability (2 * NP * qH1 + qE * NS + qE * NP) / |Z| + qH1 * NU / |G|]
  - Simplification pass
    - Replaced defined condition x_1[ri_20], ke[ri_20], me_O_enc_2[ri_20], me_O_enc_2[ri_20], md_O_enc_2[ri_20] with x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20] in find at 1376
    - Replaced defined condition Yp[ri_21], pw0, Kp[ri_21], Kp[ri_21], md_O_enc_1[ri_21] with Yp[ri_21], md_O_enc_1[ri_21] in find at 1376
    - Replaced defined condition Y[ri_22], pw0, Y[ri_22], Y[ri_22], md_O_enc[ri_22] with Y[ri_22], md_O_enc[ri_22] in find at 1376
    - Replaced defined condition m[ri_23], kd[ri_23], md_O_dec_1[ri_23], md_O_dec_1[ri_23], me_O_dec_1[ri_23] with me_O_dec_1[ri_23], kd[ri_23], m[ri_23] in find at 1376
    - Replaced defined condition Ystar_u[ri_24], pw0, md_O_dec[ri_24], md_O_dec[ri_24], me_O_dec[ri_24] with me_O_dec[ri_24], Ystar_u[ri_24] in find at 1376
    - Replaced defined condition x_1[ri_25], ke[ri_25], me_O_enc_2[ri_25], me_O_enc_2[ri_25], md_O_enc_2[ri_25] with md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25] in find at 1259
    - Replaced defined condition Yp[ri_26], pw0, Kp[ri_26], Kp[ri_26], md_O_enc_1[ri_26] with md_O_enc_1[ri_26], Yp[ri_26] in find at 1259
    - Replaced defined condition Y[ri_27], pw0, Y[ri_27], Y[ri_27], md_O_enc[ri_27] with md_O_enc[ri_27], Y[ri_27] in find at 1259
    - Replaced defined condition m[ri_28], kd[ri_28], md_O_dec_1[ri_28], md_O_dec_1[ri_28], me_O_dec_1[ri_28] with m[ri_28], kd[ri_28], me_O_dec_1[ri_28] in find at 1259
    - Replaced defined condition Ystar_u[ri_29], pw0, md_O_dec[ri_29], md_O_dec[ri_29], me_O_dec[ri_29] with Ystar_u[ri_29], me_O_dec[ri_29] in find at 1259
    - Replaced ((Yp = x_1[ri_30]) && (pw0 = ke[ri_30])) with false at 1214
    - Remove branch 1 in find at 1208
    - Find at 1208 removed (else branch kept if any)
    - Replaced ((Y = x_1[ri_35]) && (pw0 = ke[ri_35])) with false at 816
    - Remove branch 1 in find at 810
    - Find at 810 removed (else branch kept if any)
    - Replaced ((K_u = x15[ri_17]) && (me_O_dec = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17])) with false at 702
    - Remove branch 1 in find at 695
    - Find at 695 removed (else branch kept if any)
    - Replaced defined condition x_1[ri_40], ke[ri_40], me_O_enc_2[ri_40], me_O_enc_2[ri_40], md_O_enc_2[ri_40] with x_1[ri_40], ke[ri_40], md_O_enc_2[ri_40] in find at 30
    - Replaced ((Ystar_u = md_O_enc_1[ri_41]) && (pw0 = pw0)) with (Ystar_u = md_O_enc_1[ri_41]) at 427
    - Replaced exp(Yp[u_41], x) with exp(g, mult(yp[u_41], x)) at 441
    - Replaced defined condition Yp[ri_41], pw0, Kp[ri_41], Kp[ri_41], md_O_enc_1[ri_41] with yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41] in find at 30
    - Replaced ((Ystar_u = md_O_enc[ri_42]) && (pw0 = pw0)) with (Ystar_u = md_O_enc[ri_42]) at 297
    - Replaced exp(Y[u_42], x) with exp(g, mult(y[u_42], x)) at 311
    - Replaced defined condition Y[ri_42], pw0, Y[ri_42], Y[ri_42], md_O_enc[ri_42] with y[ri_42], Y[ri_42], md_O_enc[ri_42] in find at 30
    - Replaced defined condition m[ri_43], kd[ri_43], md_O_dec_1[ri_43], md_O_dec_1[ri_43], me_O_dec_1[ri_43] with me_O_dec_1[ri_43], kd[ri_43], m[ri_43] in find at 30
    - Replaced ((Ystar_u = Ystar_u[ri_44]) && (pw0 = pw0)) with (Ystar_u = Ystar_u[ri_44]) at 35
    - Replaced defined condition Ystar_u[ri_44], pw0, md_O_dec[ri_44], md_O_dec[ri_44], me_O_dec[ri_44] with me_O_dec[ri_44], Ystar_u[ri_44] in find at 30
yields

Game 18 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        md_O_dec: G <- cst_G;
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(x_1[ri_40], ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          Y_u: G <- x_1[u_40];
          K_u: G <- exp(x_1[u_40], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (x_1[u_40] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, x_1[u_40], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, x_1[u_40], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        me_O_enc_2: G <- cst_G;
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        md_O_dec_1: G <- cst_G;
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying move all binders
  - Move assignment to md_O_dec_1
  - Move assignment to me_O_enc_2
  - Move assignment to md_O_dec
yields

Game 19 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(x_1[ri_40], ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
 {550}    Y_u: G <- x_1[u_40];
          K_u: G <- exp(x_1[u_40], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (x_1[u_40] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, x_1[u_40], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, x_1[u_40], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying insert event Encrypt at occurrence 550 [probability Pr[event Encrypt in game 20 with public variables sk_u, sk_s]]
yields

Game 20 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(x_1[ri_40], ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
{1037}  return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying insert instruction let concat(x01,x02,x03,x04,x05) = x1 in at occurrence 1037
yields

Game 21 is
      Ostart() :=
      hk0_1 <-R hashkey;
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec[u_44], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec_1[u_43], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Y[u_42], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- h0(hk0_1, concat(U, S, X, Yp[u_41], K_u));
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(x_1[ri_40], ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          sk_u: hash0 <- h0(hk0_1, concat(U, S, X, me_O_dec, K_u));
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- h0(hk0_1, concat(U, S, X_s, Y, K_s));
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          return(h0(hk0_1, x1))
        else
          return(h0(hk0_1, x1))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence rom(h0)
  - Equivalence rom(h0) with variables: hk0_1 -> hk
yields

Game 22 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_6: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u); {93}find [unique] u_135 = ri_135 <= NU suchthat defined(x_O_4[ri_135], r_4[ri_135]) && (x_O_6 = x_O_4[ri_135]) then r_4[u_135] orfind u_134 = ri_134 <= NU suchthat defined(x_O_5[ri_134], r_5[ri_134]) && (x_O_6 = x_O_5[ri_134]) then r_5[u_134] orfind u_133 = ri_133 <= NU suchthat defined(x_O_6[ri_133], r_6[ri_133]) && (x_O_6 = x_O_6[ri_133]) then r_6[u_133] orfind u_132 = ri_132 <= NU suchthat defined(x_O_7[ri_132], r_7[ri_132]) && {126}(x_O_6 = x_O_7[ri_132]) then r_7[u_132] orfind u_131 = ri_131 <= NU suchthat defined(x_O_8[ri_131], r_8[ri_131]) && {136}(x_O_6 = x_O_8[ri_131]) then r_8[u_131] orfind u_130 = ri_130 <= NU suchthat defined(x_O_9[ri_130], r_9[ri_130]) && {146}(x_O_6 = x_O_9[ri_130]) then r_9[u_130] orfind u_129 = ri_129 <= NU suchthat defined(x_O_10[ri_129], r_10[ri_129]) && {156}(x_O_6 = x_O_10[ri_129]) then r_10[u_129] orfind u_128 = ri_128 <= NU suchthat defined(x_O_11[ri_128], r_11[ri_128]) && {166}(x_O_6 = x_O_11[ri_128]) then r_11[u_128] orfind u_127 = ri_127 <= NU suchthat defined(x_O_12[ri_127], r_12[ri_127]) && {176}(x_O_6 = x_O_12[ri_127]) then r_12[u_127] orfind u_126 = ri_126 <= NS suchthat defined(x_O_13[ri_126], r_13[ri_126]) && {186}(x_O_6 = x_O_13[ri_126]) then r_13[u_126] orfind u_125 = ri_125 <= NS suchthat defined(x_O_14[ri_125], r_14[ri_125]) && {196}(x_O_6 = x_O_14[ri_125]) then r_14[u_125] orfind u_124 = ri_124 <= qH0 suchthat defined(x_O_15[ri_124], r_15[ri_124]) && (x_O_6 = x_O_15[ri_124]) then r_15[u_124] orfind u_123 = ri_123 <= qH0 suchthat defined(x_O_16[ri_123], r_16[ri_123]) && {216}(x_O_6 = x_O_16[ri_123]) then r_16[u_123] else r_6 <-R hash0; r_6);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_5: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u); {262}find [unique] u_122 = ri_122 <= NU suchthat defined(x_O_4[ri_122], r_4[ri_122]) && (x_O_5 = x_O_4[ri_122]) then r_4[u_122] orfind u_121 = ri_121 <= NU suchthat defined(x_O_5[ri_121], r_5[ri_121]) && (x_O_5 = x_O_5[ri_121]) then r_5[u_121] orfind u_120 = ri_120 <= NU suchthat defined(x_O_6[ri_120], r_6[ri_120]) && (x_O_5 = x_O_6[ri_120]) then r_6[u_120] orfind u_119 = ri_119 <= NU suchthat defined(x_O_7[ri_119], r_7[ri_119]) && {295}(x_O_5 = x_O_7[ri_119]) then r_7[u_119] orfind u_118 = ri_118 <= NU suchthat defined(x_O_8[ri_118], r_8[ri_118]) && {305}(x_O_5 = x_O_8[ri_118]) then r_8[u_118] orfind u_117 = ri_117 <= NU suchthat defined(x_O_9[ri_117], r_9[ri_117]) && {315}(x_O_5 = x_O_9[ri_117]) then r_9[u_117] orfind u_116 = ri_116 <= NU suchthat defined(x_O_10[ri_116], r_10[ri_116]) && {325}(x_O_5 = x_O_10[ri_116]) then r_10[u_116] orfind u_115 = ri_115 <= NU suchthat defined(x_O_11[ri_115], r_11[ri_115]) && {335}(x_O_5 = x_O_11[ri_115]) then r_11[u_115] orfind u_114 = ri_114 <= NU suchthat defined(x_O_12[ri_114], r_12[ri_114]) && {345}(x_O_5 = x_O_12[ri_114]) then r_12[u_114] orfind u_113 = ri_113 <= NS suchthat defined(x_O_13[ri_113], r_13[ri_113]) && {355}(x_O_5 = x_O_13[ri_113]) then r_13[u_113] orfind u_112 = ri_112 <= NS suchthat defined(x_O_14[ri_112], r_14[ri_112]) && {365}(x_O_5 = x_O_14[ri_112]) then r_14[u_112] orfind u_111 = ri_111 <= qH0 suchthat defined(x_O_15[ri_111], r_15[ri_111]) && (x_O_5 = x_O_15[ri_111]) then r_15[u_111] orfind u_110 = ri_110 <= qH0 suchthat defined(x_O_16[ri_110], r_16[ri_110]) && {385}(x_O_5 = x_O_16[ri_110]) then r_16[u_110] else r_5 <-R hash0; r_5);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_8: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u); {489}find [unique] u_161 = ri_161 <= NU suchthat defined(x_O_4[ri_161], r_4[ri_161]) && {492}(x_O_8 = x_O_4[ri_161]) then r_4[u_161] orfind u_160 = ri_160 <= NU suchthat defined(x_O_5[ri_160], r_5[ri_160]) && {502}(x_O_8 = x_O_5[ri_160]) then r_5[u_160] orfind u_159 = ri_159 <= NU suchthat defined(x_O_6[ri_159], r_6[ri_159]) && {512}(x_O_8 = x_O_6[ri_159]) then r_6[u_159] orfind u_158 = ri_158 <= NU suchthat defined(x_O_7[ri_158], r_7[ri_158]) && (x_O_8 = x_O_7[ri_158]) then r_7[u_158] orfind u_157 = ri_157 <= NU suchthat defined(x_O_8[ri_157], r_8[ri_157]) && (x_O_8 = x_O_8[ri_157]) then r_8[u_157] orfind u_156 = ri_156 <= NU suchthat defined(x_O_9[ri_156], r_9[ri_156]) && {542}(x_O_8 = x_O_9[ri_156]) then r_9[u_156] orfind u_155 = ri_155 <= NU suchthat defined(x_O_10[ri_155], r_10[ri_155]) && {552}(x_O_8 = x_O_10[ri_155]) then r_10[u_155] orfind u_154 = ri_154 <= NU suchthat defined(x_O_11[ri_154], r_11[ri_154]) && {562}(x_O_8 = x_O_11[ri_154]) then r_11[u_154] orfind u_153 = ri_153 <= NU suchthat defined(x_O_12[ri_153], r_12[ri_153]) && {572}(x_O_8 = x_O_12[ri_153]) then r_12[u_153] orfind u_152 = ri_152 <= NS suchthat defined(x_O_13[ri_152], r_13[ri_152]) && {582}(x_O_8 = x_O_13[ri_152]) then r_13[u_152] orfind u_151 = ri_151 <= NS suchthat defined(x_O_14[ri_151], r_14[ri_151]) && {592}(x_O_8 = x_O_14[ri_151]) then r_14[u_151] orfind u_150 = ri_150 <= qH0 suchthat defined(x_O_15[ri_150], r_15[ri_150]) && (x_O_8 = x_O_15[ri_150]) then r_15[u_150] orfind u_149 = ri_149 <= qH0 suchthat defined(x_O_16[ri_149], r_16[ri_149]) && {612}(x_O_8 = x_O_16[ri_149]) then r_16[u_149] else r_8 <-R hash0; r_8);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_7: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u); {658}find [unique] u_148 = ri_148 <= NU suchthat defined(x_O_4[ri_148], r_4[ri_148]) && {661}(x_O_7 = x_O_4[ri_148]) then r_4[u_148] orfind u_147 = ri_147 <= NU suchthat defined(x_O_5[ri_147], r_5[ri_147]) && {671}(x_O_7 = x_O_5[ri_147]) then r_5[u_147] orfind u_146 = ri_146 <= NU suchthat defined(x_O_6[ri_146], r_6[ri_146]) && {681}(x_O_7 = x_O_6[ri_146]) then r_6[u_146] orfind u_145 = ri_145 <= NU suchthat defined(x_O_7[ri_145], r_7[ri_145]) && (x_O_7 = x_O_7[ri_145]) then r_7[u_145] orfind u_144 = ri_144 <= NU suchthat defined(x_O_8[ri_144], r_8[ri_144]) && (x_O_7 = x_O_8[ri_144]) then r_8[u_144] orfind u_143 = ri_143 <= NU suchthat defined(x_O_9[ri_143], r_9[ri_143]) && {711}(x_O_7 = x_O_9[ri_143]) then r_9[u_143] orfind u_142 = ri_142 <= NU suchthat defined(x_O_10[ri_142], r_10[ri_142]) && {721}(x_O_7 = x_O_10[ri_142]) then r_10[u_142] orfind u_141 = ri_141 <= NU suchthat defined(x_O_11[ri_141], r_11[ri_141]) && {731}(x_O_7 = x_O_11[ri_141]) then r_11[u_141] orfind u_140 = ri_140 <= NU suchthat defined(x_O_12[ri_140], r_12[ri_140]) && {741}(x_O_7 = x_O_12[ri_140]) then r_12[u_140] orfind u_139 = ri_139 <= NS suchthat defined(x_O_13[ri_139], r_13[ri_139]) && {751}(x_O_7 = x_O_13[ri_139]) then r_13[u_139] orfind u_138 = ri_138 <= NS suchthat defined(x_O_14[ri_138], r_14[ri_138]) && {761}(x_O_7 = x_O_14[ri_138]) then r_14[u_138] orfind u_137 = ri_137 <= qH0 suchthat defined(x_O_15[ri_137], r_15[ri_137]) && (x_O_7 = x_O_15[ri_137]) then r_15[u_137] orfind u_136 = ri_136 <= qH0 suchthat defined(x_O_16[ri_136], r_16[ri_136]) && {781}(x_O_7 = x_O_16[ri_136]) then r_16[u_136] else r_7 <-R hash0; r_7);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_10: bitstring <- concat(U, S, X, Y[u_42], K_u); {882}find [unique] u_187 = ri_187 <= NU suchthat defined(x_O_4[ri_187], r_4[ri_187]) && {885}(x_O_10 = x_O_4[ri_187]) then r_4[u_187] orfind u_186 = ri_186 <= NU suchthat defined(x_O_5[ri_186], r_5[ri_186]) && {895}(x_O_10 = x_O_5[ri_186]) then r_5[u_186] orfind u_185 = ri_185 <= NU suchthat defined(x_O_6[ri_185], r_6[ri_185]) && {905}(x_O_10 = x_O_6[ri_185]) then r_6[u_185] orfind u_184 = ri_184 <= NU suchthat defined(x_O_7[ri_184], r_7[ri_184]) && {915}(x_O_10 = x_O_7[ri_184]) then r_7[u_184] orfind u_183 = ri_183 <= NU suchthat defined(x_O_8[ri_183], r_8[ri_183]) && {925}(x_O_10 = x_O_8[ri_183]) then r_8[u_183] orfind u_182 = ri_182 <= NU suchthat defined(x_O_9[ri_182], r_9[ri_182]) && (x_O_10 = x_O_9[ri_182]) then r_9[u_182] orfind u_181 = ri_181 <= NU suchthat defined(x_O_10[ri_181], r_10[ri_181]) && (x_O_10 = x_O_10[ri_181]) then r_10[u_181] orfind u_180 = ri_180 <= NU suchthat defined(x_O_11[ri_180], r_11[ri_180]) && {955}(x_O_10 = x_O_11[ri_180]) then r_11[u_180] orfind u_179 = ri_179 <= NU suchthat defined(x_O_12[ri_179], r_12[ri_179]) && {965}(x_O_10 = x_O_12[ri_179]) then r_12[u_179] orfind u_178 = ri_178 <= NS suchthat defined(x_O_13[ri_178], r_13[ri_178]) && {975}(x_O_10 = x_O_13[ri_178]) then r_13[u_178] orfind u_177 = ri_177 <= NS suchthat defined(x_O_14[ri_177], r_14[ri_177]) && (x_O_10 = x_O_14[ri_177]) then r_14[u_177] orfind u_176 = ri_176 <= qH0 suchthat defined(x_O_15[ri_176], r_15[ri_176]) && (x_O_10 = x_O_15[ri_176]) then r_15[u_176] orfind u_175 = ri_175 <= qH0 suchthat defined(x_O_16[ri_175], r_16[ri_175]) && {1005}(x_O_10 = x_O_16[ri_175]) then r_16[u_175] else r_10 <-R hash0; r_10);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_9: bitstring <- concat(U, S, X, Y[u_42], K_u); {1051}find [unique] u_174 = ri_174 <= NU suchthat defined(x_O_4[ri_174], r_4[ri_174]) && {1054}(x_O_9 = x_O_4[ri_174]) then r_4[u_174] orfind u_173 = ri_173 <= NU suchthat defined(x_O_5[ri_173], r_5[ri_173]) && {1064}(x_O_9 = x_O_5[ri_173]) then r_5[u_173] orfind u_172 = ri_172 <= NU suchthat defined(x_O_6[ri_172], r_6[ri_172]) && {1074}(x_O_9 = x_O_6[ri_172]) then r_6[u_172] orfind u_171 = ri_171 <= NU suchthat defined(x_O_7[ri_171], r_7[ri_171]) && {1084}(x_O_9 = x_O_7[ri_171]) then r_7[u_171] orfind u_170 = ri_170 <= NU suchthat defined(x_O_8[ri_170], r_8[ri_170]) && {1094}(x_O_9 = x_O_8[ri_170]) then r_8[u_170] orfind u_169 = ri_169 <= NU suchthat defined(x_O_9[ri_169], r_9[ri_169]) && (x_O_9 = x_O_9[ri_169]) then r_9[u_169] orfind u_168 = ri_168 <= NU suchthat defined(x_O_10[ri_168], r_10[ri_168]) && (x_O_9 = x_O_10[ri_168]) then r_10[u_168] orfind u_167 = ri_167 <= NU suchthat defined(x_O_11[ri_167], r_11[ri_167]) && {1124}(x_O_9 = x_O_11[ri_167]) then r_11[u_167] orfind u_166 = ri_166 <= NU suchthat defined(x_O_12[ri_166], r_12[ri_166]) && {1134}(x_O_9 = x_O_12[ri_166]) then r_12[u_166] orfind u_165 = ri_165 <= NS suchthat defined(x_O_13[ri_165], r_13[ri_165]) && {1144}(x_O_9 = x_O_13[ri_165]) then r_13[u_165] orfind u_164 = ri_164 <= NS suchthat defined(x_O_14[ri_164], r_14[ri_164]) && (x_O_9 = x_O_14[ri_164]) then r_14[u_164] orfind u_163 = ri_163 <= qH0 suchthat defined(x_O_15[ri_163], r_15[ri_163]) && (x_O_9 = x_O_15[ri_163]) then r_15[u_163] orfind u_162 = ri_162 <= qH0 suchthat defined(x_O_16[ri_162], r_16[ri_162]) && {1174}(x_O_9 = x_O_16[ri_162]) then r_16[u_162] else r_9 <-R hash0; r_9);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_12: bitstring <- concat(U, S, X, Yp[u_41], K_u); {1275}find [unique] u_213 = ri_213 <= NU suchthat defined(x_O_4[ri_213], r_4[ri_213]) && {1278}(x_O_12 = x_O_4[ri_213]) then r_4[u_213] orfind u_212 = ri_212 <= NU suchthat defined(x_O_5[ri_212], r_5[ri_212]) && {1288}(x_O_12 = x_O_5[ri_212]) then r_5[u_212] orfind u_211 = ri_211 <= NU suchthat defined(x_O_6[ri_211], r_6[ri_211]) && {1298}(x_O_12 = x_O_6[ri_211]) then r_6[u_211] orfind u_210 = ri_210 <= NU suchthat defined(x_O_7[ri_210], r_7[ri_210]) && {1308}(x_O_12 = x_O_7[ri_210]) then r_7[u_210] orfind u_209 = ri_209 <= NU suchthat defined(x_O_8[ri_209], r_8[ri_209]) && {1318}(x_O_12 = x_O_8[ri_209]) then r_8[u_209] orfind u_208 = ri_208 <= NU suchthat defined(x_O_9[ri_208], r_9[ri_208]) && {1328}(x_O_12 = x_O_9[ri_208]) then r_9[u_208] orfind u_207 = ri_207 <= NU suchthat defined(x_O_10[ri_207], r_10[ri_207]) && {1338}(x_O_12 = x_O_10[ri_207]) then r_10[u_207] orfind u_206 = ri_206 <= NU suchthat defined(x_O_11[ri_206], r_11[ri_206]) && (x_O_12 = x_O_11[ri_206]) then r_11[u_206] orfind u_205 = ri_205 <= NU suchthat defined(x_O_12[ri_205], r_12[ri_205]) && (x_O_12 = x_O_12[ri_205]) then r_12[u_205] orfind u_204 = ri_204 <= NS suchthat defined(x_O_13[ri_204], r_13[ri_204]) && {1368}(x_O_12 = x_O_13[ri_204]) then r_13[u_204] orfind u_203 = ri_203 <= NS suchthat defined(x_O_14[ri_203], r_14[ri_203]) && {1378}(x_O_12 = x_O_14[ri_203]) then r_14[u_203] orfind u_202 = ri_202 <= qH0 suchthat defined(x_O_15[ri_202], r_15[ri_202]) && (x_O_12 = x_O_15[ri_202]) then r_15[u_202] orfind u_201 = ri_201 <= qH0 suchthat defined(x_O_16[ri_201], r_16[ri_201]) && {1398}(x_O_12 = x_O_16[ri_201]) then r_16[u_201] else r_12 <-R hash0; r_12);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_11: bitstring <- concat(U, S, X, Yp[u_41], K_u); {1444}find [unique] u_200 = ri_200 <= NU suchthat defined(x_O_4[ri_200], r_4[ri_200]) && {1447}(x_O_11 = x_O_4[ri_200]) then r_4[u_200] orfind u_199 = ri_199 <= NU suchthat defined(x_O_5[ri_199], r_5[ri_199]) && {1457}(x_O_11 = x_O_5[ri_199]) then r_5[u_199] orfind u_198 = ri_198 <= NU suchthat defined(x_O_6[ri_198], r_6[ri_198]) && {1467}(x_O_11 = x_O_6[ri_198]) then r_6[u_198] orfind u_197 = ri_197 <= NU suchthat defined(x_O_7[ri_197], r_7[ri_197]) && {1477}(x_O_11 = x_O_7[ri_197]) then r_7[u_197] orfind u_196 = ri_196 <= NU suchthat defined(x_O_8[ri_196], r_8[ri_196]) && {1487}(x_O_11 = x_O_8[ri_196]) then r_8[u_196] orfind u_195 = ri_195 <= NU suchthat defined(x_O_9[ri_195], r_9[ri_195]) && {1497}(x_O_11 = x_O_9[ri_195]) then r_9[u_195] orfind u_194 = ri_194 <= NU suchthat defined(x_O_10[ri_194], r_10[ri_194]) && {1507}(x_O_11 = x_O_10[ri_194]) then r_10[u_194] orfind u_193 = ri_193 <= NU suchthat defined(x_O_11[ri_193], r_11[ri_193]) && (x_O_11 = x_O_11[ri_193]) then r_11[u_193] orfind u_192 = ri_192 <= NU suchthat defined(x_O_12[ri_192], r_12[ri_192]) && (x_O_11 = x_O_12[ri_192]) then r_12[u_192] orfind u_191 = ri_191 <= NS suchthat defined(x_O_13[ri_191], r_13[ri_191]) && {1537}(x_O_11 = x_O_13[ri_191]) then r_13[u_191] orfind u_190 = ri_190 <= NS suchthat defined(x_O_14[ri_190], r_14[ri_190]) && {1547}(x_O_11 = x_O_14[ri_190]) then r_14[u_190] orfind u_189 = ri_189 <= qH0 suchthat defined(x_O_15[ri_189], r_15[ri_189]) && (x_O_11 = x_O_15[ri_189]) then r_15[u_189] orfind u_188 = ri_188 <= qH0 suchthat defined(x_O_16[ri_188], r_16[ri_188]) && {1567}(x_O_11 = x_O_16[ri_188]) then r_16[u_188] else r_11 <-R hash0; r_11);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          sk_u: hash0 <- (x_O_4: bitstring <- concat(U, S, X, me_O_dec, K_u); {1635}find [unique] u_109 = ri_109 <= NU suchthat defined(x_O_4[ri_109], r_4[ri_109]) && (x_O_4 = x_O_4[ri_109]) then r_4[u_109] orfind u_108 = ri_108 <= NU suchthat defined(x_O_5[ri_108], r_5[ri_108]) && {1648}(x_O_4 = x_O_5[ri_108]) then r_5[u_108] orfind u_107 = ri_107 <= NU suchthat defined(x_O_6[ri_107], r_6[ri_107]) && {1658}(x_O_4 = x_O_6[ri_107]) then r_6[u_107] orfind u_106 = ri_106 <= NU suchthat defined(x_O_7[ri_106], r_7[ri_106]) && {1668}(x_O_4 = x_O_7[ri_106]) then r_7[u_106] orfind u_105 = ri_105 <= NU suchthat defined(x_O_8[ri_105], r_8[ri_105]) && {1678}(x_O_4 = x_O_8[ri_105]) then r_8[u_105] orfind u_104 = ri_104 <= NU suchthat defined(x_O_9[ri_104], r_9[ri_104]) && {1688}(x_O_4 = x_O_9[ri_104]) then r_9[u_104] orfind u_103 = ri_103 <= NU suchthat defined(x_O_10[ri_103], r_10[ri_103]) && {1698}(x_O_4 = x_O_10[ri_103]) then r_10[u_103] orfind u_102 = ri_102 <= NU suchthat defined(x_O_11[ri_102], r_11[ri_102]) && {1708}(x_O_4 = x_O_11[ri_102]) then r_11[u_102] orfind u_101 = ri_101 <= NU suchthat defined(x_O_12[ri_101], r_12[ri_101]) && {1718}(x_O_4 = x_O_12[ri_101]) then r_12[u_101] orfind u_100 = ri_100 <= NS suchthat defined(x_O_13[ri_100], r_13[ri_100]) && {1728}(x_O_4 = x_O_13[ri_100]) then r_13[u_100] orfind u_99 = ri_99 <= NS suchthat defined(x_O_14[ri_99], r_14[ri_99]) && {1738}(x_O_4 = x_O_14[ri_99]) then r_14[u_99] orfind u_98 = ri_98 <= qH0 suchthat defined(x_O_15[ri_98], r_15[ri_98]) && (x_O_4 = x_O_15[ri_98]) then r_15[u_98] orfind u_97 = ri_97 <= qH0 suchthat defined(x_O_16[ri_97], r_16[ri_97]) && {1758}(x_O_4 = x_O_16[ri_97]) then r_16[u_97] else r_4 <-R hash0; r_4);
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            sk_s: hash0 <- (x_O_13: bitstring <- concat(U, S, X_s, Y, K_s); {1856}find [unique] u_83 = ri_83 <= NU suchthat defined(x_O_4[ri_83], r_4[ri_83]) && {1859}(x_O_13 = x_O_4[ri_83]) then r_4[u_83] orfind u_82 = ri_82 <= NU suchthat defined(x_O_5[ri_82], r_5[ri_82]) && {1869}(x_O_13 = x_O_5[ri_82]) then r_5[u_82] orfind u_81 = ri_81 <= NU suchthat defined(x_O_6[ri_81], r_6[ri_81]) && {1879}(x_O_13 = x_O_6[ri_81]) then r_6[u_81] orfind u_80 = ri_80 <= NU suchthat defined(x_O_7[ri_80], r_7[ri_80]) && {1889}(x_O_13 = x_O_7[ri_80]) then r_7[u_80] orfind u_79 = ri_79 <= NU suchthat defined(x_O_8[ri_79], r_8[ri_79]) && {1899}(x_O_13 = x_O_8[ri_79]) then r_8[u_79] orfind u_78 = ri_78 <= NU suchthat defined(x_O_9[ri_78], r_9[ri_78]) && (x_O_13 = x_O_9[ri_78]) then r_9[u_78] orfind u_77 = ri_77 <= NU suchthat defined(x_O_10[ri_77], r_10[ri_77]) && (x_O_13 = x_O_10[ri_77]) then r_10[u_77] orfind u_76 = ri_76 <= NU suchthat defined(x_O_11[ri_76], r_11[ri_76]) && {1929}(x_O_13 = x_O_11[ri_76]) then r_11[u_76] orfind u_75 = ri_75 <= NU suchthat defined(x_O_12[ri_75], r_12[ri_75]) && {1939}(x_O_13 = x_O_12[ri_75]) then r_12[u_75] orfind u_74 = ri_74 <= NS suchthat defined(x_O_13[ri_74], r_13[ri_74]) && {1949}(x_O_13 = x_O_13[ri_74]) then r_13[u_74] orfind u_73 = ri_73 <= NS suchthat defined(x_O_14[ri_73], r_14[ri_73]) && {1959}(x_O_13 = x_O_14[ri_73]) then r_14[u_73] orfind u_72 = ri_72 <= qH0 suchthat defined(x_O_15[ri_72], r_15[ri_72]) && (x_O_13 = x_O_15[ri_72]) then r_15[u_72] orfind u_71 = ri_71 <= qH0 suchthat defined(x_O_16[ri_71], r_16[ri_71]) && {1979}(x_O_13 = x_O_16[ri_71]) then r_16[u_71] else r_13 <-R hash0; r_13);
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- (x_O_14: bitstring <- concat(U, S, X_s, Y, K_s); {2058}find [unique] u_96 = ri_96 <= NU suchthat defined(x_O_4[ri_96], r_4[ri_96]) && {2061}(x_O_14 = x_O_4[ri_96]) then r_4[u_96] orfind u_95 = ri_95 <= NU suchthat defined(x_O_5[ri_95], r_5[ri_95]) && {2071}(x_O_14 = x_O_5[ri_95]) then r_5[u_95] orfind u_94 = ri_94 <= NU suchthat defined(x_O_6[ri_94], r_6[ri_94]) && {2081}(x_O_14 = x_O_6[ri_94]) then r_6[u_94] orfind u_93 = ri_93 <= NU suchthat defined(x_O_7[ri_93], r_7[ri_93]) && {2091}(x_O_14 = x_O_7[ri_93]) then r_7[u_93] orfind u_92 = ri_92 <= NU suchthat defined(x_O_8[ri_92], r_8[ri_92]) && {2101}(x_O_14 = x_O_8[ri_92]) then r_8[u_92] orfind u_91 = ri_91 <= NU suchthat defined(x_O_9[ri_91], r_9[ri_91]) && (x_O_14 = x_O_9[ri_91]) then r_9[u_91] orfind u_90 = ri_90 <= NU suchthat defined(x_O_10[ri_90], r_10[ri_90]) && (x_O_14 = x_O_10[ri_90]) then r_10[u_90] orfind u_89 = ri_89 <= NU suchthat defined(x_O_11[ri_89], r_11[ri_89]) && {2131}(x_O_14 = x_O_11[ri_89]) then r_11[u_89] orfind u_88 = ri_88 <= NU suchthat defined(x_O_12[ri_88], r_12[ri_88]) && {2141}(x_O_14 = x_O_12[ri_88]) then r_12[u_88] orfind u_87 = ri_87 <= NS suchthat defined(x_O_13[ri_87], r_13[ri_87]) && {2151}(x_O_14 = x_O_13[ri_87]) then r_13[u_87] orfind u_86 = ri_86 <= NS suchthat defined(x_O_14[ri_86], r_14[ri_86]) && (x_O_14 = x_O_14[ri_86]) then r_14[u_86] orfind u_85 = ri_85 <= qH0 suchthat defined(x_O_15[ri_85], r_15[ri_85]) && (x_O_14 = x_O_15[ri_85]) then r_15[u_85] orfind u_84 = ri_84 <= qH0 suchthat defined(x_O_16[ri_84], r_16[ri_84]) && {2181}(x_O_14 = x_O_16[ri_84]) then r_16[u_84] else r_14 <-R hash0; r_14);
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          return((x_O_15: bitstring <- x1; {2506}find [unique] u_70 = ri_70 <= NU suchthat defined(x_O_4[ri_70], r_4[ri_70]) && (x_O_15 = x_O_4[ri_70]) then r_4[u_70] orfind u_69 = ri_69 <= NU suchthat defined(x_O_5[ri_69], r_5[ri_69]) && (x_O_15 = x_O_5[ri_69]) then r_5[u_69] orfind u_68 = ri_68 <= NU suchthat defined(x_O_6[ri_68], r_6[ri_68]) && (x_O_15 = x_O_6[ri_68]) then r_6[u_68] orfind u_67 = ri_67 <= NU suchthat defined(x_O_7[ri_67], r_7[ri_67]) && (x_O_15 = x_O_7[ri_67]) then r_7[u_67] orfind u_66 = ri_66 <= NU suchthat defined(x_O_8[ri_66], r_8[ri_66]) && (x_O_15 = x_O_8[ri_66]) then r_8[u_66] orfind u_65 = ri_65 <= NU suchthat defined(x_O_9[ri_65], r_9[ri_65]) && (x_O_15 = x_O_9[ri_65]) then r_9[u_65] orfind u_64 = ri_64 <= NU suchthat defined(x_O_10[ri_64], r_10[ri_64]) && (x_O_15 = x_O_10[ri_64]) then r_10[u_64] orfind u_63 = ri_63 <= NU suchthat defined(x_O_11[ri_63], r_11[ri_63]) && (x_O_15 = x_O_11[ri_63]) then r_11[u_63] orfind u_62 = ri_62 <= NU suchthat defined(x_O_12[ri_62], r_12[ri_62]) && (x_O_15 = x_O_12[ri_62]) then r_12[u_62] orfind u_61 = ri_61 <= NS suchthat defined(x_O_13[ri_61], r_13[ri_61]) && (x_O_15 = x_O_13[ri_61]) then r_13[u_61] orfind u_60 = ri_60 <= NS suchthat defined(x_O_14[ri_60], r_14[ri_60]) && (x_O_15 = x_O_14[ri_60]) then r_14[u_60] orfind u_59 = ri_59 <= qH0 suchthat defined(x_O_15[ri_59], r_15[ri_59]) && (x_O_15 = x_O_15[ri_59]) then r_15[u_59] orfind u_58 = ri_58 <= qH0 suchthat defined(x_O_16[ri_58], r_16[ri_58]) && {2629}(x_O_15 = x_O_16[ri_58]) then r_16[u_58] else r_15 <-R hash0; r_15))
        else
          return((x_O_16: bitstring <- x1; {2646}find [unique] u_57 = ri_57 <= NU suchthat defined(x_O_4[ri_57], r_4[ri_57]) && {2649}(x_O_16 = x_O_4[ri_57]) then r_4[u_57] orfind u_56 = ri_56 <= NU suchthat defined(x_O_5[ri_56], r_5[ri_56]) && {2659}(x_O_16 = x_O_5[ri_56]) then r_5[u_56] orfind u_55 = ri_55 <= NU suchthat defined(x_O_6[ri_55], r_6[ri_55]) && {2669}(x_O_16 = x_O_6[ri_55]) then r_6[u_55] orfind u_54 = ri_54 <= NU suchthat defined(x_O_7[ri_54], r_7[ri_54]) && {2679}(x_O_16 = x_O_7[ri_54]) then r_7[u_54] orfind u_53 = ri_53 <= NU suchthat defined(x_O_8[ri_53], r_8[ri_53]) && {2689}(x_O_16 = x_O_8[ri_53]) then r_8[u_53] orfind u_52 = ri_52 <= NU suchthat defined(x_O_9[ri_52], r_9[ri_52]) && {2699}(x_O_16 = x_O_9[ri_52]) then r_9[u_52] orfind u_51 = ri_51 <= NU suchthat defined(x_O_10[ri_51], r_10[ri_51]) && {2709}(x_O_16 = x_O_10[ri_51]) then r_10[u_51] orfind u_50 = ri_50 <= NU suchthat defined(x_O_11[ri_50], r_11[ri_50]) && {2719}(x_O_16 = x_O_11[ri_50]) then r_11[u_50] orfind u_49 = ri_49 <= NU suchthat defined(x_O_12[ri_49], r_12[ri_49]) && {2729}(x_O_16 = x_O_12[ri_49]) then r_12[u_49] orfind u_48 = ri_48 <= NS suchthat defined(x_O_13[ri_48], r_13[ri_48]) && {2739}(x_O_16 = x_O_13[ri_48]) then r_13[u_48] orfind u_47 = ri_47 <= NS suchthat defined(x_O_14[ri_47], r_14[ri_47]) && {2749}(x_O_16 = x_O_14[ri_47]) then r_14[u_47] orfind u_46 = ri_46 <= qH0 suchthat defined(x_O_15[ri_46], r_15[ri_46]) && {2759}(x_O_16 = x_O_15[ri_46]) then r_15[u_46] orfind u_45 = ri_45 <= qH0 suchthat defined(x_O_16[ri_45], r_16[ri_45]) && (x_O_16 = x_O_16[ri_45]) then r_16[u_45] else r_16 <-R hash0; r_16))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify (non-expanded game) [probability (NP * NS + 0.5 * NS * NS + 0.5 * NU * NU + NP * NP * NU * NU + 3 * NS * NU * NU * NP + 2 * NS * NS * NU * NU + NU * NU * qD * qD + NU * NU * qD * NP + NP * qD + NS * qD + NU * NU * qD * NS + NU * NU * NU * NU + 2 * NU * NU * NU * qD + NU * NU * NU * NP + NP * NU + NS * NU + NU * NU * NU * NS) / |Z| + qH1 * NU / |hash1| + (0.5 * qD * qD + 0.5 * NU * NU + NU * qD) / |G|]
  - Simplification pass
    - Replaced (x_O_6 = x_O_16[ri_123]) with false at 216
    - Remove branch 13 in find at 93
    - Replaced (x_O_6 = x_O_14[ri_125]) with false at 196
    - Remove branch 11 in find at 93
    - Replaced (x_O_6 = x_O_13[ri_126]) with false at 186
    - Remove branch 10 in find at 93
    - Replaced (x_O_6 = x_O_12[ri_127]) with false at 176
    - Remove branch 9 in find at 93
    - Replaced (x_O_6 = x_O_11[ri_128]) with false at 166
    - Remove branch 8 in find at 93
    - Replaced (x_O_6 = x_O_10[ri_129]) with false at 156
    - Remove branch 7 in find at 93
    - Replaced (x_O_6 = x_O_9[ri_130]) with false at 146
    - Remove branch 6 in find at 93
    - Replaced (x_O_6 = x_O_8[ri_131]) with false at 136
    - Remove branch 5 in find at 93
    - Replaced (x_O_6 = x_O_7[ri_132]) with false at 126
    - Remove branch 4 in find at 93
    - Replaced (x_O_5 = x_O_16[ri_110]) with false at 385
    - Remove branch 13 in find at 262
    - Replaced (x_O_5 = x_O_14[ri_112]) with false at 365
    - Remove branch 11 in find at 262
    - Replaced (x_O_5 = x_O_13[ri_113]) with false at 355
    - Remove branch 10 in find at 262
    - Replaced (x_O_5 = x_O_12[ri_114]) with false at 345
    - Remove branch 9 in find at 262
    - Replaced (x_O_5 = x_O_11[ri_115]) with false at 335
    - Remove branch 8 in find at 262
    - Replaced (x_O_5 = x_O_10[ri_116]) with false at 325
    - Remove branch 7 in find at 262
    - Replaced (x_O_5 = x_O_9[ri_117]) with false at 315
    - Remove branch 6 in find at 262
    - Replaced (x_O_5 = x_O_8[ri_118]) with false at 305
    - Remove branch 5 in find at 262
    - Replaced (x_O_5 = x_O_7[ri_119]) with false at 295
    - Remove branch 4 in find at 262
    - Replaced (x_O_8 = x_O_16[ri_149]) with false at 612
    - Remove branch 13 in find at 489
    - Replaced (x_O_8 = x_O_14[ri_151]) with false at 592
    - Remove branch 11 in find at 489
    - Replaced (x_O_8 = x_O_13[ri_152]) with false at 582
    - Remove branch 10 in find at 489
    - Replaced (x_O_8 = x_O_12[ri_153]) with false at 572
    - Remove branch 9 in find at 489
    - Replaced (x_O_8 = x_O_11[ri_154]) with false at 562
    - Remove branch 8 in find at 489
    - Replaced (x_O_8 = x_O_10[ri_155]) with false at 552
    - Remove branch 7 in find at 489
    - Replaced (x_O_8 = x_O_9[ri_156]) with false at 542
    - Remove branch 6 in find at 489
    - Replaced (x_O_8 = x_O_6[ri_159]) with false at 512
    - Remove branch 3 in find at 489
    - Replaced (x_O_8 = x_O_5[ri_160]) with false at 502
    - Remove branch 2 in find at 489
    - Replaced (x_O_8 = x_O_4[ri_161]) with false at 492
    - Remove branch 1 in find at 489
    - Replaced (x_O_7 = x_O_16[ri_136]) with false at 781
    - Remove branch 13 in find at 658
    - Replaced (x_O_7 = x_O_14[ri_138]) with false at 761
    - Remove branch 11 in find at 658
    - Replaced (x_O_7 = x_O_13[ri_139]) with false at 751
    - Remove branch 10 in find at 658
    - Replaced (x_O_7 = x_O_12[ri_140]) with false at 741
    - Remove branch 9 in find at 658
    - Replaced (x_O_7 = x_O_11[ri_141]) with false at 731
    - Remove branch 8 in find at 658
    - Replaced (x_O_7 = x_O_10[ri_142]) with false at 721
    - Remove branch 7 in find at 658
    - Replaced (x_O_7 = x_O_9[ri_143]) with false at 711
    - Remove branch 6 in find at 658
    - Replaced (x_O_7 = x_O_6[ri_146]) with false at 681
    - Remove branch 3 in find at 658
    - Replaced (x_O_7 = x_O_5[ri_147]) with false at 671
    - Remove branch 2 in find at 658
    - Replaced (x_O_7 = x_O_4[ri_148]) with false at 661
    - Remove branch 1 in find at 658
    - Replaced (x_O_10 = x_O_16[ri_175]) with false at 1005
    - Remove branch 13 in find at 882
    - Replaced (x_O_10 = x_O_13[ri_178]) with false at 975
    - Remove branch 10 in find at 882
    - Replaced (x_O_10 = x_O_12[ri_179]) with false at 965
    - Remove branch 9 in find at 882
    - Replaced (x_O_10 = x_O_11[ri_180]) with false at 955
    - Remove branch 8 in find at 882
    - Replaced (x_O_10 = x_O_8[ri_183]) with false at 925
    - Remove branch 5 in find at 882
    - Replaced (x_O_10 = x_O_7[ri_184]) with false at 915
    - Remove branch 4 in find at 882
    - Replaced (x_O_10 = x_O_6[ri_185]) with false at 905
    - Remove branch 3 in find at 882
    - Replaced (x_O_10 = x_O_5[ri_186]) with false at 895
    - Remove branch 2 in find at 882
    - Replaced (x_O_10 = x_O_4[ri_187]) with false at 885
    - Remove branch 1 in find at 882
    - Replaced (x_O_9 = x_O_16[ri_162]) with false at 1174
    - Remove branch 13 in find at 1051
    - Replaced (x_O_9 = x_O_13[ri_165]) with false at 1144
    - Remove branch 10 in find at 1051
    - Replaced (x_O_9 = x_O_12[ri_166]) with false at 1134
    - Remove branch 9 in find at 1051
    - Replaced (x_O_9 = x_O_11[ri_167]) with false at 1124
    - Remove branch 8 in find at 1051
    - Replaced (x_O_9 = x_O_8[ri_170]) with false at 1094
    - Remove branch 5 in find at 1051
    - Replaced (x_O_9 = x_O_7[ri_171]) with false at 1084
    - Remove branch 4 in find at 1051
    - Replaced (x_O_9 = x_O_6[ri_172]) with false at 1074
    - Remove branch 3 in find at 1051
    - Replaced (x_O_9 = x_O_5[ri_173]) with false at 1064
    - Remove branch 2 in find at 1051
    - Replaced (x_O_9 = x_O_4[ri_174]) with false at 1054
    - Remove branch 1 in find at 1051
    - Replaced (x_O_12 = x_O_16[ri_201]) with false at 1398
    - Remove branch 13 in find at 1275
    - Replaced (x_O_12 = x_O_14[ri_203]) with false at 1378
    - Remove branch 11 in find at 1275
    - Replaced (x_O_12 = x_O_13[ri_204]) with false at 1368
    - Remove branch 10 in find at 1275
    - Replaced (x_O_12 = x_O_10[ri_207]) with false at 1338
    - Remove branch 7 in find at 1275
    - Replaced (x_O_12 = x_O_9[ri_208]) with false at 1328
    - Remove branch 6 in find at 1275
    - Replaced (x_O_12 = x_O_8[ri_209]) with false at 1318
    - Remove branch 5 in find at 1275
    - Replaced (x_O_12 = x_O_7[ri_210]) with false at 1308
    - Remove branch 4 in find at 1275
    - Replaced (x_O_12 = x_O_6[ri_211]) with false at 1298
    - Remove branch 3 in find at 1275
    - Replaced (x_O_12 = x_O_5[ri_212]) with false at 1288
    - Remove branch 2 in find at 1275
    - Replaced (x_O_12 = x_O_4[ri_213]) with false at 1278
    - Remove branch 1 in find at 1275
    - Replaced (x_O_11 = x_O_16[ri_188]) with false at 1567
    - Remove branch 13 in find at 1444
    - Replaced (x_O_11 = x_O_14[ri_190]) with false at 1547
    - Remove branch 11 in find at 1444
    - Replaced (x_O_11 = x_O_13[ri_191]) with false at 1537
    - Remove branch 10 in find at 1444
    - Replaced (x_O_11 = x_O_10[ri_194]) with false at 1507
    - Remove branch 7 in find at 1444
    - Replaced (x_O_11 = x_O_9[ri_195]) with false at 1497
    - Remove branch 6 in find at 1444
    - Replaced (x_O_11 = x_O_8[ri_196]) with false at 1487
    - Remove branch 5 in find at 1444
    - Replaced (x_O_11 = x_O_7[ri_197]) with false at 1477
    - Remove branch 4 in find at 1444
    - Replaced (x_O_11 = x_O_6[ri_198]) with false at 1467
    - Remove branch 3 in find at 1444
    - Replaced (x_O_11 = x_O_5[ri_199]) with false at 1457
    - Remove branch 2 in find at 1444
    - Replaced (x_O_11 = x_O_4[ri_200]) with false at 1447
    - Remove branch 1 in find at 1444
    - Replaced (x_O_4 = x_O_16[ri_97]) with false at 1758
    - Remove branch 13 in find at 1635
    - Replaced (x_O_4 = x_O_14[ri_99]) with false at 1738
    - Remove branch 11 in find at 1635
    - Replaced (x_O_4 = x_O_13[ri_100]) with false at 1728
    - Remove branch 10 in find at 1635
    - Replaced (x_O_4 = x_O_12[ri_101]) with false at 1718
    - Remove branch 9 in find at 1635
    - Replaced (x_O_4 = x_O_11[ri_102]) with false at 1708
    - Remove branch 8 in find at 1635
    - Replaced (x_O_4 = x_O_10[ri_103]) with false at 1698
    - Remove branch 7 in find at 1635
    - Replaced (x_O_4 = x_O_9[ri_104]) with false at 1688
    - Remove branch 6 in find at 1635
    - Replaced (x_O_4 = x_O_8[ri_105]) with false at 1678
    - Remove branch 5 in find at 1635
    - Replaced (x_O_4 = x_O_7[ri_106]) with false at 1668
    - Remove branch 4 in find at 1635
    - Replaced (x_O_4 = x_O_6[ri_107]) with false at 1658
    - Remove branch 3 in find at 1635
    - Replaced (x_O_4 = x_O_5[ri_108]) with false at 1648
    - Remove branch 2 in find at 1635
    - Replaced (x_O_13 = x_O_16[ri_71]) with false at 1979
    - Remove branch 13 in find at 1856
    - Replaced (x_O_13 = x_O_14[ri_73]) with false at 1959
    - Remove branch 11 in find at 1856
    - Replaced (x_O_13 = x_O_13[ri_74]) with false at 1949
    - Remove branch 10 in find at 1856
    - Replaced (x_O_13 = x_O_12[ri_75]) with false at 1939
    - Remove branch 9 in find at 1856
    - Replaced (x_O_13 = x_O_11[ri_76]) with false at 1929
    - Remove branch 8 in find at 1856
    - Replaced (x_O_13 = x_O_8[ri_79]) with false at 1899
    - Remove branch 5 in find at 1856
    - Replaced (x_O_13 = x_O_7[ri_80]) with false at 1889
    - Remove branch 4 in find at 1856
    - Replaced (x_O_13 = x_O_6[ri_81]) with false at 1879
    - Remove branch 3 in find at 1856
    - Replaced (x_O_13 = x_O_5[ri_82]) with false at 1869
    - Remove branch 2 in find at 1856
    - Replaced (x_O_13 = x_O_4[ri_83]) with false at 1859
    - Remove branch 1 in find at 1856
    - Replaced (x_O_14 = x_O_16[ri_84]) with false at 2181
    - Remove branch 13 in find at 2058
    - Replaced (x_O_14 = x_O_13[ri_87]) with false at 2151
    - Remove branch 10 in find at 2058
    - Replaced (x_O_14 = x_O_12[ri_88]) with false at 2141
    - Remove branch 9 in find at 2058
    - Replaced (x_O_14 = x_O_11[ri_89]) with false at 2131
    - Remove branch 8 in find at 2058
    - Replaced (x_O_14 = x_O_8[ri_92]) with false at 2101
    - Remove branch 5 in find at 2058
    - Replaced (x_O_14 = x_O_7[ri_93]) with false at 2091
    - Remove branch 4 in find at 2058
    - Replaced (x_O_14 = x_O_6[ri_94]) with false at 2081
    - Remove branch 3 in find at 2058
    - Replaced (x_O_14 = x_O_5[ri_95]) with false at 2071
    - Remove branch 2 in find at 2058
    - Replaced (x_O_14 = x_O_4[ri_96]) with false at 2061
    - Remove branch 1 in find at 2058
    - Replaced (x_O_15 = x_O_16[ri_58]) with false at 2629
    - Remove branch 13 in find at 2506
    - Replaced (x_O_16 = x_O_15[ri_46]) with false at 2759
    - Remove branch 12 in find at 2646
    - Replaced (x_O_16 = x_O_14[ri_47]) with false at 2749
    - Remove branch 11 in find at 2646
    - Replaced (x_O_16 = x_O_13[ri_48]) with false at 2739
    - Remove branch 10 in find at 2646
    - Replaced (x_O_16 = x_O_12[ri_49]) with false at 2729
    - Remove branch 9 in find at 2646
    - Replaced (x_O_16 = x_O_11[ri_50]) with false at 2719
    - Remove branch 8 in find at 2646
    - Replaced (x_O_16 = x_O_10[ri_51]) with false at 2709
    - Remove branch 7 in find at 2646
    - Replaced (x_O_16 = x_O_9[ri_52]) with false at 2699
    - Remove branch 6 in find at 2646
    - Replaced (x_O_16 = x_O_8[ri_53]) with false at 2689
    - Remove branch 5 in find at 2646
    - Replaced (x_O_16 = x_O_7[ri_54]) with false at 2679
    - Remove branch 4 in find at 2646
    - Replaced (x_O_16 = x_O_6[ri_55]) with false at 2669
    - Remove branch 3 in find at 2646
    - Replaced (x_O_16 = x_O_5[ri_56]) with false at 2659
    - Remove branch 2 in find at 2646
    - Replaced (x_O_16 = x_O_4[ri_57]) with false at 2649
    - Remove branch 1 in find at 2646
yields

Game 23 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_6: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u); {93}find [unique] u_135 = ri_135 <= NU suchthat defined(x_O_4[ri_135], r_4[ri_135]) && (x_O_6 = x_O_4[ri_135]) then r_4[u_135] orfind u_134 = ri_134 <= NU suchthat defined(x_O_5[ri_134], r_5[ri_134]) && (x_O_6 = x_O_5[ri_134]) then r_5[u_134] orfind u_133 = ri_133 <= NU suchthat defined(x_O_6[ri_133], r_6[ri_133]) && (x_O_6 = x_O_6[ri_133]) then r_6[u_133] orfind u_124 = ri_124 <= qH0 suchthat defined(x_O_15[ri_124], r_15[ri_124]) && (x_O_6 = x_O_15[ri_124]) then r_15[u_124] else r_6 <-R hash0; r_6);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_5: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u); {172}find [unique] u_122 = ri_122 <= NU suchthat defined(x_O_4[ri_122], r_4[ri_122]) && (x_O_5 = x_O_4[ri_122]) then r_4[u_122] orfind u_121 = ri_121 <= NU suchthat defined(x_O_5[ri_121], r_5[ri_121]) && (x_O_5 = x_O_5[ri_121]) then r_5[u_121] orfind u_120 = ri_120 <= NU suchthat defined(x_O_6[ri_120], r_6[ri_120]) && (x_O_5 = x_O_6[ri_120]) then r_6[u_120] orfind u_111 = ri_111 <= qH0 suchthat defined(x_O_15[ri_111], r_15[ri_111]) && (x_O_5 = x_O_15[ri_111]) then r_15[u_111] else r_5 <-R hash0; r_5);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_8: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u); {309}find [unique] u_158 = ri_158 <= NU suchthat defined(x_O_7[ri_158], r_7[ri_158]) && (x_O_8 = x_O_7[ri_158]) then r_7[u_158] orfind u_157 = ri_157 <= NU suchthat defined(x_O_8[ri_157], r_8[ri_157]) && (x_O_8 = x_O_8[ri_157]) then r_8[u_157] orfind u_150 = ri_150 <= qH0 suchthat defined(x_O_15[ri_150], r_15[ri_150]) && (x_O_8 = x_O_15[ri_150]) then r_15[u_150] else r_8 <-R hash0; r_8);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_7: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u); {378}find [unique] u_145 = ri_145 <= NU suchthat defined(x_O_7[ri_145], r_7[ri_145]) && (x_O_7 = x_O_7[ri_145]) then r_7[u_145] orfind u_144 = ri_144 <= NU suchthat defined(x_O_8[ri_144], r_8[ri_144]) && (x_O_7 = x_O_8[ri_144]) then r_8[u_144] orfind u_137 = ri_137 <= qH0 suchthat defined(x_O_15[ri_137], r_15[ri_137]) && (x_O_7 = x_O_15[ri_137]) then r_15[u_137] else r_7 <-R hash0; r_7);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_10: bitstring <- concat(U, S, X, Y[u_42], K_u); {502}find [unique] u_182 = ri_182 <= NU suchthat defined(x_O_9[ri_182], r_9[ri_182]) && (x_O_10 = x_O_9[ri_182]) then r_9[u_182] orfind u_181 = ri_181 <= NU suchthat defined(x_O_10[ri_181], r_10[ri_181]) && (x_O_10 = x_O_10[ri_181]) then r_10[u_181] orfind u_177 = ri_177 <= NS suchthat defined(x_O_14[ri_177], r_14[ri_177]) && (x_O_10 = x_O_14[ri_177]) then r_14[u_177] orfind u_176 = ri_176 <= qH0 suchthat defined(x_O_15[ri_176], r_15[ri_176]) && (x_O_10 = x_O_15[ri_176]) then r_15[u_176] else r_10 <-R hash0; r_10);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_9: bitstring <- concat(U, S, X, Y[u_42], K_u); {581}find [unique] u_169 = ri_169 <= NU suchthat defined(x_O_9[ri_169], r_9[ri_169]) && (x_O_9 = x_O_9[ri_169]) then r_9[u_169] orfind u_168 = ri_168 <= NU suchthat defined(x_O_10[ri_168], r_10[ri_168]) && (x_O_9 = x_O_10[ri_168]) then r_10[u_168] orfind u_164 = ri_164 <= NS suchthat defined(x_O_14[ri_164], r_14[ri_164]) && (x_O_9 = x_O_14[ri_164]) then r_14[u_164] orfind u_163 = ri_163 <= qH0 suchthat defined(x_O_15[ri_163], r_15[ri_163]) && (x_O_9 = x_O_15[ri_163]) then r_15[u_163] else r_9 <-R hash0; r_9);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            sk_u: hash0 <- (x_O_12: bitstring <- concat(U, S, X, Yp[u_41], K_u); {715}find [unique] u_206 = ri_206 <= NU suchthat defined(x_O_11[ri_206], r_11[ri_206]) && (x_O_12 = x_O_11[ri_206]) then r_11[u_206] orfind u_205 = ri_205 <= NU suchthat defined(x_O_12[ri_205], r_12[ri_205]) && (x_O_12 = x_O_12[ri_205]) then r_12[u_205] orfind u_202 = ri_202 <= qH0 suchthat defined(x_O_15[ri_202], r_15[ri_202]) && (x_O_12 = x_O_15[ri_202]) then r_15[u_202] else r_12 <-R hash0; r_12);
            event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
            return(r_2[u_17])
          else
            r <-R hash1;
            sk_u: hash0 <- (x_O_11: bitstring <- concat(U, S, X, Yp[u_41], K_u); {784}find [unique] u_193 = ri_193 <= NU suchthat defined(x_O_11[ri_193], r_11[ri_193]) && (x_O_11 = x_O_11[ri_193]) then r_11[u_193] orfind u_192 = ri_192 <= NU suchthat defined(x_O_12[ri_192], r_12[ri_192]) && (x_O_11 = x_O_12[ri_192]) then r_12[u_192] orfind u_189 = ri_189 <= qH0 suchthat defined(x_O_15[ri_189], r_15[ri_189]) && (x_O_11 = x_O_15[ri_189]) then r_15[u_189] else r_11 <-R hash0; r_11);
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          sk_u: hash0 <- (x_O_4: bitstring <- concat(U, S, X, me_O_dec, K_u); {875}find [unique] u_109 = ri_109 <= NU suchthat defined(x_O_4[ri_109], r_4[ri_109]) && (x_O_4 = x_O_4[ri_109]) then r_4[u_109] orfind u_98 = ri_98 <= qH0 suchthat defined(x_O_15[ri_98], r_15[ri_98]) && (x_O_4 = x_O_15[ri_98]) then r_15[u_98] else r_4 <-R hash0; r_4);
          event acceptU(U, X, S, Ystar_u, r, sk_u);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            sk_s: hash0 <- (x_O_13: bitstring <- concat(U, S, X_s, Y, K_s); {986}find [unique] u_78 = ri_78 <= NU suchthat defined(x_O_9[ri_78], r_9[ri_78]) && (x_O_13 = x_O_9[ri_78]) then r_9[u_78] orfind u_77 = ri_77 <= NU suchthat defined(x_O_10[ri_77], r_10[ri_77]) && (x_O_13 = x_O_10[ri_77]) then r_10[u_77] orfind u_72 = ri_72 <= qH0 suchthat defined(x_O_15[ri_72], r_15[ri_72]) && (x_O_13 = x_O_15[ri_72]) then r_15[u_72] else r_13 <-R hash0; r_13);
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            sk_s: hash0 <- (x_O_14: bitstring <- concat(U, S, X_s, Y, K_s); {1088}find [unique] u_91 = ri_91 <= NU suchthat defined(x_O_9[ri_91], r_9[ri_91]) && (x_O_14 = x_O_9[ri_91]) then r_9[u_91] orfind u_90 = ri_90 <= NU suchthat defined(x_O_10[ri_90], r_10[ri_90]) && (x_O_14 = x_O_10[ri_90]) then r_10[u_90] orfind u_86 = ri_86 <= NS suchthat defined(x_O_14[ri_86], r_14[ri_86]) && (x_O_14 = x_O_14[ri_86]) then r_14[u_86] orfind u_85 = ri_85 <= qH0 suchthat defined(x_O_15[ri_85], r_15[ri_85]) && (x_O_14 = x_O_15[ri_85]) then r_15[u_85] else r_14 <-R hash0; r_14);
            event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          return((x_O_15: bitstring <- x1; find [unique] u_70 = ri_70 <= NU suchthat defined(x_O_4[ri_70], r_4[ri_70]) && (x_O_15 = x_O_4[ri_70]) then r_4[u_70] orfind u_69 = ri_69 <= NU suchthat defined(x_O_5[ri_69], r_5[ri_69]) && (x_O_15 = x_O_5[ri_69]) then r_5[u_69] orfind u_68 = ri_68 <= NU suchthat defined(x_O_6[ri_68], r_6[ri_68]) && (x_O_15 = x_O_6[ri_68]) then r_6[u_68] orfind u_67 = ri_67 <= NU suchthat defined(x_O_7[ri_67], r_7[ri_67]) && (x_O_15 = x_O_7[ri_67]) then r_7[u_67] orfind u_66 = ri_66 <= NU suchthat defined(x_O_8[ri_66], r_8[ri_66]) && (x_O_15 = x_O_8[ri_66]) then r_8[u_66] orfind u_65 = ri_65 <= NU suchthat defined(x_O_9[ri_65], r_9[ri_65]) && (x_O_15 = x_O_9[ri_65]) then r_9[u_65] orfind u_64 = ri_64 <= NU suchthat defined(x_O_10[ri_64], r_10[ri_64]) && (x_O_15 = x_O_10[ri_64]) then r_10[u_64] orfind u_63 = ri_63 <= NU suchthat defined(x_O_11[ri_63], r_11[ri_63]) && (x_O_15 = x_O_11[ri_63]) then r_11[u_63] orfind u_62 = ri_62 <= NU suchthat defined(x_O_12[ri_62], r_12[ri_62]) && (x_O_15 = x_O_12[ri_62]) then r_12[u_62] orfind u_61 = ri_61 <= NS suchthat defined(x_O_13[ri_61], r_13[ri_61]) && (x_O_15 = x_O_13[ri_61]) then r_13[u_61] orfind u_60 = ri_60 <= NS suchthat defined(x_O_14[ri_60], r_14[ri_60]) && (x_O_15 = x_O_14[ri_60]) then r_14[u_60] orfind u_59 = ri_59 <= qH0 suchthat defined(x_O_15[ri_59], r_15[ri_59]) && (x_O_15 = x_O_15[ri_59]) then r_15[u_59] else r_15 <-R hash0; r_15))
        else
          return((x_O_16: bitstring <- x1; find [unique] u_45 = ri_45 <= qH0 suchthat defined(x_O_16[ri_45], r_16[ri_45]) && (x_O_16 = x_O_16[ri_45]) then r_16[u_45] else r_16 <-R hash0; r_16))
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand [probability (0.5 * NU * NU + 0.5 * NS * NS + NU * NU * NU * NU + NU * NU * qD * qD + 2 * NP * qH1 + NP * NP * NU + NP * NP * NU * NU + 2 * NU * NU * NS * NS + 2 * NU * NP) / |Z| + (qH1 * NU + 2.5 * NU * NU) / |G|]
  - Expand if/find/let
    - Remove branch 3 in find at 1088
    - Remove branch 1 in find at 1088
    - Remove branch 2 in find at 986
    - Remove branch 1 in find at 875
    - Remove branch 2 in find at 784
    - Remove branch 1 in find at 784
    - Remove branch 2 in find at 715
    - Remove branch 1 in find at 715
    - Remove branch 3 in find at 581
    - Remove branch 2 in find at 581
    - Remove branch 1 in find at 581
    - Remove branch 2 in find at 502
    - Remove branch 1 in find at 502
    - Remove branch 2 in find at 378
    - Remove branch 1 in find at 378
    - Remove branch 2 in find at 309
    - Remove branch 1 in find at 309
    - Remove branch 3 in find at 172
    - Remove branch 2 in find at 172
    - Remove branch 1 in find at 172
    - Remove branch 3 in find at 93
    - Remove branch 2 in find at 93
    - Remove branch 1 in find at 93
yields

Game 24 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_6: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(x_O_15[ri_124], r_15[ri_124]) && (x_O_6 = x_O_15[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_5: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(x_O_15[ri_111], r_15[ri_111]) && (x_O_5 = x_O_15[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_8: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(x_O_15[ri_150], r_15[ri_150]) && (x_O_8 = x_O_15[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_7: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(x_O_15[ri_137], r_15[ri_137]) && (x_O_7 = x_O_15[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_10: bitstring <- concat(U, S, X, Y[u_42], K_u);
            find [unique] u_177 = ri_177 <= NS suchthat defined(x_O_14[ri_177], r_14[ri_177]) && (x_O_10 = x_O_14[ri_177]) then
              sk_u: hash0 <- r_14[u_177];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(x_O_15[ri_176], r_15[ri_176]) && (x_O_10 = x_O_15[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_9: bitstring <- concat(U, S, X, Y[u_42], K_u);
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(x_O_15[ri_163], r_15[ri_163]) && (x_O_9 = x_O_15[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_12: bitstring <- concat(U, S, X, Yp[u_41], K_u);
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(x_O_15[ri_202], r_15[ri_202]) && (x_O_12 = x_O_15[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], sk_u);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_11: bitstring <- concat(U, S, X, Yp[u_41], K_u);
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(x_O_15[ri_189], r_15[ri_189]) && (x_O_11 = x_O_15[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              event acceptU(U, X, S, Ystar_u, r, sk_u);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          x_O_4: bitstring <- concat(U, S, X, me_O_dec, K_u);
          find [unique] u_98 = ri_98 <= qH0 suchthat defined(x_O_15[ri_98], r_15[ri_98]) && (x_O_4 = x_O_15[ri_98]) then
            sk_u: hash0 <- r_15[u_98];
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
          else
            r_4 <-R hash0;
            sk_u: hash0 <- r_4;
            event acceptU(U, X, S, Ystar_u, r, sk_u);
            return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            x_O_13: bitstring <- concat(U, S, X_s, Y, K_s);
            find [unique] u_78 = ri_78 <= NU suchthat defined(x_O_9[ri_78], r_9[ri_78]) && (x_O_13 = x_O_9[ri_78]) then
              sk_s: hash0 <- r_9[u_78];
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
            orfind u_72 = ri_72 <= qH0 suchthat defined(x_O_15[ri_72], r_15[ri_72]) && (x_O_13 = x_O_15[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            x_O_14: bitstring <- concat(U, S, X_s, Y, K_s);
            find [unique] u_90 = ri_90 <= NU suchthat defined(x_O_10[ri_90], r_10[ri_90]) && (x_O_14 = x_O_10[ri_90]) then
              sk_s: hash0 <- r_10[u_90];
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
            orfind u_85 = ri_85 <= qH0 suchthat defined(x_O_15[ri_85], r_15[ri_85]) && (x_O_14 = x_O_15[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, sk_s)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          x_O_15: bitstring <- x1;
          find [unique] u_70 = ri_70 <= NU suchthat defined(x_O_4[ri_70], r_4[ri_70]) && (x_O_15 = x_O_4[ri_70]) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x_O_5[ri_69], r_5[ri_69]) && (x_O_15 = x_O_5[ri_69]) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x_O_6[ri_68], r_6[ri_68]) && (x_O_15 = x_O_6[ri_68]) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(x_O_7[ri_67], r_7[ri_67]) && (x_O_15 = x_O_7[ri_67]) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(x_O_8[ri_66], r_8[ri_66]) && (x_O_15 = x_O_8[ri_66]) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(x_O_9[ri_65], r_9[ri_65]) && (x_O_15 = x_O_9[ri_65]) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(x_O_10[ri_64], r_10[ri_64]) && (x_O_15 = x_O_10[ri_64]) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(x_O_11[ri_63], r_11[ri_63]) && (x_O_15 = x_O_11[ri_63]) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(x_O_12[ri_62], r_12[ri_62]) && (x_O_15 = x_O_12[ri_62]) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(x_O_13[ri_61], r_13[ri_61]) && (x_O_15 = x_O_13[ri_61]) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(x_O_14[ri_60], r_14[ri_60]) && (x_O_15 = x_O_14[ri_60]) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(x_O_15[ri_59], r_15[ri_59]) && (x_O_15 = x_O_15[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          x_O_16: bitstring <- x1;
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(x_O_16[ri_45], r_16[ri_45]) && (x_O_16 = x_O_16[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on x_O_16 (definition point kept, all usages removed)
  - Remove assignments on x_O_15 (definition point kept, all usages removed)
  - Remove assignments on sk_s (definition kept, all usages removed)
  - Remove assignments on sk_s (definition kept, all usages removed)
  - Remove assignments on sk_s (definition kept, all usages removed)
  - Remove assignments on sk_s (definition kept, all usages removed)
  - Remove assignments on sk_s (definition kept, all usages removed)
  - Remove assignments on sk_s (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
  - Remove assignments on sk_u (definition kept, all usages removed)
yields

Game 25 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_6: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
  {92}      find [unique] u_124 = ri_124 <= qH0 suchthat defined(x1[ri_124], x_O_15[ri_124], r_15[ri_124]) && {96}(x_O_6 = x1[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_5: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
 {167}      find [unique] u_111 = ri_111 <= qH0 suchthat defined(x1[ri_111], x_O_15[ri_111], r_15[ri_111]) && {171}(x_O_5 = x1[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_8: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
 {298}      find [unique] u_150 = ri_150 <= qH0 suchthat defined(x1[ri_150], x_O_15[ri_150], r_15[ri_150]) && {302}(x_O_8 = x1[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_7: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
 {373}      find [unique] u_137 = ri_137 <= qH0 suchthat defined(x1[ri_137], x_O_15[ri_137], r_15[ri_137]) && {377}(x_O_7 = x1[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_10: bitstring <- concat(U, S, X, Y[u_42], K_u);
 {501}      find [unique] u_177 = ri_177 <= NS suchthat defined(x_O_14[ri_177], r_14[ri_177]) && {504}(x_O_10 = x_O_14[ri_177]) then
              sk_u: hash0 <- r_14[u_177];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_177]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(x1[ri_176], x_O_15[ri_176], r_15[ri_176]) && {539}(x_O_10 = x1[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_9: bitstring <- concat(U, S, X, Y[u_42], K_u);
 {610}      find [unique] u_163 = ri_163 <= qH0 suchthat defined(x1[ri_163], x_O_15[ri_163], r_15[ri_163]) && {614}(x_O_9 = x1[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_12: bitstring <- concat(U, S, X, Yp[u_41], K_u);
 {738}      find [unique] u_202 = ri_202 <= qH0 suchthat defined(x1[ri_202], x_O_15[ri_202], r_15[ri_202]) && {742}(x_O_12 = x1[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_11: bitstring <- concat(U, S, X, Yp[u_41], K_u);
 {813}      find [unique] u_189 = ri_189 <= qH0 suchthat defined(x1[ri_189], x_O_15[ri_189], r_15[ri_189]) && {817}(x_O_11 = x1[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          x_O_4: bitstring <- concat(U, S, X, me_O_dec, K_u);
 {908}    find [unique] u_98 = ri_98 <= qH0 suchthat defined(x1[ri_98], x_O_15[ri_98], r_15[ri_98]) && {912}(x_O_4 = x1[ri_98]) then
            sk_u: hash0 <- r_15[u_98];
            event acceptU(U, X, S, Ystar_u, r, r_15[u_98]);
            return(r)
          else
            r_4 <-R hash0;
            sk_u: hash0 <- r_4;
            event acceptU(U, X, S, Ystar_u, r, r_4);
            return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            x_O_13: bitstring <- concat(U, S, X_s, Y, K_s);
{1033}      find [unique] u_78 = ri_78 <= NU suchthat defined(x_O_9[ri_78], r_9[ri_78]) && {1036}(x_O_13 = x_O_9[ri_78]) then
              sk_s: hash0 <- r_9[u_78];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[u_78])
            orfind u_72 = ri_72 <= qH0 suchthat defined(x1[ri_72], x_O_15[ri_72], r_15[ri_72]) && {1065}(x_O_13 = x1[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            x_O_14: bitstring <- concat(U, S, X_s, Y, K_s);
{1163}      find [unique] u_90 = ri_90 <= NU suchthat defined(x_O_10[ri_90], r_10[ri_90]) && {1166}(x_O_14 = x_O_10[ri_90]) then
              sk_s: hash0 <- r_10[u_90];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[u_90])
            orfind u_85 = ri_85 <= qH0 suchthat defined(x1[ri_85], x_O_15[ri_85], r_15[ri_85]) && {1195}(x_O_14 = x1[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          x_O_15: bitstring <- cst_bitstring;
{1537}    find [unique] u_70 = ri_70 <= NU suchthat defined(x_O_4[ri_70], r_4[ri_70]) && {1540}(x1 = x_O_4[ri_70]) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x_O_5[ri_69], r_5[ri_69]) && {1553}(x1 = x_O_5[ri_69]) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x_O_6[ri_68], r_6[ri_68]) && {1566}(x1 = x_O_6[ri_68]) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(x_O_7[ri_67], r_7[ri_67]) && {1579}(x1 = x_O_7[ri_67]) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(x_O_8[ri_66], r_8[ri_66]) && {1592}(x1 = x_O_8[ri_66]) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(x_O_9[ri_65], r_9[ri_65]) && {1605}(x1 = x_O_9[ri_65]) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(x_O_10[ri_64], r_10[ri_64]) && {1618}(x1 = x_O_10[ri_64]) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(x_O_11[ri_63], r_11[ri_63]) && {1631}(x1 = x_O_11[ri_63]) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(x_O_12[ri_62], r_12[ri_62]) && {1644}(x1 = x_O_12[ri_62]) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(x_O_13[ri_61], r_13[ri_61]) && {1657}(x1 = x_O_13[ri_61]) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(x_O_14[ri_60], r_14[ri_60]) && {1670}(x1 = x_O_14[ri_60]) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(x1[ri_59], x_O_15[ri_59], r_15[ri_59]) && {1684}(x1 = x1[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          x_O_16: bitstring <- cst_bitstring;
{1704}    find [unique] u_45 = ri_45 <= qH0 suchthat defined(x1[ri_45], x_O_16[ri_45], r_16[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability (0.5 * NU * NU + 0.5 * NS * NS + 2 * NP * qH1 + 4 * NS * NS * NU * NU + NU * NP) / |Z| + (qH1 * NU + qH0 * NU + NU * NU) / |G|]
  - Simplification pass
    - Replaced defined condition x1[ri_45], x_O_16[ri_45], r_16[ri_45] with r_16[ri_45], x1[ri_45] in find at 1704
    - Replaced (x1 = x1[ri_59]) with ((x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59])) at 1684
    - Replaced defined condition x1[ri_59], x_O_15[ri_59], r_15[ri_59] with r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59] in find at 1537
    - Replaced (x1 = x_O_14[ri_60]) with ((x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U)) at 1670
    - Replaced defined condition x_O_14[ri_60], r_14[ri_60] with r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60] in find at 1537
    - Replaced (x1 = x_O_13[ri_61]) with ((x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U)) at 1657
    - Replaced defined condition x_O_13[ri_61], r_13[ri_61] with r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61] in find at 1537
    - Replaced (x1 = x_O_12[ri_62]) with ((x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U)) at 1644
    - Replaced defined condition x_O_12[ri_62], r_12[ri_62] with r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62] in find at 1537
    - Replaced (x1 = x_O_11[ri_63]) with ((x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U)) at 1631
    - Replaced defined condition x_O_11[ri_63], r_11[ri_63] with r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63] in find at 1537
    - Replaced (x1 = x_O_10[ri_64]) with ((x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U)) at 1618
    - Replaced defined condition x_O_10[ri_64], r_10[ri_64] with r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64] in find at 1537
    - Replaced (x1 = x_O_9[ri_65]) with ((x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U)) at 1605
    - Replaced defined condition x_O_9[ri_65], r_9[ri_65] with r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65] in find at 1537
    - Replaced (x1 = x_O_8[ri_66]) with ((x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U)) at 1592
    - Replaced defined condition x_O_8[ri_66], r_8[ri_66] with r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66] in find at 1537
    - Replaced (x1 = x_O_7[ri_67]) with ((x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U)) at 1579
    - Replaced defined condition x_O_7[ri_67], r_7[ri_67] with r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67] in find at 1537
    - Replaced (x1 = x_O_6[ri_68]) with ((x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U)) at 1566
    - Replaced defined condition x_O_6[ri_68], r_6[ri_68] with r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68] in find at 1537
    - Replaced (x1 = x_O_5[ri_69]) with ((x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U)) at 1553
    - Replaced defined condition x_O_5[ri_69], r_5[ri_69] with r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69] in find at 1537
    - Replaced (x1 = x_O_4[ri_70]) with ((x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U)) at 1540
    - Replaced defined condition x_O_4[ri_70], r_4[ri_70] with r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70] in find at 1537
    - Replaced (x_O_14 = x1[ri_85]) with ((K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85])) at 1195
    - Replaced defined condition x1[ri_85], x_O_15[ri_85], r_15[ri_85] with r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85] in find at 1163
    - Replaced (x_O_14 = x_O_10[ri_90]) with ((j = ri_90) && (y = y[u_42[j]])) at 1166
    - In branch 1 of find at 1163, substituting u_90 with j
    - Replaced defined condition x_O_10[ri_90], r_10[ri_90] with r_10[j], y[u_42[j]] in find at 1163
    - Replaced (x_O_13 = x1[ri_72]) with ((K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72])) at 1065
    - Replaced defined condition x1[ri_72], x_O_15[ri_72], r_15[ri_72] with r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72] in find at 1033
    - Replaced (x_O_13 = x_O_9[ri_78]) with ((j = ri_78) && (y = y[u_42[j]])) at 1036
    - In branch 1 of find at 1033, substituting u_78 with j
    - Replaced defined condition x_O_9[ri_78], r_9[ri_78] with r_9[j], y[u_42[j]] in find at 1033
    - Replaced (x_O_4 = x1[ri_98]) with false at 912
    - Remove branch 1 in find at 908
    - Find at 908 removed (else branch kept if any)
    - Replaced (x_O_11 = x1[ri_189]) with ((K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189])) at 817
    - Replaced defined condition x1[ri_189], x_O_15[ri_189], r_15[ri_189] with r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189] in find at 813
    - Replaced (x_O_12 = x1[ri_202]) with ((K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202])) at 742
    - Replaced defined condition x1[ri_202], x_O_15[ri_202], r_15[ri_202] with r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202] in find at 738
    - Replaced (x_O_9 = x1[ri_163]) with ((K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163])) at 614
    - Replaced defined condition x1[ri_163], x_O_15[ri_163], r_15[ri_163] with r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163] in find at 610
    - Replaced (x_O_10 = x1[ri_176]) with ((K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176])) at 539
    - Replaced defined condition x1[ri_176], x_O_15[ri_176], r_15[ri_176] with r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176] in find at 501
    - Replaced (x_O_10 = x_O_14[ri_177]) with ((u_42 = ri_177) && (x = x[j[u_42]])) at 504
    - In branch 1 of find at 501, substituting u_177 with u_42
    - Replaced defined condition x_O_14[ri_177], r_14[ri_177] with r_14[u_42], x[j[u_42]] in find at 501
    - Replaced (x_O_7 = x1[ri_137]) with ((K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137])) at 377
    - Replaced defined condition x1[ri_137], x_O_15[ri_137], r_15[ri_137] with r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137] in find at 373
    - Replaced (x_O_8 = x1[ri_150]) with ((K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150])) at 302
    - Replaced defined condition x1[ri_150], x_O_15[ri_150], r_15[ri_150] with r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150] in find at 298
    - Replaced (x_O_5 = x1[ri_111]) with ((K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111])) at 171
    - Replaced defined condition x1[ri_111], x_O_15[ri_111], r_15[ri_111] with r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111] in find at 167
    - Replaced (x_O_6 = x1[ri_124]) with ((K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124])) at 96
    - Replaced defined condition x1[ri_124], x_O_15[ri_124], r_15[ri_124] with r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124] in find at 92
yields

Game 26 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_6: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_5: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_8: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_7: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_10: bitstring <- concat(U, S, X, Y[u_42], K_u);
 {605}      find [unique]  suchthat defined(r_14[u_42], x[j[u_42]]) && {611}((u_42 = u_42) && (x = x[j[u_42]])) then
              u_177 <= NS <- u_42;
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_9: bitstring <- concat(U, S, X, Y[u_42], K_u);
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_12: bitstring <- concat(U, S, X, Yp[u_41], K_u);
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_11: bitstring <- concat(U, S, X, Yp[u_41], K_u);
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          x_O_4: bitstring <- concat(U, S, X, me_O_dec, K_u);
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            x_O_13: bitstring <- concat(U, S, X_s, Y, K_s);
{1222}      find [unique]  suchthat defined(r_9[j], y[u_42[j]]) && {1228}((j = j) && (y = y[u_42[j]])) then
              u_78 <= NU <- j;
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            x_O_14: bitstring <- concat(U, S, X_s, Y, K_s);
{1392}      find [unique]  suchthat defined(r_10[j], y[u_42[j]]) && {1398}((j = j) && (y = y[u_42[j]])) then
              u_90 <= NU <- j;
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          x_O_15: bitstring <- cst_bitstring;
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          x_O_16: bitstring <- cst_bitstring;
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability (0.5 * NU * NU + 0.5 * NS * NS + 2 * NP * qH1 + NU * NP) / |Z| + (qH1 * NU + qH0 * NU + NU * NU) / |G|]
  - Simplification pass
    - Replaced ((j = j) && (y = y[u_42[j]])) with (iS = u_42[j]) at 1398
    - Replaced defined condition r_10[j], y[u_42[j]] with r_10[j], u_42[j] in find at 1392
    - Replaced ((j = j) && (y = y[u_42[j]])) with true at 1228
    - Replaced defined condition r_9[j], y[u_42[j]] with r_9[j] in find at 1222
    - Replaced ((u_42 = u_42) && (x = x[j[u_42]])) with (iU = j[u_42]) at 611
    - Replaced defined condition r_14[u_42], x[j[u_42]] with r_14[u_42], j[u_42] in find at 605
yields

Game 27 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_6: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_5: bitstring <- concat(U, S, X, me_O_dec[u_44], K_u);
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_8: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_7: bitstring <- concat(U, S, X, me_O_dec_1[u_43], K_u);
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_10: bitstring <- concat(U, S, X, Y[u_42], K_u);
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              u_177 <= NS <- u_42;
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_9: bitstring <- concat(U, S, X, Y[u_42], K_u);
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            x_O_12: bitstring <- concat(U, S, X, Yp[u_41], K_u);
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            r <-R hash1;
            x_O_11: bitstring <- concat(U, S, X, Yp[u_41], K_u);
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          x_O_4: bitstring <- concat(U, S, X, me_O_dec, K_u);
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            x_O_13: bitstring <- concat(U, S, X_s, Y, K_s);
            find [unique]  suchthat defined(r_9[j]) then
              u_78 <= NU <- j;
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            x_O_14: bitstring <- concat(U, S, X_s, Y, K_s);
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              u_90 <= NU <- j;
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          x_O_15: bitstring <- cst_bitstring;
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          x_O_16: bitstring <- cst_bitstring;
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying move all binders
  - Move assignment to x_O_16
  - Move assignment to x_O_15
  - Move assignment to x_O_13
  - Move assignment to x_O_14
  - Move assignment to x_O_5
  - Move random number generation r
  - Move assignment to x_O_6
  - Move assignment to x_O_7
  - Move random number generation r
  - Move assignment to x_O_8
  - Move assignment to x_O_9
  - Move random number generation r
  - Move assignment to x_O_10
  - Move assignment to x_O_11
  - Move random number generation r
  - Move assignment to x_O_12
yields

Game 28 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              u_177 <= NS <- u_42;
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          x_O_4: bitstring <- concat(U, S, X, me_O_dec, K_u);
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              u_78 <= NU <- j;
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              u_90 <= NU <- j;
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_78 (definition removed, all usages removed)
  - Remove assignments on u_90 (definition removed, all usages removed)
  - Remove assignments on x_O_4 (definition removed, all usages removed)
  - Remove assignments on u_177 (definition removed, all usages removed)
yields

Game 29 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u[j]) && (Y = Y_u[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying SA rename Y_u
  - Rename variable Y_u into Y_u_5, Y_u_4, Y_u_3, Y_u_2, Y_u_1
yields

Game 30 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u_1: G <- me_O_dec[u_44];
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u_2: G <- me_O_dec_1[u_43];
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u_3: G <- Y[u_42];
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u_4: G <- Yp[u_41];
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          Y_u_5: G <- me_O_dec;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], Y_u_1[j]) && (Y = Y_u_1[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(r[j], Y_u_2[j]) && (Y = Y_u_2[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(r[j], Y_u_3[j]) && (Y = Y_u_3[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(r[j], Y_u_4[j]) && (Y = Y_u_4[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(r[j], Y_u_5[j]) && (Y = Y_u_5[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u_1[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u_1[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u_2[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u_2[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u_3[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u_3[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u_4[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u_4[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y_u_5[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y_u_5[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on Y_u_5 (definition removed, all usages removed)
  - Remove assignments on Y_u_1 (definition point kept, all usages removed)
  - Remove assignments on Y_u_2 (definition point kept, all usages removed)
  - Remove assignments on Y_u_3 (definition point kept, all usages removed)
  - Remove assignments on Y_u_4 (definition point kept, all usages removed)
yields

Game 31 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u_1: G <- cst_G;
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u_2: G <- cst_G;
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u_3: G <- cst_G;
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u_4: G <- cst_G;
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
{1066}    find [unique]  suchthat defined(me_O_dec[u_44[j]], Y_u_1[j], r[j]) && {1074}(Y = me_O_dec[u_44[j]]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(me_O_dec_1[u_43[j]], Y_u_2[j], r[j]) && {1195}(Y = me_O_dec_1[u_43[j]]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(Y[u_42[j]], Y_u_3[j], r[j]) && {1316}(Y = Y[u_42[j]]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(Yp[u_41[j]], Y_u_4[j], r[j]) && {1437}(Y = Yp[u_41[j]]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind  suchthat defined(me_O_dec[j], me_O_dec[j], r[j]) && {1557}(Y = me_O_dec[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
{2605}    find [unique] u_7 = ri_7 <= NU suchthat defined(me_O_dec[u_44[ri_7]], Y_u_1[ri_7], r[ri_7], X[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[u_44[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(me_O_dec_1[u_43[ri_7]], Y_u_2[ri_7], r[ri_7], X[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec_1[u_43[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(Y[u_42[ri_7]], Y_u_3[ri_7], r[ri_7], X[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(Yp[u_41[ri_7]], Y_u_4[ri_7], r[ri_7], X[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(me_O_dec[ri_7], me_O_dec[ri_7], r[ri_7], X[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability (0.5 * NU * NU + NS * NP + 0.5 * NS * NS + 2 * NP * qH1 + qD * NS + NU * NS + NU * NP) / |Z| + (NP * NS + qH1 * NU + qH0 * NU + NU * NU) / |G|]
  - Simplification pass
    - Replaced defined condition me_O_dec[ri_7], me_O_dec[ri_7], r[ri_7], X[ri_7], K_u[ri_7] with r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7] in find at 2605
    - Replaced defined condition Yp[u_41[ri_7]], Y_u_4[ri_7], r[ri_7], X[ri_7], K_u[ri_7] with r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7] in find at 2605
    - Replaced defined condition Y[u_42[ri_7]], Y_u_3[ri_7], r[ri_7], X[ri_7], K_u[ri_7] with r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7] in find at 2605
    - Replaced defined condition me_O_dec_1[u_43[ri_7]], Y_u_2[ri_7], r[ri_7], X[ri_7], K_u[ri_7] with r[ri_7], X[ri_7], me_O_dec_1[u_43[ri_7]], K_u[ri_7] in find at 2605
    - Replaced defined condition me_O_dec[u_44[ri_7]], Y_u_1[ri_7], r[ri_7], X[ri_7], K_u[ri_7] with r[ri_7], X[ri_7], me_O_dec[u_44[ri_7]], K_u[ri_7] in find at 2605
    - Replaced (Y = me_O_dec[j]) with false at 1557
    - Remove branch 5 in find at 1066
    - Replaced (Y = me_O_dec_1[u_43[j]]) with false at 1195
    - Remove branch 2 in find at 1066
    - Replaced (Y = me_O_dec[u_44[j]]) with false at 1074
    - Remove branch 1 in find at 1066
    - Replaced (Y = Yp[u_41[j]]) with false at 1437
    - Remove branch 2 in find at 1066
    - Replaced (Y = Y[u_42[j]]) with (iS = u_42[j]) at 1316
    - Replaced defined condition Y[u_42[j]], Y_u_3[j], r[j] with r[j], u_42[j] in find at 1066
yields

Game 32 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u_1: G <- cst_G;
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u_2: G <- cst_G;
          K_u: G <- exp(me_O_dec_1[u_43], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec_1[u_43] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (me_O_dec_1[u_43] = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (me_O_dec_1[u_43] = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u_3: G <- cst_G;
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u_4: G <- cst_G;
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = me_O_dec_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(me_O_dec_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          me_O_dec_1 <-R G;
          return(me_O_dec_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], me_O_dec_1[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = me_O_dec_1[u_43[ri_67]]) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], me_O_dec_1[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = me_O_dec_1[u_43[ri_66]]) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[u_44[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec_1[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec_1[u_43[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Proved event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s in game 32 up to probability (NU * qH1 + 0.5 * qH1 * qH1) / |hash1| + (NS * NU + NS * qD + 0.5 * NU * NU + NS * NP) / |Z| + (3 * NU * qH0 + 7 * NU * NU + 2 * NS * NU + NS * qH0 + 0.5 * qH0 * qH0 + NS * NS) / |hash0| + (0.5 * NS * NS + NP * NS) / |G|

Applying equivalence group_to_exp_strict(exp)
  - Equivalence group_to_exp_strict(exp) with variables: me_O_dec_1 -> X_1
yields

Game 33 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u_1: G <- cst_G;
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u_2: G <- cst_G;
          K_u: G <- (m_1: Z <- x; exp(g, mult(x_2[u_43], m_1)));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u_3: G <- cst_G;
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u_4: G <- cst_G;
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(x_2[ri_28], m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          me_O_dec_1: G <- cst_G;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[u_44[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand [probability (0.5 * NU * NU + 0.5 * NS * NS + 2 * NP * qH1 + NU * NP) / |Z| + (qH1 * NU + qH0 * NU + NU * NU) / |G|]
  - Expand if/find/let
yields

Game 34 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          Y_u_1: G <- cst_G;
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], me_O_dec_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          Y_u_2: G <- cst_G;
          m_1: Z <- x;
          K_u: G <- exp(g, mult(x_2[u_43], m_1));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          Y_u_3: G <- cst_G;
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          Y_u_4: G <- cst_G;
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(x_2[ri_28], m[ri_28], kd[ri_28], me_O_dec_1[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], me_O_dec_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          me_O_dec_1: G <- cst_G;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[u_44[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on me_O_dec_1 (definition removed, all usages removed)
  - Remove assignments on Y_u_1 (definition removed, all usages removed)
  - Remove assignments on Y_u_2 (definition removed, all usages removed)
  - Remove assignments on m_1 (definition removed, all usages removed)
  - Remove assignments on Y_u_3 (definition removed, all usages removed)
  - Remove assignments on Y_u_4 (definition removed, all usages removed)
yields

Game 35 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
  {27}  find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
{1407}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(x_2[ri_28], m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
{1514}  find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[u_44[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability (0.5 * NU * NU + 0.5 * NS * NS + 2 * NP * qH1 + NU * NP) / |Z| + (qH1 * NU + qH0 * NU + NU * NU) / |G|]
  - Simplification pass
    - Replaced defined condition x_2[ri_23], x_2[ri_23], kd[ri_23], m[ri_23] with x_2[ri_23], kd[ri_23], m[ri_23] in find at 1514
    - Replaced defined condition x_2[ri_28], m[ri_28], kd[ri_28], x_2[ri_28] with m[ri_28], kd[ri_28], x_2[ri_28] in find at 1407
    - Replaced defined condition x_2[ri_43], x_2[ri_43], kd[ri_43], m[ri_43] with x_2[ri_43], kd[ri_43], m[ri_43] in find at 27
yields

Game 36 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u: G <- exp(me_O_dec[u_44], x);
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (me_O_dec[u_44] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (me_O_dec[u_44] = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (me_O_dec[u_44] = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          me_O_dec <-R G;
          K_u: G <- exp(me_O_dec, x);
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = me_O_dec[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(me_O_dec[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], me_O_dec[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = me_O_dec[ri_70]) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], me_O_dec[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = me_O_dec[u_44[ri_69]]) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], me_O_dec[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = me_O_dec[u_44[ri_68]]) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[u_44[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = me_O_dec[ri_7]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence group_to_exp_strict(exp)
  - Equivalence group_to_exp_strict(exp) with variables: me_O_dec -> X_1
yields

Game 37 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u: G <- (m_3: Z <- x; exp(g, mult(x_3[u_44], m_3)));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          me_O_dec: G <- cst_G;
          K_u: G <- (m_2: Z <- x; exp(g, mult(x_3, m_2)));
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(x_3[ri_29], Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
{2156}    find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x_3[ri_7], r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand [probability (0.5 * NU * NU + 0.5 * NS * NS + NU * qH1 + NU * qH0 + 2 * NP * qH1 + NU * NP) / |Z|]
  - Expand if/find/let
    - Replaced defined condition x_3[ri_7], r[ri_7], X[ri_7], me_O_dec[ri_7], K_u[ri_7] with r[ri_7], X[ri_7], x_3[ri_7], K_u[ri_7] in find at 2156
yields

Game 38 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], me_O_dec[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          m_3: Z <- x;
          K_u: G <- exp(g, mult(x_3[u_44], m_3));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          me_O_dec: G <- cst_G;
          m_2: Z <- x;
          K_u: G <- exp(g, mult(x_3, m_2));
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(x_3[ri_29], Ystar_u[ri_29], me_O_dec[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], me_O_dec[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on me_O_dec (definition removed, all usages removed)
  - Remove assignments on m_2 (definition removed, all usages removed)
  - Remove assignments on m_3 (definition removed, all usages removed)
yields

Game 39 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
  {27}  find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u: G <- exp(g, mult(x_3[u_44], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          K_u: G <- exp(g, mult(x_3, x));
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
{1417}  find [unique] u_29 = ri_29 <= NU suchthat defined(x_3[ri_29], Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
{1526}  find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability (0.5 * NS * NS + NU * qH1 + NU * qH0 + 2 * NP * qH1 + 1.5 * NU * NU + NU * NP) / |Z|]
  - Simplification pass
    - Replaced defined condition x_3[ri_24], x_3[ri_24], Ystar_u[ri_24] with x_3[ri_24], Ystar_u[ri_24] in find at 1526
    - Replaced defined condition x_3[ri_29], Ystar_u[ri_29], x_3[ri_29] with Ystar_u[ri_29], x_3[ri_29] in find at 1417
    - Replaced defined condition x_3[ri_44], x_3[ri_44], Ystar_u[ri_44] with x_3[ri_44], Ystar_u[ri_44] in find at 27
yields

Game 40 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u: G <- exp(g, mult(x_3[u_44], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          K_u: G <- exp(g, mult(x_3, x));
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70], K_u[ri_70]) && (x05 = K_u[ri_70]) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]], K_u[ri_69]) && (x05 = K_u[ri_69]) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]], K_u[ri_68]) && (x05 = K_u[ri_68]) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u[ri_67]) && (x05 = K_u[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u[ri_66]) && (x05 = K_u[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u[ri_65]) && (x05 = K_u[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u[ri_64]) && (x05 = K_u[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u[ri_63]) && (x05 = K_u[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u[ri_62]) && (x05 = K_u[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[ri_7], K_u[ri_7]) && (x15 = K_u[ri_7]) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying SA rename K_u
  - Rename variable K_u into K_u_5, K_u_4, K_u_3, K_u_2, K_u_1
yields

Game 41 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- exp(g, mult(x_3[u_44], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_1 = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u_1 = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u_1 = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_2 = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u_2 = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u_2 = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_3 = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u_3 = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u_3 = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_4 = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u_4 = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u_4 = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          K_u_5: G <- exp(g, mult(x_3, x));
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70], K_u_5[ri_70]) && (x05 = K_u_5[ri_70]) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]], K_u_1[ri_69]) && (x05 = K_u_1[ri_69]) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]], K_u_1[ri_68]) && (x05 = K_u_1[ri_68]) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u_2[ri_67]) && (x05 = K_u_2[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u_2[ri_66]) && (x05 = K_u_2[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u_3[ri_65]) && (x05 = K_u_3[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u_3[ri_64]) && (x05 = K_u_3[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u_4[ri_63]) && (x05 = K_u_4[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u_4[ri_62]) && (x05 = K_u_4[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
{2144}    find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u_1[ri_7]) && (x15 = K_u_1[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u_2[ri_7]) && (x15 = K_u_2[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u_5[ri_7]) && (x15 = K_u_5[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_1[ri_7]) && (x15 = K_u_1[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_2[ri_7]) && (x15 = K_u_2[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_5[ri_7]) && (x15 = K_u_5[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_1[ri_7]) && (x15 = K_u_1[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_2[ri_7]) && (x15 = K_u_2[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_5[ri_7]) && (x15 = K_u_5[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_1[ri_7]) && (x15 = K_u_1[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_2[ri_7]) && (x15 = K_u_2[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_5[ri_7]) && (x15 = K_u_5[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[ri_7], K_u_5[ri_7]) && (x15 = K_u_5[ri_7]) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability (0.5 * NS * NS + NU * qH1 + NU * qH0 + 2 * NP * qH1 + 1.5 * NU * NU + NU * NP) / |Z|]
  - Simplification pass
    - Remove branch 20 in find at 2144
    - Remove branch 18 in find at 2144
    - Remove branch 17 in find at 2144
    - Remove branch 16 in find at 2144
    - Remove branch 15 in find at 2144
    - Remove branch 14 in find at 2144
    - Remove branch 12 in find at 2144
    - Remove branch 11 in find at 2144
    - Remove branch 10 in find at 2144
    - Remove branch 9 in find at 2144
    - Remove branch 8 in find at 2144
    - Remove branch 6 in find at 2144
    - Remove branch 5 in find at 2144
    - Remove branch 4 in find at 2144
    - Remove branch 3 in find at 2144
    - Remove branch 2 in find at 2144
yields

Game 42 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- exp(g, mult(x_3[u_44], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_1 = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u_1 = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u_1 = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_2 = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u_2 = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u_2 = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_3 = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u_3 = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u_3 = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_4 = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u_4 = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u_4 = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          K_u_5: G <- exp(g, mult(x_3, x));
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70], K_u_5[ri_70]) && (x05 = K_u_5[ri_70]) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]], K_u_1[ri_69]) && (x05 = K_u_1[ri_69]) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]], K_u_1[ri_68]) && (x05 = K_u_1[ri_68]) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u_2[ri_67]) && (x05 = K_u_2[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u_2[ri_66]) && (x05 = K_u_2[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u_3[ri_65]) && (x05 = K_u_3[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u_3[ri_64]) && (x05 = K_u_3[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u_4[ri_63]) && (x05 = K_u_4[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u_4[ri_62]) && (x05 = K_u_4[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u_1[ri_7]) && (x15 = K_u_1[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_2[ri_7]) && (x15 = K_u_2[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[ri_7], K_u_5[ri_7]) && (x15 = K_u_5[ri_7]) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of binder K_u_5
  - Remove assignments on K_u_5 (definition removed, all usages removed)
yields

Game 43 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- exp(g, mult(x_3[u_44], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_1 = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (K_u_1 = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (K_u_1 = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_2 = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u_2 = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u_2 = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_3 = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u_3 = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u_3 = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_4 = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u_4 = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u_4 = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(x[ri_70], x_3[ri_70], r_4[ri_70], X[ri_70], x_3[ri_70]) && (x05 = exp(g, mult(x_3[ri_70], x[ri_70]))) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]], K_u_1[ri_69]) && (x05 = K_u_1[ri_69]) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]], K_u_1[ri_68]) && (x05 = K_u_1[ri_68]) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u_2[ri_67]) && (x05 = K_u_2[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u_2[ri_66]) && (x05 = K_u_2[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u_3[ri_65]) && (x05 = K_u_3[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u_3[ri_64]) && (x05 = K_u_3[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u_4[ri_63]) && (x05 = K_u_4[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u_4[ri_62]) && (x05 = K_u_4[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[u_44[ri_7]], K_u_1[ri_7]) && (x15 = K_u_1[ri_7]) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_2[ri_7]) && (x15 = K_u_2[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], x_3[ri_7], r[ri_7], X[ri_7], x_3[ri_7]) && (x15 = exp(g, mult(x_3[ri_7], x[ri_7]))) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of binder K_u_1
  - Remove assignments on K_u_1 (definition point kept, all usages removed)
yields

Game 44 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_3[u_44], x)) = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- exp(g, mult(x_2[u_43], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_2 = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (K_u_2 = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (K_u_2 = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_3 = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u_3 = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u_3 = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_4 = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u_4 = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u_4 = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(x[ri_70], x_3[ri_70], r_4[ri_70], X[ri_70], x_3[ri_70]) && (x05 = exp(g, mult(x_3[ri_70], x[ri_70]))) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x[ri_69], K_u_1[ri_69], r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (x05 = exp(g, mult(x_3[u_44[ri_69]], x[ri_69]))) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x[ri_68], K_u_1[ri_68], r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (x05 = exp(g, mult(x_3[u_44[ri_68]], x[ri_68]))) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]], K_u_2[ri_67]) && (x05 = K_u_2[ri_67]) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]], K_u_2[ri_66]) && (x05 = K_u_2[ri_66]) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u_3[ri_65]) && (x05 = K_u_3[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u_3[ri_64]) && (x05 = K_u_3[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u_4[ri_63]) && (x05 = K_u_4[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u_4[ri_62]) && (x05 = K_u_4[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (x15 = exp(g, mult(x_3[u_44[ri_7]], x[ri_7]))) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_2[u_43[ri_7]], K_u_2[ri_7]) && (x15 = K_u_2[ri_7]) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], x_3[ri_7], r[ri_7], X[ri_7], x_3[ri_7]) && (x15 = exp(g, mult(x_3[ri_7], x[ri_7]))) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of binder K_u_2
  - Remove assignments on K_u_2 (definition point kept, all usages removed)
yields

Game 45 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_3[u_44], x)) = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_2[u_43], x)) = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- exp(g, mult(y[u_42], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_3 = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (K_u_3 = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (K_u_3 = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_4 = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u_4 = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u_4 = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(x[ri_70], x_3[ri_70], r_4[ri_70], X[ri_70], x_3[ri_70]) && (x05 = exp(g, mult(x_3[ri_70], x[ri_70]))) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x[ri_69], K_u_1[ri_69], r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (x05 = exp(g, mult(x_3[u_44[ri_69]], x[ri_69]))) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x[ri_68], K_u_1[ri_68], r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (x05 = exp(g, mult(x_3[u_44[ri_68]], x[ri_68]))) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(x[ri_67], K_u_2[ri_67], r_7[ri_67], X[ri_67], x_2[u_43[ri_67]]) && (x05 = exp(g, mult(x_2[u_43[ri_67]], x[ri_67]))) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(x[ri_66], K_u_2[ri_66], r_8[ri_66], X[ri_66], x_2[u_43[ri_66]]) && (x05 = exp(g, mult(x_2[u_43[ri_66]], x[ri_66]))) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]], K_u_3[ri_65]) && (x05 = K_u_3[ri_65]) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]], K_u_3[ri_64]) && (x05 = K_u_3[ri_64]) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u_4[ri_63]) && (x05 = K_u_4[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u_4[ri_62]) && (x05 = K_u_4[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (x15 = exp(g, mult(x_3[u_44[ri_7]], x[ri_7]))) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_2[ri_7], r[ri_7], X[ri_7], x_2[u_43[ri_7]]) && (x15 = exp(g, mult(x_2[u_43[ri_7]], x[ri_7]))) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Y[u_42[ri_7]], K_u_3[ri_7]) && (x15 = K_u_3[ri_7]) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], x_3[ri_7], r[ri_7], X[ri_7], x_3[ri_7]) && (x15 = exp(g, mult(x_3[ri_7], x[ri_7]))) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of binder K_u_3
  - Remove assignments on K_u_3 (definition point kept, all usages removed)
yields

Game 46 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_3[u_44], x)) = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_2[u_43], x)) = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(y[u_42], x)) = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (exp(g, mult(y[u_42], x)) = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (exp(g, mult(y[u_42], x)) = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- exp(g, mult(yp[u_41], x));
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (K_u_4 = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (K_u_4 = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (K_u_4 = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(x[ri_70], x_3[ri_70], r_4[ri_70], X[ri_70], x_3[ri_70]) && (x05 = exp(g, mult(x_3[ri_70], x[ri_70]))) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x[ri_69], K_u_1[ri_69], r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (x05 = exp(g, mult(x_3[u_44[ri_69]], x[ri_69]))) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x[ri_68], K_u_1[ri_68], r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (x05 = exp(g, mult(x_3[u_44[ri_68]], x[ri_68]))) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(x[ri_67], K_u_2[ri_67], r_7[ri_67], X[ri_67], x_2[u_43[ri_67]]) && (x05 = exp(g, mult(x_2[u_43[ri_67]], x[ri_67]))) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(x[ri_66], K_u_2[ri_66], r_8[ri_66], X[ri_66], x_2[u_43[ri_66]]) && (x05 = exp(g, mult(x_2[u_43[ri_66]], x[ri_66]))) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(x[ri_65], y[u_42[ri_65]], K_u_3[ri_65], r_9[ri_65], X[ri_65], Y[u_42[ri_65]]) && (x05 = exp(g, mult(y[u_42[ri_65]], x[ri_65]))) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(x[ri_64], y[u_42[ri_64]], K_u_3[ri_64], r_10[ri_64], X[ri_64], Y[u_42[ri_64]]) && (x05 = exp(g, mult(y[u_42[ri_64]], x[ri_64]))) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]], K_u_4[ri_63]) && (x05 = K_u_4[ri_63]) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]], K_u_4[ri_62]) && (x05 = K_u_4[ri_62]) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (x15 = exp(g, mult(x_3[u_44[ri_7]], x[ri_7]))) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_2[ri_7], r[ri_7], X[ri_7], x_2[u_43[ri_7]]) && (x15 = exp(g, mult(x_2[u_43[ri_7]], x[ri_7]))) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], y[u_42[ri_7]], K_u_3[ri_7], r[ri_7], X[ri_7], Y[u_42[ri_7]]) && (x15 = exp(g, mult(y[u_42[ri_7]], x[ri_7]))) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], Yp[u_41[ri_7]], K_u_4[ri_7]) && (x15 = K_u_4[ri_7]) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], x_3[ri_7], r[ri_7], X[ri_7], x_3[ri_7]) && (x15 = exp(g, mult(x_3[ri_7], x[ri_7]))) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of binder K_u_4
  - Remove assignments on K_u_4 (definition point kept, all usages removed)
yields

Game 47 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_3[u_44], x)) = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_2[u_43], x)) = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(y[u_42], x)) = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (exp(g, mult(y[u_42], x)) = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (exp(g, mult(y[u_42], x)) = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(yp[u_41], x)) = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (exp(g, mult(yp[u_41], x)) = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (exp(g, mult(yp[u_41], x)) = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- exp(g, mult(x[j], y));
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (K_s = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (K_s = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (K_s = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(x[ri_70], x_3[ri_70], r_4[ri_70], X[ri_70], x_3[ri_70]) && (x05 = exp(g, mult(x_3[ri_70], x[ri_70]))) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x[ri_69], K_u_1[ri_69], r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (x05 = exp(g, mult(x_3[u_44[ri_69]], x[ri_69]))) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x[ri_68], K_u_1[ri_68], r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (x05 = exp(g, mult(x_3[u_44[ri_68]], x[ri_68]))) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(x[ri_67], K_u_2[ri_67], r_7[ri_67], X[ri_67], x_2[u_43[ri_67]]) && (x05 = exp(g, mult(x_2[u_43[ri_67]], x[ri_67]))) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(x[ri_66], K_u_2[ri_66], r_8[ri_66], X[ri_66], x_2[u_43[ri_66]]) && (x05 = exp(g, mult(x_2[u_43[ri_66]], x[ri_66]))) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(x[ri_65], y[u_42[ri_65]], K_u_3[ri_65], r_9[ri_65], X[ri_65], Y[u_42[ri_65]]) && (x05 = exp(g, mult(y[u_42[ri_65]], x[ri_65]))) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(x[ri_64], y[u_42[ri_64]], K_u_3[ri_64], r_10[ri_64], X[ri_64], Y[u_42[ri_64]]) && (x05 = exp(g, mult(y[u_42[ri_64]], x[ri_64]))) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(x[ri_63], yp[u_41[ri_63]], K_u_4[ri_63], r_11[ri_63], X[ri_63], Yp[u_41[ri_63]]) && (x05 = exp(g, mult(yp[u_41[ri_63]], x[ri_63]))) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(x[ri_62], yp[u_41[ri_62]], K_u_4[ri_62], r_12[ri_62], X[ri_62], Yp[u_41[ri_62]]) && (x05 = exp(g, mult(yp[u_41[ri_62]], x[ri_62]))) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61], K_s[ri_61]) && (x05 = K_s[ri_61]) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60], K_s[ri_60]) && (x05 = K_s[ri_60]) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (x15 = exp(g, mult(x_3[u_44[ri_7]], x[ri_7]))) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_2[ri_7], r[ri_7], X[ri_7], x_2[u_43[ri_7]]) && (x15 = exp(g, mult(x_2[u_43[ri_7]], x[ri_7]))) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], y[u_42[ri_7]], K_u_3[ri_7], r[ri_7], X[ri_7], Y[u_42[ri_7]]) && (x15 = exp(g, mult(y[u_42[ri_7]], x[ri_7]))) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], yp[u_41[ri_7]], K_u_4[ri_7], r[ri_7], X[ri_7], Yp[u_41[ri_7]]) && (x15 = exp(g, mult(yp[u_41[ri_7]], x[ri_7]))) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], x_3[ri_7], r[ri_7], X[ri_7], x_3[ri_7]) && (x15 = exp(g, mult(x_3[ri_7], x[ri_7]))) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of binder K_s
  - Remove assignments on K_s (definition point kept, all usages removed)
yields

Game 48 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_3[u_44], x)) = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_2[u_43], x)) = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(y[u_42], x)) = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (exp(g, mult(y[u_42], x)) = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (exp(g, mult(y[u_42], x)) = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(yp[u_41], x)) = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (exp(g, mult(yp[u_41], x)) = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (exp(g, mult(yp[u_41], x)) = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- cst_G;
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (exp(g, mult(x[j], y)) = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (exp(g, mult(x[j], y)) = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (exp(g, mult(x[j], y)) = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        Kp: G <- exp(g, mult(xp, yp));
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(x[ri_70], x_3[ri_70], r_4[ri_70], X[ri_70], x_3[ri_70]) && (x05 = exp(g, mult(x_3[ri_70], x[ri_70]))) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x[ri_69], K_u_1[ri_69], r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (x05 = exp(g, mult(x_3[u_44[ri_69]], x[ri_69]))) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x[ri_68], K_u_1[ri_68], r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (x05 = exp(g, mult(x_3[u_44[ri_68]], x[ri_68]))) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(x[ri_67], K_u_2[ri_67], r_7[ri_67], X[ri_67], x_2[u_43[ri_67]]) && (x05 = exp(g, mult(x_2[u_43[ri_67]], x[ri_67]))) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(x[ri_66], K_u_2[ri_66], r_8[ri_66], X[ri_66], x_2[u_43[ri_66]]) && (x05 = exp(g, mult(x_2[u_43[ri_66]], x[ri_66]))) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(x[ri_65], y[u_42[ri_65]], K_u_3[ri_65], r_9[ri_65], X[ri_65], Y[u_42[ri_65]]) && (x05 = exp(g, mult(y[u_42[ri_65]], x[ri_65]))) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(x[ri_64], y[u_42[ri_64]], K_u_3[ri_64], r_10[ri_64], X[ri_64], Y[u_42[ri_64]]) && (x05 = exp(g, mult(y[u_42[ri_64]], x[ri_64]))) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(x[ri_63], yp[u_41[ri_63]], K_u_4[ri_63], r_11[ri_63], X[ri_63], Yp[u_41[ri_63]]) && (x05 = exp(g, mult(yp[u_41[ri_63]], x[ri_63]))) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(x[ri_62], yp[u_41[ri_62]], K_u_4[ri_62], r_12[ri_62], X[ri_62], Yp[u_41[ri_62]]) && (x05 = exp(g, mult(yp[u_41[ri_62]], x[ri_62]))) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(y[ri_61], x[j[ri_61]], K_s[ri_61], r_13[ri_61], X_s[ri_61], Y[ri_61]) && (x05 = exp(g, mult(x[j[ri_61]], y[ri_61]))) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(y[ri_60], x[j[ri_60]], K_s[ri_60], r_14[ri_60], X_s[ri_60], Y[ri_60]) && (x05 = exp(g, mult(x[j[ri_60]], y[ri_60]))) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (x15 = exp(g, mult(x_3[u_44[ri_7]], x[ri_7]))) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_2[ri_7], r[ri_7], X[ri_7], x_2[u_43[ri_7]]) && (x15 = exp(g, mult(x_2[u_43[ri_7]], x[ri_7]))) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], y[u_42[ri_7]], K_u_3[ri_7], r[ri_7], X[ri_7], Y[u_42[ri_7]]) && (x15 = exp(g, mult(y[u_42[ri_7]], x[ri_7]))) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], yp[u_41[ri_7]], K_u_4[ri_7], r[ri_7], X[ri_7], Yp[u_41[ri_7]]) && (x15 = exp(g, mult(yp[u_41[ri_7]], x[ri_7]))) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], x_3[ri_7], r[ri_7], X[ri_7], x_3[ri_7]) && (x15 = exp(g, mult(x_3[ri_7], x[ri_7]))) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6], Kp[ri_6]) && (x15 = Kp[ri_6]) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of binder Kp
  - Remove assignments on Kp (definition removed, all usages removed)
yields

Game 49 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_3[u_44], x)) = x15[ri_17]) && (exp(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_124]) && (exp(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (exp(g, mult(x_3[u_44], x)) = x05[ri_111]) && (exp(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(x_2[u_43], x)) = x15[ri_17]) && (exp(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_150]) && (exp(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (exp(g, mult(x_2[u_43], x)) = x05[ri_137]) && (exp(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(y[ri_42], Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(y[u_42], x)) = x15[ri_17]) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (exp(g, mult(y[u_42], x)) = x05[ri_176]) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (exp(g, mult(y[u_42], x)) = x05[ri_163]) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(yp[ri_41], Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (exp(g, mult(yp[u_41], x)) = x15[ri_17]) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (exp(g, mult(yp[u_41], x)) = x05[ri_202]) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (exp(g, mult(yp[u_41], x)) = x05[ri_189]) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(x[j_1], X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- cst_G;
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (exp(g, mult(x[j], y)) = x05[ri_72]) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (exp(g, mult(x[j], y)) = x15[ri_13]) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (exp(g, mult(x[j], y)) = x05[ri_85]) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp(g, xp);
        yp <-R Z;
        Yp: G <- exp(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(x[ri_70], x_3[ri_70], r_4[ri_70], X[ri_70], x_3[ri_70]) && (x05 = exp(g, mult(x_3[ri_70], x[ri_70]))) && (x04 = exp(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(x[ri_69], K_u_1[ri_69], r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (x05 = exp(g, mult(x_3[u_44[ri_69]], x[ri_69]))) && (x04 = exp(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(x[ri_68], K_u_1[ri_68], r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (x05 = exp(g, mult(x_3[u_44[ri_68]], x[ri_68]))) && (x04 = exp(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(x[ri_67], K_u_2[ri_67], r_7[ri_67], X[ri_67], x_2[u_43[ri_67]]) && (x05 = exp(g, mult(x_2[u_43[ri_67]], x[ri_67]))) && (x04 = exp(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(x[ri_66], K_u_2[ri_66], r_8[ri_66], X[ri_66], x_2[u_43[ri_66]]) && (x05 = exp(g, mult(x_2[u_43[ri_66]], x[ri_66]))) && (x04 = exp(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(x[ri_65], y[u_42[ri_65]], K_u_3[ri_65], r_9[ri_65], X[ri_65], Y[u_42[ri_65]]) && (x05 = exp(g, mult(y[u_42[ri_65]], x[ri_65]))) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(x[ri_64], y[u_42[ri_64]], K_u_3[ri_64], r_10[ri_64], X[ri_64], Y[u_42[ri_64]]) && (x05 = exp(g, mult(y[u_42[ri_64]], x[ri_64]))) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(x[ri_63], yp[u_41[ri_63]], K_u_4[ri_63], r_11[ri_63], X[ri_63], Yp[u_41[ri_63]]) && (x05 = exp(g, mult(yp[u_41[ri_63]], x[ri_63]))) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(x[ri_62], yp[u_41[ri_62]], K_u_4[ri_62], r_12[ri_62], X[ri_62], Yp[u_41[ri_62]]) && (x05 = exp(g, mult(yp[u_41[ri_62]], x[ri_62]))) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(y[ri_61], x[j[ri_61]], K_s[ri_61], r_13[ri_61], X_s[ri_61], Y[ri_61]) && (x05 = exp(g, mult(x[j[ri_61]], y[ri_61]))) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(y[ri_60], x[j[ri_60]], K_s[ri_60], r_14[ri_60], X_s[ri_60], Y[ri_60]) && (x05 = exp(g, mult(x[j[ri_60]], y[ri_60]))) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (x15 = exp(g, mult(x_3[u_44[ri_7]], x[ri_7]))) && (x14 = exp(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], K_u_2[ri_7], r[ri_7], X[ri_7], x_2[u_43[ri_7]]) && (x15 = exp(g, mult(x_2[u_43[ri_7]], x[ri_7]))) && (x14 = exp(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], y[u_42[ri_7]], K_u_3[ri_7], r[ri_7], X[ri_7], Y[u_42[ri_7]]) && (x15 = exp(g, mult(y[u_42[ri_7]], x[ri_7]))) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], yp[u_41[ri_7]], K_u_4[ri_7], r[ri_7], X[ri_7], Yp[u_41[ri_7]]) && (x15 = exp(g, mult(yp[u_41[ri_7]], x[ri_7]))) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(x[ri_7], x_3[ri_7], r[ri_7], X[ri_7], x_3[ri_7]) && (x15 = exp(g, mult(x_3[ri_7], x[ri_7]))) && (x14 = exp(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(yp[ri_6], xp[ri_6], Yp[ri_6], r_1[ri_6], Xp[ri_6], Yp[ri_6]) && (x15 = exp(g, mult(xp[ri_6], yp[ri_6]))) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence cdh(exp) with x_2, x [probability (4 + 5 * qH0 + 8 * qH1) * pCDH(time(context for game 49) + time + (5 + 5 * qH0 + 8 * qH1 + 2 * NP + NS + qD + 2 * NU) * time(exp)) + (2 * NP + NS + qD + 2 * NU) * pZero + NS * NP / |G| + (0.5 * NS * NS + NP * NP + 2 * NU * NP + 2 * NS * NP + 1.5 * NU * NU) / |Z|]
  - Equivalence cdh(exp) with variables: xp -> a_1, yp -> b, y -> b, x_2 -> b, x_3 -> b, x -> a_1
yields

Game 50 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_5: G <- x15[ri_17]; {51}find  else {52}find  else false) && (exp'(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (m_6: G <- x05[ri_124]; {89}find  else {90}find  else false) && (exp'(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
            find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (m_4: G <- x05[ri_111]; {180}find  else {181}find  else false) && (exp'(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_8: G <- x15[ri_17]; {285}find  else {286}find  else false) && (exp'(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (m_9: G <- x05[ri_150]; {323}find  else {324}find  else false) && (exp'(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
            find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (m_7: G <- x05[ri_137]; {414}find  else {415}find  else false) && (exp'(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_11: G <- x15[ri_17]; {513}find  else {514}find  else false) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (m_12: G <- x05[ri_176]; {585}find  else {586}find  else false) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
            find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (m_10: G <- x05[ri_163]; {674}find  else {675}find  else false) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- cst_G;
          find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_14: G <- x15[ri_17]; {771}find  else {772}find  else false) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (m_15: G <- x05[ri_202]; {807}find  else {808}find  else false) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
            find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (m_13: G <- x05[ri_189]; {896}find  else {897}find  else false) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- cst_G;
          find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
            find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (m_17: G <- x05[ri_72]; {1092}find  else {1093}find  else false) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (m_19: G <- x15[ri_13]; {1168}find  else {1169}find  else false) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (m_21: G <- x05[ri_85]; {1240}find  else {1241}find  else false) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp'(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp'(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp'(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70]) && (m_22: G <- x05; {1607}find  else {1608}find  else false) && (x04 = exp'(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (m_23: G <- x05; {1647}find  else {1648}find  else false) && (x04 = exp'(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (m_24: G <- x05; {1688}find  else {1689}find  else false) && (x04 = exp'(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]]) && (m_25: G <- x05; {1729}find  else {1730}find  else false) && (x04 = exp'(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]]) && (m_26: G <- x05; {1770}find  else {1771}find  else false) && (x04 = exp'(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]]) && (m_27: G <- x05; {1811}find  else {1812}find  else false) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]]) && (m_28: G <- x05; {1850}find  else {1851}find  else false) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]]) && (m_29: G <- x05; {1889}find  else {1890}find  else false) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]]) && (m_30: G <- x05; {1928}find  else {1929}find  else false) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61]) && (m_32: G <- x05; {1966}find  else {1967}find  else false) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60]) && (m_34: G <- x05; {2003}find  else {2004}find  else false) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_7 = ri_7 <= NU suchthat defined(K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (m_35: G <- x15; {2116}find  else {2117}find  else false) && (x14 = exp'(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(K_u_2[ri_7], r[ri_7], X[ri_7], x_2[u_43[ri_7]]) && (m_36: G <- x15; {2158}find  else {2159}find  else false) && (x14 = exp'(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(K_u_3[ri_7], r[ri_7], X[ri_7], Y[u_42[ri_7]]) && (m_37: G <- x15; {2200}find  else {2201}find  else false) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(K_u_4[ri_7], r[ri_7], X[ri_7], Yp[u_41[ri_7]]) && (m_38: G <- x15; {2240}find  else {2241}find  else false) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[ri_7]) && (m_39: G <- x15; {2278}find  else {2279}find  else false) && (x14 = exp'(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6]) && (m_41: G <- x15; {2317}find  else {2318}find  else false) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify (non-expanded game)
  - Simplification pass
    - Find at 51 removed (else branch kept if any)
    - Find at 52 removed (else branch kept if any)
    - Find at 89 removed (else branch kept if any)
    - Find at 90 removed (else branch kept if any)
    - Find at 180 removed (else branch kept if any)
    - Find at 181 removed (else branch kept if any)
    - Find at 285 removed (else branch kept if any)
    - Find at 286 removed (else branch kept if any)
    - Find at 323 removed (else branch kept if any)
    - Find at 324 removed (else branch kept if any)
    - Find at 414 removed (else branch kept if any)
    - Find at 415 removed (else branch kept if any)
    - Find at 513 removed (else branch kept if any)
    - Find at 514 removed (else branch kept if any)
    - Find at 585 removed (else branch kept if any)
    - Find at 586 removed (else branch kept if any)
    - Find at 674 removed (else branch kept if any)
    - Find at 675 removed (else branch kept if any)
    - Find at 771 removed (else branch kept if any)
    - Find at 772 removed (else branch kept if any)
    - Find at 807 removed (else branch kept if any)
    - Find at 808 removed (else branch kept if any)
    - Find at 896 removed (else branch kept if any)
    - Find at 897 removed (else branch kept if any)
    - Find at 1092 removed (else branch kept if any)
    - Find at 1093 removed (else branch kept if any)
    - Find at 1168 removed (else branch kept if any)
    - Find at 1169 removed (else branch kept if any)
    - Find at 1240 removed (else branch kept if any)
    - Find at 1241 removed (else branch kept if any)
    - Find at 1607 removed (else branch kept if any)
    - Find at 1608 removed (else branch kept if any)
    - Find at 1647 removed (else branch kept if any)
    - Find at 1648 removed (else branch kept if any)
    - Find at 1688 removed (else branch kept if any)
    - Find at 1689 removed (else branch kept if any)
    - Find at 1729 removed (else branch kept if any)
    - Find at 1730 removed (else branch kept if any)
    - Find at 1770 removed (else branch kept if any)
    - Find at 1771 removed (else branch kept if any)
    - Find at 1811 removed (else branch kept if any)
    - Find at 1812 removed (else branch kept if any)
    - Find at 1850 removed (else branch kept if any)
    - Find at 1851 removed (else branch kept if any)
    - Find at 1889 removed (else branch kept if any)
    - Find at 1890 removed (else branch kept if any)
    - Find at 1928 removed (else branch kept if any)
    - Find at 1929 removed (else branch kept if any)
    - Find at 1966 removed (else branch kept if any)
    - Find at 1967 removed (else branch kept if any)
    - Find at 2003 removed (else branch kept if any)
    - Find at 2004 removed (else branch kept if any)
    - Find at 2116 removed (else branch kept if any)
    - Find at 2117 removed (else branch kept if any)
    - Find at 2158 removed (else branch kept if any)
    - Find at 2159 removed (else branch kept if any)
    - Find at 2200 removed (else branch kept if any)
    - Find at 2201 removed (else branch kept if any)
    - Find at 2240 removed (else branch kept if any)
    - Find at 2241 removed (else branch kept if any)
    - Find at 2278 removed (else branch kept if any)
    - Find at 2279 removed (else branch kept if any)
    - Find at 2317 removed (else branch kept if any)
    - Find at 2318 removed (else branch kept if any)
yields

Game 51 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
  {27}  find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
  {37}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_5: G <- x15[ri_17]; false) && (exp'(g, x_3[u_44]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_124 = ri_124 <= qH0 suchthat defined(r_15[ri_124], x01[ri_124], x02[ri_124], x03[ri_124], x04[ri_124], x05[ri_124]) && (m_6: G <- x05[ri_124]; false) && (exp'(g, x_3[u_44]) = x04[ri_124]) && (X = x03[ri_124]) && (S = x02[ri_124]) && (U = x01[ri_124]) then
              sk_u: hash0 <- r_15[u_124];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_124]);
              return(r_2[u_17])
            else
              r_6 <-R hash0;
              sk_u: hash0 <- r_6;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_6);
              return(r_2[u_17])
          else
 {162}      find [unique] u_111 = ri_111 <= qH0 suchthat defined(r_15[ri_111], x01[ri_111], x02[ri_111], x03[ri_111], x04[ri_111], x05[ri_111]) && (m_4: G <- x05[ri_111]; false) && (exp'(g, x_3[u_44]) = x04[ri_111]) && (X = x03[ri_111]) && (S = x02[ri_111]) && (U = x01[ri_111]) then
              sk_u: hash0 <- r_15[u_111];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_111]);
              return(r)
            else
              r_5 <-R hash0;
              sk_u: hash0 <- r_5;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_5);
              return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
 {265}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_8: G <- x15[ri_17]; false) && (exp'(g, x_2[u_43]) = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_150 = ri_150 <= qH0 suchthat defined(r_15[ri_150], x01[ri_150], x02[ri_150], x03[ri_150], x04[ri_150], x05[ri_150]) && (m_9: G <- x05[ri_150]; false) && (exp'(g, x_2[u_43]) = x04[ri_150]) && (X = x03[ri_150]) && (S = x02[ri_150]) && (U = x01[ri_150]) then
              sk_u: hash0 <- r_15[u_150];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_150]);
              return(r_2[u_17])
            else
              r_8 <-R hash0;
              sk_u: hash0 <- r_8;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_8);
              return(r_2[u_17])
          else
 {390}      find [unique] u_137 = ri_137 <= qH0 suchthat defined(r_15[ri_137], x01[ri_137], x02[ri_137], x03[ri_137], x04[ri_137], x05[ri_137]) && (m_7: G <- x05[ri_137]; false) && (exp'(g, x_2[u_43]) = x04[ri_137]) && (X = x03[ri_137]) && (S = x02[ri_137]) && (U = x01[ri_137]) then
              sk_u: hash0 <- r_15[u_137];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_137]);
              return(r)
            else
              r_7 <-R hash0;
              sk_u: hash0 <- r_7;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_7);
              return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(Y[ri_42], md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- cst_G;
 {487}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_11: G <- x15[ri_17]; false) && (Y[u_42] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique]  suchthat defined(r_14[u_42], j[u_42]) && (iU = j[u_42]) then
              sk_u: hash0 <- r_14[u_42];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_14[u_42]);
              return(r_2[u_17])
            orfind u_176 = ri_176 <= qH0 suchthat defined(r_15[ri_176], x01[ri_176], x02[ri_176], x03[ri_176], x04[ri_176], x05[ri_176]) && (m_12: G <- x05[ri_176]; false) && (Y[u_42] = x04[ri_176]) && (X = x03[ri_176]) && (S = x02[ri_176]) && (U = x01[ri_176]) then
              sk_u: hash0 <- r_15[u_176];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_176]);
              return(r_2[u_17])
            else
              r_10 <-R hash0;
              sk_u: hash0 <- r_10;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_10);
              return(r_2[u_17])
          else
 {644}      find [unique] u_163 = ri_163 <= qH0 suchthat defined(r_15[ri_163], x01[ri_163], x02[ri_163], x03[ri_163], x04[ri_163], x05[ri_163]) && (m_10: G <- x05[ri_163]; false) && (Y[u_42] = x04[ri_163]) && (X = x03[ri_163]) && (S = x02[ri_163]) && (U = x01[ri_163]) then
              sk_u: hash0 <- r_15[u_163];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_163]);
              return(r)
            else
              r_9 <-R hash0;
              sk_u: hash0 <- r_9;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_9);
              return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(Yp[ri_41], md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- cst_G;
 {739}    find [unique] u_17 = ri_17 <= qH1 suchthat defined(r_2[ri_17], x11[ri_17], x12[ri_17], x13[ri_17], x14[ri_17], x15[ri_17]) && (m_14: G <- x15[ri_17]; false) && (Yp[u_41] = x14[ri_17]) && (X = x13[ri_17]) && (S = x12[ri_17]) && (U = x11[ri_17]) then
            find [unique] u_202 = ri_202 <= qH0 suchthat defined(r_15[ri_202], x01[ri_202], x02[ri_202], x03[ri_202], x04[ri_202], x05[ri_202]) && (m_15: G <- x05[ri_202]; false) && (Yp[u_41] = x04[ri_202]) && (X = x03[ri_202]) && (S = x02[ri_202]) && (U = x01[ri_202]) then
              sk_u: hash0 <- r_15[u_202];
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_15[u_202]);
              return(r_2[u_17])
            else
              r_12 <-R hash0;
              sk_u: hash0 <- r_12;
              event acceptU(U, X, S, Ystar_u, r_2[u_17], r_12);
              return(r_2[u_17])
          else
 {860}      find [unique] u_189 = ri_189 <= qH0 suchthat defined(r_15[ri_189], x01[ri_189], x02[ri_189], x03[ri_189], x04[ri_189], x05[ri_189]) && (m_13: G <- x05[ri_189]; false) && (Yp[u_41] = x04[ri_189]) && (X = x03[ri_189]) && (S = x02[ri_189]) && (U = x01[ri_189]) then
              sk_u: hash0 <- r_15[u_189];
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_15[u_189]);
              return(r)
            else
              r_11 <-R hash0;
              sk_u: hash0 <- r_11;
              r <-R hash1;
              event acceptU(U, X, S, Ystar_u, r, r_11);
              return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- cst_G;
{1013}    find [unique]  suchthat defined(r[j], u_42[j]) && (iS = u_42[j]) then
          (
            if auth_s = r[j] then
{1030}      find [unique]  suchthat defined(r_9[j]) then
              sk_s: hash0 <- r_9[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
            orfind u_72 = ri_72 <= qH0 suchthat defined(r_15[ri_72], x01[ri_72], x02[ri_72], x03[ri_72], x04[ri_72], x05[ri_72]) && (m_17: G <- x05[ri_72]; false) && (Y = x04[ri_72]) && (X_s = x03[ri_72]) && (S = x02[ri_72]) && (U = x01[ri_72]) then
              sk_s: hash0 <- r_15[u_72];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_72])
            else
              r_13 <-R hash0;
              sk_s: hash0 <- r_13;
              event termS(U, X_s, S, md_O_enc, auth_s, r_13)
          )
          orfind u_13 = ri_13 <= qH1 suchthat defined(r_2[ri_13], x11[ri_13], x12[ri_13], x13[ri_13], x14[ri_13], x15[ri_13]) && (m_19: G <- x15[ri_13]; false) && (Y = x14[ri_13]) && (X_s = x13[ri_13]) && (S = x12[ri_13]) && (U = x11[ri_13]) then
          (
            if auth_s = r_2[u_13] then
            find [unique]  suchthat defined(r_10[j], u_42[j]) && (iS = u_42[j]) then
              sk_s: hash0 <- r_10[j];
              event termS(U, X_s, S, md_O_enc, auth_s, r_10[j])
            orfind u_85 = ri_85 <= qH0 suchthat defined(r_15[ri_85], x01[ri_85], x02[ri_85], x03[ri_85], x04[ri_85], x05[ri_85]) && (m_21: G <- x05[ri_85]; false) && (Y = x04[ri_85]) && (X_s = x03[ri_85]) && (S = x02[ri_85]) && (U = x01[ri_85]) then
              sk_s: hash0 <- r_15[u_85];
              event termS(U, X_s, S, md_O_enc, auth_s, r_15[u_85])
            else
              r_14 <-R hash0;
              sk_s: hash0 <- r_14;
              event termS(U, X_s, S, md_O_enc, auth_s, r_14)
          )
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp'(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp'(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp'(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
{1566}    find [unique] u_70 = ri_70 <= NU suchthat defined(r_4[ri_70], X[ri_70], x_3[ri_70]) && (m_22: G <- x05; false) && (x04 = exp'(g, x_3[ri_70])) && (x03 = X[ri_70]) && (x02 = S) && (x01 = U) then
            return(r_4[u_70])
          orfind u_69 = ri_69 <= NU suchthat defined(r_5[ri_69], X[ri_69], x_3[u_44[ri_69]]) && (m_23: G <- x05; false) && (x04 = exp'(g, x_3[u_44[ri_69]])) && (x03 = X[ri_69]) && (x02 = S) && (x01 = U) then
            return(r_5[u_69])
          orfind u_68 = ri_68 <= NU suchthat defined(r_6[ri_68], X[ri_68], x_3[u_44[ri_68]]) && (m_24: G <- x05; false) && (x04 = exp'(g, x_3[u_44[ri_68]])) && (x03 = X[ri_68]) && (x02 = S) && (x01 = U) then
            return(r_6[u_68])
          orfind u_67 = ri_67 <= NU suchthat defined(r_7[ri_67], X[ri_67], x_2[u_43[ri_67]]) && (m_25: G <- x05; false) && (x04 = exp'(g, x_2[u_43[ri_67]])) && (x03 = X[ri_67]) && (x02 = S) && (x01 = U) then
            return(r_7[u_67])
          orfind u_66 = ri_66 <= NU suchthat defined(r_8[ri_66], X[ri_66], x_2[u_43[ri_66]]) && (m_26: G <- x05; false) && (x04 = exp'(g, x_2[u_43[ri_66]])) && (x03 = X[ri_66]) && (x02 = S) && (x01 = U) then
            return(r_8[u_66])
          orfind u_65 = ri_65 <= NU suchthat defined(r_9[ri_65], X[ri_65], Y[u_42[ri_65]]) && (m_27: G <- x05; false) && (x04 = Y[u_42[ri_65]]) && (x03 = X[ri_65]) && (x02 = S) && (x01 = U) then
            return(r_9[u_65])
          orfind u_64 = ri_64 <= NU suchthat defined(r_10[ri_64], X[ri_64], Y[u_42[ri_64]]) && (m_28: G <- x05; false) && (x04 = Y[u_42[ri_64]]) && (x03 = X[ri_64]) && (x02 = S) && (x01 = U) then
            return(r_10[u_64])
          orfind u_63 = ri_63 <= NU suchthat defined(r_11[ri_63], X[ri_63], Yp[u_41[ri_63]]) && (m_29: G <- x05; false) && (x04 = Yp[u_41[ri_63]]) && (x03 = X[ri_63]) && (x02 = S) && (x01 = U) then
            return(r_11[u_63])
          orfind u_62 = ri_62 <= NU suchthat defined(r_12[ri_62], X[ri_62], Yp[u_41[ri_62]]) && (m_30: G <- x05; false) && (x04 = Yp[u_41[ri_62]]) && (x03 = X[ri_62]) && (x02 = S) && (x01 = U) then
            return(r_12[u_62])
          orfind u_61 = ri_61 <= NS suchthat defined(r_13[ri_61], X_s[ri_61], Y[ri_61]) && (m_32: G <- x05; false) && (x04 = Y[ri_61]) && (x03 = X_s[ri_61]) && (x02 = S) && (x01 = U) then
            return(r_13[u_61])
          orfind u_60 = ri_60 <= NS suchthat defined(r_14[ri_60], X_s[ri_60], Y[ri_60]) && (m_34: G <- x05; false) && (x04 = Y[ri_60]) && (x03 = X_s[ri_60]) && (x02 = S) && (x01 = U) then
            return(r_14[u_60])
          orfind u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
{2051}    find [unique] u_7 = ri_7 <= NU suchthat defined(K_u_1[ri_7], r[ri_7], X[ri_7], x_3[u_44[ri_7]]) && (m_35: G <- x15; false) && (x14 = exp'(g, x_3[u_44[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(K_u_2[ri_7], r[ri_7], X[ri_7], x_2[u_43[ri_7]]) && (m_36: G <- x15; false) && (x14 = exp'(g, x_2[u_43[ri_7]])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(K_u_3[ri_7], r[ri_7], X[ri_7], Y[u_42[ri_7]]) && (m_37: G <- x15; false) && (x14 = Y[u_42[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(K_u_4[ri_7], r[ri_7], X[ri_7], Yp[u_41[ri_7]]) && (m_38: G <- x15; false) && (x14 = Yp[u_41[ri_7]]) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_7 = ri_7 <= NU suchthat defined(r[ri_7], X[ri_7], x_3[ri_7]) && (m_39: G <- x15; false) && (x14 = exp'(g, x_3[ri_7])) && (x13 = X[ri_7]) && (x12 = S) && (x11 = U) then
            return(r[u_7])
          orfind u_6 = ri_6 <= NP suchthat defined(r_1[ri_6], Xp[ri_6], Yp[ri_6]) && (m_41: G <- x15; false) && (x14 = Yp[ri_6]) && (x13 = Xp[ri_6]) && (x12 = S) && (x11 = U) then
            return(r_1[u_6])
          orfind u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand
  - Expand if/find/let
    - Remove branch 6 in find at 2051
    - Remove branch 5 in find at 2051
    - Remove branch 4 in find at 2051
    - Remove branch 3 in find at 2051
    - Remove branch 2 in find at 2051
    - Remove branch 1 in find at 2051
    - Remove branch 11 in find at 1566
    - Remove branch 10 in find at 1566
    - Remove branch 9 in find at 1566
    - Remove branch 8 in find at 1566
    - Remove branch 7 in find at 1566
    - Remove branch 6 in find at 1566
    - Remove branch 5 in find at 1566
    - Remove branch 4 in find at 1566
    - Remove branch 3 in find at 1566
    - Remove branch 2 in find at 1566
    - Remove branch 1 in find at 1566
    - Remove branch 2 in find at 1013
    - Remove branch 2 in find at 1030
    - Remove branch 1 in find at 860
    - Find at 860 removed (else branch kept if any)
    - Remove branch 1 in find at 739
    - Find at 739 removed (else branch kept if any)
    - Replaced defined condition Yp[ri_41], md_O_enc_1[ri_41] with md_O_enc_1[ri_41] in find at 27
    - Remove branch 1 in find at 644
    - Find at 644 removed (else branch kept if any)
    - Remove branch 1 in find at 487
    - Find at 487 removed (else branch kept if any)
    - Replaced defined condition Y[ri_42], md_O_enc[ri_42] with md_O_enc[ri_42] in find at 27
    - Remove branch 1 in find at 390
    - Find at 390 removed (else branch kept if any)
    - Remove branch 1 in find at 265
    - Find at 265 removed (else branch kept if any)
    - Remove branch 1 in find at 162
    - Find at 162 removed (else branch kept if any)
    - Remove branch 1 in find at 37
    - Find at 37 removed (else branch kept if any)
yields

Game 52 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          K_u_1: G <- cst_G;
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_5);
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          K_u_2: G <- cst_G;
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_7);
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          K_u_3: G <- cst_G;
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_9);
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          K_u_4: G <- cst_G;
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_11);
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          K_s: G <- cst_G;
          if defined(r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          if defined(r_9[j]) then
            sk_s: hash0 <- r_9[j];
            event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
          else
            r_13 <-R hash0;
            sk_s: hash0 <- r_13;
            event termS(U, X_s, S, md_O_enc, auth_s, r_13)
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp'(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp'(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp'(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on K_s (definition removed, all usages removed)
  - Remove assignments on K_u_1 (definition removed, all usages removed)
  - Remove assignments on K_u_2 (definition removed, all usages removed)
  - Remove assignments on K_u_3 (definition removed, all usages removed)
  - Remove assignments on K_u_4 (definition removed, all usages removed)
yields

Game 53 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_5);
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_7);
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_9);
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_11);
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
 {225}    if defined(r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
 {242}    if defined(r_9[j]) then
            sk_s: hash0 <- r_9[j];
            event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
          else
            r_13 <-R hash0;
            sk_s: hash0 <- r_13;
            event termS(U, X_s, S, md_O_enc, auth_s, r_13)
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp'(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp'(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp'(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Remove else branch of find at 242
    - Replaced defined condition r_9[j] with an empty condition in find at 242
    - A single branch always succeeds in find at 242
    - Replaced defined condition r[j], u_42[j] with r_9[j], r[j], u_42[j] in find at 225
yields

Game 54 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_5);
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_7);
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_9);
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_11);
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j];
          event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = exp'(g, x_2[ri_28])) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(exp'(g, x_2[u_23]))
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          x_2 <-R Z;
          return(exp'(g, x_2))
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Proved inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s in game 54
Proved secrecy of sk_s in game 54
Proved secrecy of sk_u in game 54

Applying equivalence exp'_to_group(exp)
  - Equivalence exp'_to_group(exp) with variables: x_2 -> x_1
yields

Game 55 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_5);
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(x_2[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_7);
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_9);
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          event acceptU(U, X, S, Ystar_u, r, r_11);
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j];
          event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(X_1[ri_28], m[ri_28], kd[ri_28], x_2[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], x_2[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          x_2: Z <- cst_Z;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on x_2 (definition removed, all usages removed)
yields

Game 56 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
  {40}    event acceptU(U, X, S, Ystar_u, r, r_5);
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
  {78}    event acceptU(U, X, S, Ystar_u, r, r_7);
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
 {109}    event acceptU(U, X, S, Ystar_u, r, r_9);
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
 {140}    event acceptU(U, X, S, Ystar_u, r, r_11);
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
 {179}    event acceptU(U, X, S, Ystar_u, r, r_4);
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j];
 {248}    event termS(U, X_s, S, md_O_enc, auth_s, r_9[j])
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {337}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(X_1[ri_28], m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {444}  find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition X_1[ri_23], X_1[ri_23], kd[ri_23], m[ri_23] with X_1[ri_23], kd[ri_23], m[ri_23] in find at 444
    - Replaced defined condition X_1[ri_28], m[ri_28], kd[ri_28], X_1[ri_28] with m[ri_28], kd[ri_28], X_1[ri_28] in find at 337
    - Removed event at 248 (no longer used in queries)
    - Removed event at 179 (no longer used in queries)
    - Removed event at 140 (no longer used in queries)
    - Removed event at 109 (no longer used in queries)
    - Removed event at 78 (no longer used in queries)
    - Removed event at 40 (no longer used in queries)
yields

Game 57 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        yp <-R Z;
        Yp: G <- exp'(g, yp);
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence exp'_to_group(exp)
  - Equivalence exp'_to_group(exp) with variables: yp -> x_1
yields

Game 58 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        X_2 <-R G;
        Yp: G <- X_2;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], Yp[ri_26]) && (x_1 = Yp[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(Yp[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(Yp[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on Yp (definition removed, all usages removed)
yields

Game 59 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {246}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(X_2[ri_26], X_2[ri_26], md_O_enc_1[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {353}  find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition X_2[ri_21], X_2[ri_21], md_O_enc_1[ri_21] with X_2[ri_21], md_O_enc_1[ri_21] in find at 353
    - Replaced defined condition X_2[ri_26], X_2[ri_26], md_O_enc_1[ri_26] with md_O_enc_1[ri_26], X_2[ri_26] in find at 246
yields

Game 60 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        xp <-R Z;
        Xp: G <- exp'(g, xp);
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence exp'_to_group(exp)
  - Equivalence exp'_to_group(exp) with variables: xp -> x_1
yields

Game 61 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        Xp: G <- X_3;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, Xp, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on Xp (definition removed, all usages removed)
yields

Game 62 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        y <-R Z;
        Y: G <- exp'(g, y);
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence exp'_to_group(exp)
  - Equivalence exp'_to_group(exp) with variables: y -> x_1
yields

Game 63 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        Y: G <- X_4;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (Y = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], Y[ri_27]) && (x_1 = Y[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(Y[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(Y[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on Y (definition removed, all usages removed)
yields

Game 64 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {234}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(X_4[ri_27], X_4[ri_27], md_O_enc[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {341}  find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition X_4[ri_22], X_4[ri_22], md_O_enc[ri_22] with X_4[ri_22], md_O_enc[ri_22] in find at 341
    - Replaced defined condition X_4[ri_27], X_4[ri_27], md_O_enc[ri_27] with md_O_enc[ri_27], X_4[ri_27] in find at 234
yields

Game 65 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          x_3 <-R Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], x_3[ri_29]) && (x_1 = exp'(g, x_3[ri_29])) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(exp'(g, x_3[u_24]))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence exp'_to_group(exp)
  - Equivalence exp'_to_group(exp) with variables: x_3 -> x_1
yields

Game 66 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(x_3[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5 <-R G;
          x_3: Z <- cst_Z;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(X_5[ri_29], Ystar_u[ri_29], x_3[ri_29]) && (x_1 = X_5[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], x_3[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(X_5[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on x_3 (definition removed, all usages removed)
yields

Game 67 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5 <-R G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {234}  find [unique] u_29 = ri_29 <= NU suchthat defined(X_5[ri_29], Ystar_u[ri_29], X_5[ri_29]) && (x_1 = X_5[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {339}  find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(X_5[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition X_5[ri_24], X_5[ri_24], Ystar_u[ri_24] with X_5[ri_24], Ystar_u[ri_24] in find at 339
    - Replaced defined condition X_5[ri_29], Ystar_u[ri_29], X_5[ri_29] with Ystar_u[ri_29], X_5[ri_29] in find at 234
yields

Game 68 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        x <-R Z;
        X: G <- exp'(g, x);
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5 <-R G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], X_5[ri_29]) && (x_1 = X_5[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(X_5[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence exp'_to_group(exp)
  - Equivalence exp'_to_group(exp) with variables: x -> x_1
yields

Game 69 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        X: G <- X_6;
        return(U, X);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5 <-R G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X[j_1]) && (X[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], X_5[ri_29]) && (x_1 = X_5[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(X_5[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on X (definition removed, all usages removed)
yields

Game 70 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5 <-R G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
 {137}  find j = j_1 <= NU suchthat defined(X_6[j_1], X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], X_5[ri_29]) && (x_1 = X_5[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(X_5[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition X_6[j_1], X_6[j_1] with X_6[j_1] in find at 137
yields

Game 71 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5 <-R G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], X_5[ri_29]) && (x_1 = X_5[ri_29]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return(X_5[u_24])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence move_array(G) with X_5. [probability NU * qE / |G|]
  - Equivalence move_array(G) with variables: X_5 -> X_7.
yields

Game 72 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5: G <- cst_G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], X_5[ri_29]) && (X': G <- x_1; find [unique] u_215 = ri_215 <= qD suchthat defined(u_24[ri_215], Y_1[ri_215]) && (u_24[ri_215] = ri_29) then (X' = Y_1[u_215]) else false) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          return({363}(find [unique] u_214 = ri_214 <= qD suchthat defined(u_24, u_24[ri_214], Y_1[ri_214]) && (u_24[ri_214] = u_24) then Y_1[u_214] else Y_1 <-R G; Y_1))
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand
  - Expand if/find/let
    - Replaced defined condition u_24, u_24[ri_214], Y_1[ri_214] with u_24[ri_214], Y_1[ri_214] in find at 363
yields

Game 73 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(X_5[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          X_5: G <- cst_G;
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], X_5[ri_29]) && (X': G <- x_1; find [unique] u_215 = ri_215 <= qD suchthat defined(u_24[ri_215], Y_1[ri_215]) && (u_24[ri_215] = ri_29) then ((X' = Y_1[u_215]) && (ke = pw0)) else false) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU suchthat defined(X_5[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
          find [unique] u_214 = ri_214 <= qD suchthat defined(u_24[ri_214], Y_1[ri_214]) && (u_24[ri_214] = u_24) then
            return(Y_1[u_214])
          else
            Y_1 <-R G;
            return(Y_1)
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on X' (definition removed, all usages removed)
  - Remove assignments on X_5 (definition removed, all usages removed)
yields

Game 74 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {227}  find [unique] u_29 = ri_29 <= NU suchthat defined(Ystar_u[ri_29], r_4[ri_29]) && {230}(find [unique] u_215 = ri_215 <= qD suchthat defined(u_24[ri_215], Y_1[ri_215]) && (u_24[ri_215] = ri_29) then ((x_1 = Y_1[u_215]) && (ke = pw0)) else false) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {341}  find [unique] u_24 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
 {354}    find [unique] u_214 = ri_214 <= qD suchthat defined(u_24[ri_214], Y_1[ri_214]) && (u_24[ri_214] = u_24) then
            return(Y_1[u_214])
          else
            Y_1 <-R G;
            return(Y_1)
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Simplified find at 354 in branch of find at 341
    - Simplified find at 230 in condition of find at 227
yields

Game 75 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {227}  find [unique] u_29 = ri_29 <= NU, u_216 = ri_215 <= qD suchthat defined(Ystar_u[ri_29], r_4[ri_29], u_24[ri_215], Y_1[ri_215]) && (u_24[ri_215] = ri_29) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          return(Ystar_u[u_29])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {338}  find [unique] u_24 = ri_24 <= NU, u_214 = ri_214 <= qD suchthat defined(r_4[ri_24], Ystar_u[ri_24], Y_1[ri_214]) && {342}((m = Ystar_u[ri_24]) && (kd = pw0) && (ri_24 = ri_24) && (ri_214 = iD)) then
          return(Y_1[u_214])
        orfind u_24 = ri_24 <= NU, u_214 = ri_214 <= qD suchthat defined(r_4[ri_24], Ystar_u[ri_24], u_24[ri_214], Y_1[ri_214]) && (m = Ystar_u[ri_24]) && (kd = pw0) && (u_24[ri_214] = ri_24) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_24 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((m = Ystar_u[ri_24]) && (kd = pw0) && (ri_24 = ri_24) && (ri_214 = iD)) with false at 342
    - Remove branch 1 in find at 338
    - In branch 1 of find at 227, substituting u_29 with u_24[u_216]
    - Replaced defined condition Ystar_u[ri_29], r_4[ri_29], u_24[ri_215], Y_1[ri_215] with Ystar_u[u_24[ri_215]], Y_1[ri_215] in find at 227
yields

Game 76 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(Ystar_u[u_24[ri_215]], Y_1[ri_215]) && {231}((u_24[ri_215] = u_24[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0)) then
          u_29 <= NU <- u_24[u_216];
          return(Ystar_u[u_24[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU, u_214 = ri_214 <= qD suchthat defined(r_4[ri_24], Ystar_u[ri_24], u_24[ri_214], Y_1[ri_214]) && (m = Ystar_u[ri_24]) && (kd = pw0) && (u_24[ri_214] = ri_24) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_24 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((u_24[ri_215] = u_24[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0)) with ((x_1 = Y_1[ri_215]) && (ke = pw0)) at 231
yields

Game 77 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(Ystar_u[u_24[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          u_29 <= NU <- u_24[u_216];
          return(Ystar_u[u_24[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_24 = ri_24 <= NU, u_214 = ri_214 <= qD suchthat defined(r_4[ri_24], Ystar_u[ri_24], u_24[ri_214], Y_1[ri_214]) && (m = Ystar_u[ri_24]) && (kd = pw0) && (u_24[ri_214] = ri_24) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_24 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying SA rename u_24
  - Rename variable u_24 into u_218, u_217
yields

Game 78 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(u_218[ri_215], Ystar_u[u_218[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          u_29 <= NU <- u_218[u_216];
          return(Ystar_u[u_218[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_217 = ri_24 <= NU, u_214 = ri_214 <= qD suchthat defined(r_4[ri_24], Ystar_u[ri_24], u_218[ri_214], Y_1[ri_214]) && (m = Ystar_u[ri_24]) && (kd = pw0) && (u_218[ri_214] = ri_24) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_29 (definition removed, all usages removed)
yields

Game 79 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {227}  find [unique] u_216 = ri_215 <= qD suchthat defined(u_218[ri_215], Ystar_u[u_218[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          return(Ystar_u[u_218[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {334}  find [unique] u_217 = ri_24 <= NU, u_214 = ri_214 <= qD suchthat defined(r_4[ri_24], Ystar_u[ri_24], u_218[ri_214], Y_1[ri_214]) && (m = Ystar_u[ri_24]) && (kd = pw0) && (u_218[ri_214] = ri_24) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - In branch 1 of find at 334, substituting u_217 with u_218[u_214]
    - Replaced defined condition r_4[ri_24], Ystar_u[ri_24], u_218[ri_214], Y_1[ri_214] with Y_1[ri_214], Ystar_u[u_218[ri_214]] in find at 334
    - Replaced defined condition u_218[ri_215], Ystar_u[u_218[ri_215]], Y_1[ri_215] with Ystar_u[u_218[ri_215]], Y_1[ri_215] in find at 227
yields

Game 80 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(Ystar_u[u_218[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          return(Ystar_u[u_218[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_214 = ri_214 <= qD suchthat defined(Y_1[ri_214], Ystar_u[u_218[ri_214]]) && {337}((m = Ystar_u[u_218[ri_214]]) && (kd = pw0) && (u_218[ri_214] = u_218[ri_214])) then
          u_217 <= NU <- u_218[u_214];
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((m = Ystar_u[u_218[ri_214]]) && (kd = pw0) && (u_218[ri_214] = u_218[ri_214])) with ((m = Ystar_u[u_218[ri_214]]) && (kd = pw0)) at 337
yields

Game 81 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(Ystar_u[u_218[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          return(Ystar_u[u_218[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_214 = ri_214 <= qD suchthat defined(Y_1[ri_214], Ystar_u[u_218[ri_214]]) && (m = Ystar_u[u_218[ri_214]]) && (kd = pw0) then
          u_217 <= NU <- u_218[u_214];
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_217 (definition removed, all usages removed)
yields

Game 82 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r <-R hash1;
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(Ystar_u[u_218[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          return(Ystar_u[u_218[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_214 = ri_214 <= qD suchthat defined(Y_1[ri_214], Ystar_u[u_218[ri_214]]) && (m = Ystar_u[u_218[ri_214]]) && (kd = pw0) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying move binder r
  - Move random number generation r
  - Move random number generation r
  - Move random number generation r
  - Move random number generation r
  - Move random number generation r
yields

Game 83 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
          r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        orfind u_43 = ri_43 <= qD suchthat defined(X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
          r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
          r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_216 = ri_215 <= qD suchthat defined(Ystar_u[u_218[ri_215]], Y_1[ri_215]) && (x_1 = Y_1[ri_215]) && (ke = pw0) then
          return(Ystar_u[u_218[u_216]])
        orfind u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_214 = ri_214 <= qD suchthat defined(Y_1[ri_214], Ystar_u[u_218[ri_214]]) && (m = Ystar_u[u_218[ri_214]]) && (kd = pw0) then
          return(Y_1[u_214])
        orfind u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            Y_1 <-R G;
            return(Y_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying merge variables (X_1, Y_1)
yields

Game 84 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
  {22}  find [unique] u_43 = ri_43 <= qD suchthat defined(X_7[ri_43], X_1[ri_43], kd[ri_43], m[ri_43]) && (Ystar_u = m[ri_43]) && (pw0 = kd[ri_43]) then
  {37}    r_7 <-R hash0;
          sk_u: hash0 <- r_7;
          r <-R hash1;
          return(r)
        orfind u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_41 = ri_41 <= NP suchthat defined(md_O_enc_1[ri_41]) && (Ystar_u = md_O_enc_1[ri_41]) then
  {67}    r_11 <-R hash0;
          sk_u: hash0 <- r_11;
          r <-R hash1;
          return(r)
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        orfind u_44 = ri_44 <= NU suchthat defined(r_4[ri_44], Ystar_u[ri_44]) && (Ystar_u = Ystar_u[ri_44]) then
 {102}    r_5 <-R hash0;
          sk_u: hash0 <- r_5;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
 {391}    find [unique] u_218 = ri_24 <= NU suchthat defined(r_4[ri_24], Ystar_u[ri_24]) && (m = Ystar_u[ri_24]) && (kd = pw0) then
            X_1 <-R G;
            Y_2: G <- cst_G;
            return(X_1)
          else
            X_1 <-R G;
            X_7: G <- cst_G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying merge branches
  - Merge branch(es) at 37 with else branch of find at 22
  - Merge branch(es) at 67 with else branch of find at 22
  - Merge branch(es) at 102 with else branch of find at 22
  - Merge all branches of find at 391
yields

Game 85 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26], X_2[ri_26]) && (x_1 = X_2[ri_26]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP suchthat defined(X_2[ri_21], md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return(X_2[u_21])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          X_1 <-R G;
          X_7: G <- cst_G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence move_array(G) with X_2. [probability NP * qE / |G|]
  - Equivalence move_array(G) with variables: X_2 -> X_8.
yields

Game 86 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2: G <- cst_G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26]) && (X'_1: G <- x_1; find [unique] u_220 = ri_217 <= qD suchthat defined(u_21[ri_217], Y_3[ri_217]) && (u_21[ri_217] = ri_26) then (X'_1 = Y_3[u_220]) else false) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          return({323}(find [unique] u_219 = ri_216 <= qD suchthat defined(u_21, u_21[ri_216], Y_3[ri_216]) && (u_21[ri_216] = u_21) then Y_3[u_219] else Y_3 <-R G; Y_3))
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          X_1 <-R G;
          X_7: G <- cst_G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand
  - Expand if/find/let
    - Replaced defined condition u_21, u_21[ri_216], Y_3[ri_216] with u_21[ri_216], Y_3[ri_216] in find at 323
yields

Game 87 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        X_2: G <- cst_G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26]) && (X'_1: G <- x_1; find [unique] u_220 = ri_217 <= qD suchthat defined(u_21[ri_217], Y_3[ri_217]) && (u_21[ri_217] = ri_26) then ((X'_1 = Y_3[u_220]) && (ke = pw0)) else false) then
          return(md_O_enc_1[u_26])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
          find [unique] u_219 = ri_216 <= qD suchthat defined(u_21[ri_216], Y_3[ri_216]) && (u_21[ri_216] = u_21) then
            return(Y_3[u_219])
          else
            Y_3 <-R G;
            return(Y_3)
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          X_1 <-R G;
          X_7: G <- cst_G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on X_7 (definition removed, all usages removed)
  - Remove assignments on X'_1 (definition removed, all usages removed)
  - Remove assignments on X_2 (definition removed, all usages removed)
yields

Game 88 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {167}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_26 = ri_26 <= NP suchthat defined(md_O_enc_1[ri_26]) && {209}(find [unique] u_220 = ri_217 <= qD suchthat defined(u_21[ri_217], Y_3[ri_217]) && (u_21[ri_217] = ri_26) then ((x_1 = Y_3[u_220]) && (ke = pw0)) else false) then
          return(md_O_enc_1[u_26])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {262}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
 {314}    find [unique] u_219 = ri_216 <= qD suchthat defined(u_21[ri_216], Y_3[ri_216]) && (u_21[ri_216] = u_21) then
            return(Y_3[u_219])
          else
            Y_3 <-R G;
            return(Y_3)
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Simplified find at 314 in branch of find at 262
    - Simplified find at 209 in condition of find at 167
yields

Game 89 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {167}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_26 = ri_26 <= NP, u_221 = ri_217 <= qD suchthat defined(md_O_enc_1[ri_26], u_21[ri_217], Y_3[ri_217]) && (u_21[ri_217] = ri_26) && (x_1 = Y_3[ri_217]) && (ke = pw0) then
          return(md_O_enc_1[u_26])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {259}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP, u_219 = ri_216 <= qD suchthat defined(md_O_enc_1[ri_21], Y_3[ri_216]) && {302}((m = md_O_enc_1[ri_21]) && (kd = pw0) && (ri_21 = ri_21) && (ri_216 = iD)) then
          return(Y_3[u_219])
        orfind u_21 = ri_21 <= NP, u_219 = ri_216 <= qD suchthat defined(md_O_enc_1[ri_21], u_21[ri_216], Y_3[ri_216]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) && (u_21[ri_216] = ri_21) then
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_21 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability 0.5 * NP * NP / |G|]
  - Simplification pass
    - Replaced ((m = md_O_enc_1[ri_21]) && (kd = pw0) && (ri_21 = ri_21) && (ri_216 = iD)) with false at 302
    - Remove branch 3 in find at 259
    - In branch 3 of find at 167, substituting u_26 with u_21[u_221]
    - Replaced defined condition md_O_enc_1[ri_26], u_21[ri_217], Y_3[ri_217] with md_O_enc_1[u_21[ri_217]], Y_3[ri_217] in find at 167
yields

Game 90 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_221 = ri_217 <= qD suchthat defined(md_O_enc_1[u_21[ri_217]], Y_3[ri_217]) && {211}((u_21[ri_217] = u_21[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0)) then
          u_26 <= NP <- u_21[u_221];
          return(md_O_enc_1[u_21[u_221]])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP, u_219 = ri_216 <= qD suchthat defined(md_O_enc_1[ri_21], u_21[ri_216], Y_3[ri_216]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) && (u_21[ri_216] = ri_21) then
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_21 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((u_21[ri_217] = u_21[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0)) with ((x_1 = Y_3[ri_217]) && (ke = pw0)) at 211
yields

Game 91 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_221 = ri_217 <= qD suchthat defined(md_O_enc_1[u_21[ri_217]], Y_3[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0) then
          u_26 <= NP <- u_21[u_221];
          return(md_O_enc_1[u_21[u_221]])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_21 = ri_21 <= NP, u_219 = ri_216 <= qD suchthat defined(md_O_enc_1[ri_21], u_21[ri_216], Y_3[ri_216]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) && (u_21[ri_216] = ri_21) then
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_21 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying SA rename u_21
  - Rename variable u_21 into u_223, u_222
yields

Game 92 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_221 = ri_217 <= qD suchthat defined(u_223[ri_217], md_O_enc_1[u_223[ri_217]], Y_3[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0) then
          u_26 <= NP <- u_223[u_221];
          return(md_O_enc_1[u_223[u_221]])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_222 = ri_21 <= NP, u_219 = ri_216 <= qD suchthat defined(md_O_enc_1[ri_21], u_223[ri_216], Y_3[ri_216]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) && (u_223[ri_216] = ri_21) then
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_223 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_26 (definition removed, all usages removed)
yields

Game 93 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {167}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_221 = ri_217 <= qD suchthat defined(u_223[ri_217], md_O_enc_1[u_223[ri_217]], Y_3[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0) then
          return(md_O_enc_1[u_223[u_221]])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {256}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_222 = ri_21 <= NP, u_219 = ri_216 <= qD suchthat defined(md_O_enc_1[ri_21], u_223[ri_216], Y_3[ri_216]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) && (u_223[ri_216] = ri_21) then
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_223 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - In branch 3 of find at 256, substituting u_222 with u_223[u_219]
    - Replaced defined condition md_O_enc_1[ri_21], u_223[ri_216], Y_3[ri_216] with Y_3[ri_216], md_O_enc_1[u_223[ri_216]] in find at 256
    - Replaced defined condition u_223[ri_217], md_O_enc_1[u_223[ri_217]], Y_3[ri_217] with md_O_enc_1[u_223[ri_217]], Y_3[ri_217] in find at 167
yields

Game 94 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_221 = ri_217 <= qD suchthat defined(md_O_enc_1[u_223[ri_217]], Y_3[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0) then
          return(md_O_enc_1[u_223[u_221]])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_219 = ri_216 <= qD suchthat defined(Y_3[ri_216], md_O_enc_1[u_223[ri_216]]) && {299}((m = md_O_enc_1[u_223[ri_216]]) && (kd = pw0) && (u_223[ri_216] = u_223[ri_216])) then
          u_222 <= NP <- u_223[u_219];
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_223 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((m = md_O_enc_1[u_223[ri_216]]) && (kd = pw0) && (u_223[ri_216] = u_223[ri_216])) with ((m = md_O_enc_1[u_223[ri_216]]) && (kd = pw0)) at 299
yields

Game 95 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_221 = ri_217 <= qD suchthat defined(md_O_enc_1[u_223[ri_217]], Y_3[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0) then
          return(md_O_enc_1[u_223[u_221]])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_219 = ri_216 <= qD suchthat defined(Y_3[ri_216], md_O_enc_1[u_223[ri_216]]) && (m = md_O_enc_1[u_223[ri_216]]) && (kd = pw0) then
          u_222 <= NP <- u_223[u_219];
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_223 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_222 (definition removed, all usages removed)
yields

Game 96 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        orfind u_221 = ri_217 <= qD suchthat defined(md_O_enc_1[u_223[ri_217]], Y_3[ri_217]) && (x_1 = Y_3[ri_217]) && (ke = pw0) then
          return(md_O_enc_1[u_223[u_221]])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        orfind u_219 = ri_216 <= qD suchthat defined(Y_3[ri_216], md_O_enc_1[u_223[ri_216]]) && (m = md_O_enc_1[u_223[ri_216]]) && (kd = pw0) then
          return(Y_3[u_219])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        else
          find [unique] u_223 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            Y_3 <-R G;
            return(Y_3)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying merge variables (X_1, Y_3) (no branch variables)
yields

Game 97 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
 {294}    find [unique] u_223 = ri_21 <= NP suchthat defined(md_O_enc_1[ri_21]) && (m = md_O_enc_1[ri_21]) && (kd = pw0) then
            X_1 <-R G;
            return(X_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying merge branches
  - Merge all branches of find at 294
yields

Game 98 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4 <-R G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X_4 = x14[jh_1]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27], X_4[ri_27]) && (x_1 = X_4[ri_27]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(X_4[ri_22], md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return(X_4[u_22])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying equivalence move_array(G) with X_4. [probability (NS + NS * qE) / |G| + 0.5 * qH1 * qH1 / |hash1|]
  - Equivalence move_array(G) with variables: X_4 -> X_8.
yields

Game 99 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4: G <- cst_G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X'_2: G <- x14[jh_1]; find [unique] u_226 = ri_220 <= qD suchthat defined(u_22[ri_220], Y_4[ri_220]) && (u_22[ri_220] = iS) then (X'_2 = Y_4[u_226]) else false) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27]) && (X'_3: G <- x_1; find [unique] u_225 = ri_219 <= qD suchthat defined(u_22[ri_219], Y_4[ri_219]) && (u_22[ri_219] = ri_27) then (X'_3 = Y_4[u_225]) else false) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          return({298}(find [unique] u_224 = ri_218 <= qD suchthat defined(u_22, u_22[ri_218], Y_4[ri_218]) && (u_22[ri_218] = u_22) then Y_4[u_224] else Y_4 <-R G; Y_4))
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying expand
  - Expand if/find/let
    - Replaced defined condition u_22, u_22[ri_218], Y_4[ri_218] with u_22[ri_218], Y_4[ri_218] in find at 298
yields

Game 100 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        X_4: G <- cst_G;
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && (X'_2: G <- x14[jh_1]; find [unique] u_226 = ri_220 <= qD suchthat defined(u_22[ri_220], Y_4[ri_220]) && (u_22[ri_220] = iS) then ((U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (X'_2 = Y_4[u_226]) && (auth_s = r_2[jh_1])) else false) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27]) && (X'_3: G <- x_1; find [unique] u_225 = ri_219 <= qD suchthat defined(u_22[ri_219], Y_4[ri_219]) && (u_22[ri_219] = ri_27) then ((X'_3 = Y_4[u_225]) && (ke = pw0)) else false) then
          return(md_O_enc[u_27])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
          find [unique] u_224 = ri_218 <= qD suchthat defined(u_22[ri_218], Y_4[ri_218]) && (u_22[ri_218] = u_22) then
            return(Y_4[u_224])
          else
            Y_4 <-R G;
            return(Y_4)
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on X'_3 (definition removed, all usages removed)
  - Remove assignments on X_4 (definition removed, all usages removed)
  - Remove assignments on X'_2 (definition removed, all usages removed)
yields

Game 101 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
 {110}    find jh = jh_1 <= qH1 suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1]) && {116}(find [unique] u_226 = ri_220 <= qD suchthat defined(u_22[ri_220], Y_4[ri_220]) && (u_22[ri_220] = iS) then ((U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[u_226]) && (auth_s = r_2[jh_1])) else false) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {176}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS suchthat defined(md_O_enc[ri_27]) && {198}(find [unique] u_225 = ri_219 <= qD suchthat defined(u_22[ri_219], Y_4[ri_219]) && (u_22[ri_219] = ri_27) then ((x_1 = Y_4[u_225]) && (ke = pw0)) else false) then
          return(md_O_enc[u_27])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {253}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
 {285}    find [unique] u_224 = ri_218 <= qD suchthat defined(u_22[ri_218], Y_4[ri_218]) && (u_22[ri_218] = u_22) then
            return(Y_4[u_224])
          else
            Y_4 <-R G;
            return(Y_4)
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Simplified find at 285 in branch of find at 253
    - Simplified find at 198 in condition of find at 176
    - Simplified find at 116 in condition of find at 110
yields

Game 102 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_22[ri_220], Y_4[ri_220]) && (u_22[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {173}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_27 = ri_27 <= NS, u_227 = ri_219 <= qD suchthat defined(md_O_enc[ri_27], u_22[ri_219], Y_4[ri_219]) && (u_22[ri_219] = ri_27) && (x_1 = Y_4[ri_219]) && (ke = pw0) then
          return(md_O_enc[u_27])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {247}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS, u_224 = ri_218 <= qD suchthat defined(md_O_enc[ri_22], Y_4[ri_218]) && {270}((m = md_O_enc[ri_22]) && (kd = pw0) && (ri_22 = ri_22) && (ri_218 = iD)) then
          return(Y_4[u_224])
        orfind u_22 = ri_22 <= NS, u_224 = ri_218 <= qD suchthat defined(md_O_enc[ri_22], u_22[ri_218], Y_4[ri_218]) && (m = md_O_enc[ri_22]) && (kd = pw0) && (u_22[ri_218] = ri_22) then
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_22 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify [probability 0.5 * NS * NS / |G|]
  - Simplification pass
    - Replaced ((m = md_O_enc[ri_22]) && (kd = pw0) && (ri_22 = ri_22) && (ri_218 = iD)) with false at 270
    - Remove branch 2 in find at 247
    - In branch 2 of find at 173, substituting u_27 with u_22[u_227]
    - Replaced defined condition md_O_enc[ri_27], u_22[ri_219], Y_4[ri_219] with md_O_enc[u_22[ri_219]], Y_4[ri_219] in find at 173
yields

Game 103 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_22[ri_220], Y_4[ri_220]) && (u_22[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_227 = ri_219 <= qD suchthat defined(md_O_enc[u_22[ri_219]], Y_4[ri_219]) && {197}((u_22[ri_219] = u_22[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0)) then
          u_27 <= NS <- u_22[u_227];
          return(md_O_enc[u_22[u_227]])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS, u_224 = ri_218 <= qD suchthat defined(md_O_enc[ri_22], u_22[ri_218], Y_4[ri_218]) && (m = md_O_enc[ri_22]) && (kd = pw0) && (u_22[ri_218] = ri_22) then
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_22 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((u_22[ri_219] = u_22[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0)) with ((x_1 = Y_4[ri_219]) && (ke = pw0)) at 197
yields

Game 104 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_22[ri_220], Y_4[ri_220]) && (u_22[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_227 = ri_219 <= qD suchthat defined(md_O_enc[u_22[ri_219]], Y_4[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0) then
          u_27 <= NS <- u_22[u_227];
          return(md_O_enc[u_22[u_227]])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_22 = ri_22 <= NS, u_224 = ri_218 <= qD suchthat defined(md_O_enc[ri_22], u_22[ri_218], Y_4[ri_218]) && (m = md_O_enc[ri_22]) && (kd = pw0) && (u_22[ri_218] = ri_22) then
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_22 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying SA rename u_22
  - Rename variable u_22 into u_230, u_229
yields

Game 105 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], Y_4[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_227 = ri_219 <= qD suchthat defined(u_230[ri_219], md_O_enc[u_230[ri_219]], Y_4[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0) then
          u_27 <= NS <- u_230[u_227];
          return(md_O_enc[u_230[u_227]])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_229 = ri_22 <= NS, u_224 = ri_218 <= qD suchthat defined(md_O_enc[ri_22], u_230[ri_218], Y_4[ri_218]) && (m = md_O_enc[ri_22]) && (kd = pw0) && (u_230[ri_218] = ri_22) then
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_27 (definition removed, all usages removed)
yields

Game 106 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], Y_4[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
 {173}  find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_227 = ri_219 <= qD suchthat defined(u_230[ri_219], md_O_enc[u_230[ri_219]], Y_4[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0) then
          return(md_O_enc[u_230[u_227]])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
 {244}  find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_229 = ri_22 <= NS, u_224 = ri_218 <= qD suchthat defined(md_O_enc[ri_22], u_230[ri_218], Y_4[ri_218]) && (m = md_O_enc[ri_22]) && (kd = pw0) && (u_230[ri_218] = ri_22) then
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - In branch 2 of find at 244, substituting u_229 with u_230[u_224]
    - Replaced defined condition md_O_enc[ri_22], u_230[ri_218], Y_4[ri_218] with Y_4[ri_218], md_O_enc[u_230[ri_218]] in find at 244
    - Replaced defined condition u_230[ri_219], md_O_enc[u_230[ri_219]], Y_4[ri_219] with md_O_enc[u_230[ri_219]], Y_4[ri_219] in find at 173
yields

Game 107 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], Y_4[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_227 = ri_219 <= qD suchthat defined(md_O_enc[u_230[ri_219]], Y_4[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0) then
          return(md_O_enc[u_230[u_227]])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_224 = ri_218 <= qD suchthat defined(Y_4[ri_218], md_O_enc[u_230[ri_218]]) && {267}((m = md_O_enc[u_230[ri_218]]) && (kd = pw0) && (u_230[ri_218] = u_230[ri_218])) then
          u_229 <= NS <- u_230[u_224];
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((m = md_O_enc[u_230[ri_218]]) && (kd = pw0) && (u_230[ri_218] = u_230[ri_218])) with ((m = md_O_enc[u_230[ri_218]]) && (kd = pw0)) at 267
yields

Game 108 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], Y_4[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_227 = ri_219 <= qD suchthat defined(md_O_enc[u_230[ri_219]], Y_4[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0) then
          return(md_O_enc[u_230[u_227]])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_224 = ri_218 <= qD suchthat defined(Y_4[ri_218], md_O_enc[u_230[ri_218]]) && (m = md_O_enc[u_230[ri_218]]) && (kd = pw0) then
          u_229 <= NS <- u_230[u_224];
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_229 (definition removed, all usages removed)
yields

Game 109 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], Y_4[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = Y_4[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_227 = ri_219 <= qD suchthat defined(md_O_enc[u_230[ri_219]], Y_4[ri_219]) && (x_1 = Y_4[ri_219]) && (ke = pw0) then
          return(md_O_enc[u_230[u_227]])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_224 = ri_218 <= qD suchthat defined(Y_4[ri_218], md_O_enc[u_230[ri_218]]) && (m = md_O_enc[u_230[ri_218]]) && (kd = pw0) then
          return(Y_4[u_224])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            Y_4 <-R G;
            return(Y_4)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying merge variables (X_1, Y_4) (no branch variables)
yields

Game 110 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
 {110}    find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], X_1[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = X_1[ri_220]) && (auth_s = r_2[jh_1]) then
          event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            X_1 <-R G;
            return(X_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying insert instruction find jh' <= qH1, jd <= qD suchthat defined(x11[jh'], x12[jh'], x13[jh'], x14[jh'], r_2[jh'], m[jd], kd[jd], X_1[jd]) && (m[jd] = md_O_enc) && (U = x11[jh']) && (S = x12[jh']) && (X_s = x13[jh']) && (x14[jh'] = X_1[jd]) && (auth_s = r_2[jh'])  && (kd[jd] = pw0) then at occurrence 110
yields

Game 111 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh' = jh'_1 <= qH1, jd = jd_1 <= qD suchthat defined(x11[jh'_1], x12[jh'_1], x13[jh'_1], x14[jh'_1], r_2[jh'_1], m[jd_1], kd[jd_1], X_1[jd_1]) && (m[jd_1] = md_O_enc) && (U = x11[jh'_1]) && (S = x12[jh'_1]) && (X_s = x13[jh'_1]) && (x14[jh'_1] = X_1[jd_1]) && (auth_s = r_2[jh'_1]) && (kd[jd_1] = pw0) then
          (
 {157}      find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], X_1[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = X_1[ri_220]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
          )
          else
            find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], X_1[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = X_1[ri_220]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            X_1 <-R G;
            return(X_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying insert event Auth2 at occurrence 157 [probability Pr[event Auth2 in game 112 with public variables sk_s, sk_u]]
yields

Game 112 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh' = jh'_1 <= qH1, jd = jd_1 <= qD suchthat defined(x11[jh'_1], x12[jh'_1], x13[jh'_1], x14[jh'_1], r_2[jh'_1], m[jd_1], kd[jd_1], X_1[jd_1]) && (m[jd_1] = md_O_enc) && (U = x11[jh'_1]) && (S = x12[jh'_1]) && (X_s = x13[jh'_1]) && (x14[jh'_1] = X_1[jd_1]) && (auth_s = r_2[jh'_1]) && (kd[jd_1] = pw0) then
            event_abort Auth2
          else
 {158}      find jh = jh_1 <= qH1, u_228 = ri_220 <= qD suchthat defined(x11[jh_1], x12[jh_1], x13[jh_1], x14[jh_1], r_2[jh_1], u_230[ri_220], X_1[ri_220]) && (u_230[ri_220] = iS) && (U = x11[jh_1]) && (S = x12[jh_1]) && (X_s = x13[jh_1]) && (x14[jh_1] = X_1[ri_220]) && (auth_s = r_2[jh_1]) then
            event_abort Auth
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            X_1 <-R G;
            return(X_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify
  - Simplification pass
    - Remove branch 1 in find at 158
    - Find at 158 removed (else branch kept if any)
yields

Game 113 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh' = jh'_1 <= qH1, jd = jd_1 <= qD suchthat defined(x11[jh'_1], x12[jh'_1], x13[jh'_1], x14[jh'_1], r_2[jh'_1], m[jd_1], kd[jd_1], X_1[jd_1]) && (m[jd_1] = md_O_enc) && (U = x11[jh'_1]) && (S = x12[jh'_1]) && (X_s = x13[jh'_1]) && (x14[jh'_1] = X_1[jd_1]) && (auth_s = r_2[jh'_1]) && (kd[jd_1] = pw0) then
          event_abort Auth2
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
 {271}    find [unique] u_230 = ri_22 <= NS suchthat defined(md_O_enc[ri_22]) && (m = md_O_enc[ri_22]) && (kd = pw0) then
            X_1 <-R G;
            return(X_1)
          else
            X_1 <-R G;
            return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying merge branches
  - Merge all branches of find at 271
yields

Game 114 is
      Ostart() :=
      pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_40 = ri_40 <= qE suchthat defined(ke[ri_40], md_O_enc_2[ri_40]) && (Ystar_u = md_O_enc_2[ri_40]) && (pw0 = ke[ri_40]) then
          event_abort Encrypt
        orfind u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
          find jh' = jh'_1 <= qH1, jd = jd_1 <= qD suchthat defined(x11[jh'_1], x12[jh'_1], x13[jh'_1], x14[jh'_1], r_2[jh'_1], m[jd_1], kd[jd_1], X_1[jd_1]) && (m[jd_1] = md_O_enc) && (U = x11[jh'_1]) && (S = x12[jh'_1]) && (X_s = x13[jh'_1]) && (x14[jh'_1] = X_1[jd_1]) && (auth_s = r_2[jh'_1]) && (kd[jd_1] = pw0) then
          event_abort Auth2
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify with collision elimination at variables: pw0 [probability (0.5 * qD * qD + 0.5 * qE * qE) / |G| + 0.5 * qH1 * qH1 / |hash1| + (NS + NU) / |passwd|]
  - Global dependency analysis on pw0
yields

Game 115 is
      Ostart() :=
   {2}pw0 <-R passwd;
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        (
          if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
          if auth_s = r[j] then
          sk_s: hash0 <- r_9[j]
        )
        else
  {97}    find 
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Applying simplify with collision elimination at variables: pw0
  - Simplification pass
    - Find at 97 removed (else branch kept if any)
    - Remove random number generation at 2
yields

Game 116 is
      Ostart() :=
      return();
      ((
        foreach iU <= NU do
        OC1() :=
        X_6 <-R G;
        return(U, X_6);
        OC2(=S, Ystar_u: G) :=
        find [unique] u_42 = ri_42 <= NS suchthat defined(md_O_enc[ri_42]) && (Ystar_u = md_O_enc[ri_42]) then
          r_9 <-R hash0;
          sk_u: hash0 <- r_9;
          r <-R hash1;
          return(r)
        else
          r_4 <-R hash0;
          sk_u: hash0 <- r_4;
          r <-R hash1;
          return(r)
      ) | (
        foreach iS <= NS do
        OS1(=U, X_s: G) :=
        md_O_enc <-R G;
        return(S, md_O_enc);
        OS2(auth_s: hash1) :=
        find j = j_1 <= NU suchthat defined(X_6[j_1]) && (X_6[j_1] = X_s) then
        if defined(r_9[j], r[j], u_42[j]) && (iS = u_42[j]) then
        if auth_s = r[j] then
        sk_s: hash0 <- r_9[j]
      ) | (
        foreach iP <= NP do
        OP() :=
        X_3 <-R G;
        md_O_enc_1 <-R G;
        r_1 <-R hash1;
        return(U, X_3, S, md_O_enc_1, r_1)
      ) | (
        foreach iE <= qE do
        Oenc(x_1: G, ke: passwd) :=
        find [unique] u_28 = ri_28 <= qD suchthat defined(m[ri_28], kd[ri_28], X_1[ri_28]) && (x_1 = X_1[ri_28]) && (ke = kd[ri_28]) then
          return(m[u_28])
        orfind u_25 = ri_25 <= qE suchthat defined(md_O_enc_2[ri_25], ke[ri_25], x_1[ri_25]) && (x_1 = x_1[ri_25]) && (ke = ke[ri_25]) then
          return(md_O_enc_2[u_25])
        else
          md_O_enc_2 <-R G;
          return(md_O_enc_2)
      ) | (
        foreach iD <= qD do
        Odec(m: G, kd: passwd) :=
        find [unique] u_23 = ri_23 <= qD suchthat defined(X_1[ri_23], kd[ri_23], m[ri_23]) && (m = m[ri_23]) && (kd = kd[ri_23]) then
          return(X_1[u_23])
        orfind u_20 = ri_20 <= qE suchthat defined(x_1[ri_20], ke[ri_20], md_O_enc_2[ri_20]) && (m = md_O_enc_2[ri_20]) && (kd = ke[ri_20]) then
          return(x_1[u_20])
        else
          X_1 <-R G;
          return(X_1)
      ) | (
        foreach iH <= qH0 do
        OH(x1: bitstring) :=
        let concat(x01: host, x02: host, x03: G, x04: G, x05: G) = x1 in
          find [unique] u_59 = ri_59 <= qH0 suchthat defined(r_15[ri_59], x01[ri_59], x02[ri_59], x03[ri_59], x04[ri_59], x05[ri_59]) && (x05 = x05[ri_59]) && (x04 = x04[ri_59]) && (x03 = x03[ri_59]) && (x02 = x02[ri_59]) && (x01 = x01[ri_59]) then
            return(r_15[u_59])
          else
            r_15 <-R hash0;
            return(r_15)
        else
          find [unique] u_45 = ri_45 <= qH0 suchthat defined(r_16[ri_45], x1[ri_45]) && (x1 = x1[ri_45]) then
            return(r_16[u_45])
          else
            r_16 <-R hash0;
            return(r_16)
      ) | (
        foreach iH_1 <= qH1 do
        OH_1(x1_1: bitstring) :=
        let concat(x11: host, x12: host, x13: G, x14: G, x15: G) = x1_1 in
          find [unique] u_5 = ri_5 <= qH1 suchthat defined(r_2[ri_5], x11[ri_5], x12[ri_5], x13[ri_5], x14[ri_5], x15[ri_5]) && (x15 = x15[ri_5]) && (x14 = x14[ri_5]) && (x13 = x13[ri_5]) && (x12 = x12[ri_5]) && (x11 = x11[ri_5]) then
            return(r_2[u_5])
          else
            r_2 <-R hash1;
            return(r_2)
        else
          find [unique] u = ri <= qH1 suchthat defined(r_3[ri], x1_1[ri]) && (x1_1 = x1_1[ri]) then
            return(r_3[u])
          else
            r_3 <-R hash1;
            return(r_3)
      ))


Proved event(Auth2) ==> false with public variables sk_s, sk_u in game 116
Proved event(Encrypt) ==> false with public variables sk_u, sk_s in game 116
Proved event(Auth) ==> false with public variables sk_s, sk_u in game 116
Adv[Game 1: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s] <= (2 * NP * qH1 + 1.5 * NP * NP + NU * NP + NU * NU + NS * NP) / |Z| + NS / |hash1| + Adv[Game 10: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s]
Adv[Game 10: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s] <= 0 + Adv[Game 11: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s, Auth]
Adv[Game 11: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s, Auth] <= (qE * NP + qE * NS + 2 * NP * qH1 + NS * qD + NS * NU + NP * qD + NP * NU + NS * NP + NS * NS + NP * NP + 0.5 * NU * NU) / |Z| + (qH1 * NU + -1 * NU + -1 * qD + -1 * NP + -1 * NS + -1 * qE + NU * NU + 2 * NU * qD + qD * qD + 2 * NU * NP + 2 * qD * NP + NP * NP + 2 * NU * NS + 2 * qD * NS + 2 * NP * NS + NS * NS + 2 * NU * qE + 2 * qD * qE + 2 * NP * qE + 2 * NS * qE + qE * qE) / |G| + Adv[Game 19: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s, Auth]
Adv[Game 19: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s, Auth] <= 0 + Adv[Game 20: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s, Encrypt || Auth]
Adv[Game 20: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s, Encrypt || Auth] <= (NP * NS + 3 * qH0 * NU + 4 * qH1 * NU + NU * qD + 6 * NU * NU + 0.5 * qD * qD) / |G| + (NP * NP * NU + 8 * NP * qH1 + NU * NU * NU * NS + 2 * NS * NU + 6 * NP * NU + NU * NU * NU * NP + 2 * NU * NU * NU * qD + 2 * NU * NU * NU * NU + NU * NU * qD * NS + 2 * NS * qD + NP * qD + NU * NU * qD * NP + 2 * NU * NU * qD * qD + 8 * NS * NS * NU * NU + 3 * NS * NU * NU * NP + 2 * NP * NP * NU * NU + 2.5 * NU * NU + 2.5 * NS * NS + 2 * NP * NS) / |Z| + qH1 * NU / |hash1| + Pr[Game 32: Encrypt || Auth] + Adv[Game 32: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s]
Pr[Game 32: Encrypt || Auth] <= (0.5 * NS * NS + NS * qE + NS + 0.5 * NP * NP + NP * qE + NU * qE + NS * NP + 2 * NU * NU + 2 * qH0 * NU + 2 * qH1 * NU) / |G| + 0.5 * qH1 * qH1 / |hash1| + (8 * qH1 + 5 * qH0 + 4) * pCDH(time_1) + (2 * NU + qD + NS + 2 * NP) * pZero + (2 * NS * NP + NP * NP + 3 * NU * qH0 + 3 * NU * qH1 + 7 * NU * NP + 10 * NP * qH1 + 3 * NS * NS + 6 * NU * NU) / |Z| + Pr[Game 111: Encrypt || Auth]
Pr[Game 111: Encrypt || Auth] <= 0 + Pr[Game 112: Auth2 || Encrypt || Auth]
Pr[Game 112: Auth2 || Encrypt || Auth] <= (0.5 * qE * qE + 0.5 * qD * qD) / |G| + 0.5 * qH1 * qH1 / |hash1| + (NU + NS) / |passwd| + Pr[Game 116: Encrypt] + Pr[Game 116: Auth2] + Pr[Game 116: Auth]
Pr[Game 116: Encrypt] <= 0
Pr[Game 116: Auth2] <= 0
Pr[Game 116: Auth] <= 0
Adv[Game 32: event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s] <= (NU * qH1 + 0.5 * qH1 * qH1) / |hash1| + (NS * NU + NS * qD + 0.5 * NU * NU + NS * NP) / |Z| + (3 * NU * qH0 + 7 * NU * NU + 2 * NS * NU + NS * qH0 + 0.5 * qH0 * qH0 + NS * NS) / |hash0| + (0.5 * NS * NS + NP * NS) / |G|
RESULT Proved event(termS(x, X, y, Ystar, a, k)) && event(acceptU(x, X, y, Ystar, a, k')) ==> (k = k') with public variables sk_u, sk_s up to probability (NS + 2 * NU * qH1 + 1.5 * qH1 * qH1) / |hash1| + (qE * NP + qE * NS + NP * NP * NU + NU * NU * NU * NS + NU * NU * NU * NP + 2 * NU * NU * NU * qD + 2 * NU * NU * NU * NU + NU * NU * qD * NS + 2 * NP * qD + NU * NU * qD * NP + 2 * NU * NU * qD * qD + 8 * NS * NS * NU * NU + 3 * NS * NU * NU * NP + 2 * NP * NP * NU * NU + 3.5 * NP * NP + 3 * NU * qH0 + 3 * NU * qH1 + 15 * NU * NP + 22 * NP * qH1 + 6.5 * NS * NS + 4 * NS * NU + 4 * NS * qD + 10.5 * NU * NU + 7 * NS * NP) / |Z| + (-1 * NU + -1 * qD + -1 * NP + -1 * qE + 2 * NU * NP + 2 * qD * NP + 2 * NU * NS + 2 * qD * NS + 2 * qD * qE + 3 * NU * qD + 3 * NS * qE + 1.5 * NP * NP + 3 * NP * qE + 3 * NU * qE + 9 * NU * NU + 5 * qH0 * NU + 7 * qH1 * NU + 1.5 * qE * qE + 2 * qD * qD + 2 * NS * NS + 5 * NP * NS) / |G| + (8 * qH1 + 5 * qH0 + 4) * pCDH(time_1) + (2 * NU + qD + NS + 2 * NP) * pZero + (NU + NS) / |passwd| + (3 * NU * qH0 + 7 * NU * NU + 2 * NS * NU + NS * qH0 + 0.5 * qH0 * qH0 + NS * NS) / |hash0|
Adv[Game 1: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s] <= (2 * NP * qH1 + 1.5 * NP * NP + NU * NP + NU * NU + NS * NP) / |Z| + NS / |hash1| + Adv[Game 10: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s]
Adv[Game 10: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s] <= 0 + Adv[Game 11: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s, Auth]
Adv[Game 11: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s, Auth] <= (qE * NP + qE * NS + 2 * NP * qH1 + NS * qD + NS * NU + NP * qD + NP * NU + NS * NP + NS * NS + NP * NP + 0.5 * NU * NU) / |Z| + (qH1 * NU + -1 * NU + -1 * qD + -1 * NP + -1 * NS + -1 * qE + NU * NU + 2 * NU * qD + qD * qD + 2 * NU * NP + 2 * qD * NP + NP * NP + 2 * NU * NS + 2 * qD * NS + 2 * NP * NS + NS * NS + 2 * NU * qE + 2 * qD * qE + 2 * NP * qE + 2 * NS * qE + qE * qE) / |G| + Adv[Game 19: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s, Auth]
Adv[Game 19: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s, Auth] <= 0 + Adv[Game 20: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s, Encrypt || Auth]
Adv[Game 20: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s, Encrypt || Auth] <= (8 * qH1 + 5 * qH0 + 4) * pCDH(time_1) + (2 * NU + qD + NS + 2 * NP) * pZero + (NP * NP + 3 * NU * qH0 + 3 * NU * qH1 + NP * NP * NU + 18 * NP * qH1 + NU * NU * NU * NS + 2 * NS * NU + 13 * NP * NU + NU * NU * NU * NP + 2 * NU * NU * NU * qD + 2 * NU * NU * NU * NU + NU * NU * qD * NS + 2 * NS * qD + NP * qD + NU * NU * qD * NP + 2 * NU * NU * qD * qD + 8 * NS * NS * NU * NU + 3 * NS * NU * NU * NP + 2 * NP * NP * NU * NU + 8.5 * NU * NU + 5.5 * NS * NS + 4 * NP * NS) / |Z| + (2 * NP * NS + 5 * qH0 * NU + 6 * qH1 * NU + NU * qD + 8 * NU * NU + 0.5 * qD * qD) / |G| + qH1 * NU / |hash1| + Pr[Game 54: Encrypt || Auth] + Adv[Game 54: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s]
Pr[Game 54: Encrypt || Auth] <= (0.5 * NS * NS + NS * qE + NS + 0.5 * NP * NP + NP * qE + NU * qE) / |G| + 0.5 * qH1 * qH1 / |hash1| + Pr[Game 111: Encrypt || Auth]
Pr[Game 111: Encrypt || Auth] <= 0 + Pr[Game 112: Auth2 || Encrypt || Auth]
Pr[Game 112: Auth2 || Encrypt || Auth] <= (0.5 * qE * qE + 0.5 * qD * qD) / |G| + 0.5 * qH1 * qH1 / |hash1| + (NU + NS) / |passwd| + Pr[Game 116: Encrypt] + Pr[Game 116: Auth2] + Pr[Game 116: Auth]
Pr[Game 116: Encrypt] <= 0
Pr[Game 116: Auth2] <= 0
Pr[Game 116: Auth] <= 0
Adv[Game 54: inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s] <= 0
RESULT Proved inj-event(termS(x, X, y, Ystar, a, k)) ==> inj-event(acceptU(x, X, y, Ystar, a, k)) with public variables sk_u, sk_s up to probability (NS + qH1 * NU + qH1 * qH1) / |hash1| + (qE * NP + qE * NS + 3.5 * NP * NP + 3 * NU * qH0 + 3 * NU * qH1 + NP * NP * NU + 22 * NP * qH1 + NU * NU * NU * NS + 3 * NS * NU + 15 * NP * NU + NU * NU * NU * NP + 2 * NU * NU * NU * qD + 2 * NU * NU * NU * NU + NU * NU * qD * NS + 3 * NS * qD + 2 * NP * qD + NU * NU * qD * NP + 2 * NU * NU * qD * qD + 8 * NS * NS * NU * NU + 3 * NS * NU * NU * NP + 2 * NP * NP * NU * NU + 10 * NU * NU + 6.5 * NS * NS + 6 * NP * NS) / |Z| + (-1 * NU + -1 * qD + -1 * NP + -1 * qE + 2 * NU * NP + 2 * qD * NP + 2 * NU * NS + 2 * qD * NS + 2 * qD * qE + 4 * NP * NS + 5 * qH0 * NU + 7 * qH1 * NU + 3 * NU * qD + 9 * NU * NU + 1.5 * NS * NS + 3 * NS * qE + 1.5 * NP * NP + 3 * NP * qE + 3 * NU * qE + 1.5 * qE * qE + 2 * qD * qD) / |G| + (8 * qH1 + 5 * qH0 + 4) * pCDH(time_1) + (2 * NU + qD + NS + 2 * NP) * pZero + (NU + NS) / |passwd|
Adv[Game 1: secrecy of sk_s] <= (4 * NP * qH1 + 3 * NP * NP + 2 * NU * NP + 2 * NU * NU + 2 * NS * NP) / |Z| + 2 * NS / |hash1| + Adv[Game 10: secrecy of sk_s]
Adv[Game 10: secrecy of sk_s] <= 0 + Adv[Game 11: secrecy of sk_s, Auth]
Adv[Game 11: secrecy of sk_s, Auth] <= (2 * qE * NP + 2 * qE * NS + 4 * NP * qH1 + 2 * NS * qD + 2 * NS * NU + 2 * NP * qD + 2 * NP * NU + 2 * NS * NP + 2 * NS * NS + 2 * NP * NP + NU * NU) / |Z| + (2 * qH1 * NU + -2 * NU + -2 * qD + -2 * NP + -2 * NS + -2 * qE + 2 * NU * NU + 4 * NU * qD + 2 * qD * qD + 4 * NU * NP + 4 * qD * NP + 2 * NP * NP + 4 * NU * NS + 4 * qD * NS + 4 * NP * NS + 2 * NS * NS + 4 * NU * qE + 4 * qD * qE + 4 * NP * qE + 4 * NS * qE + 2 * qE * qE) / |G| + Adv[Game 19: secrecy of sk_s, Auth]
Adv[Game 19: secrecy of sk_s, Auth] <= 0 + Adv[Game 20: secrecy of sk_s, Encrypt || Auth]
Adv[Game 20: secrecy of sk_s, Encrypt || Auth] <= (16 * qH1 + 10 * qH0 + 8) * pCDH(time_1) + (4 * NU + 2 * qD + 2 * NS + 4 * NP) * pZero + (2 * NP * NP + 6 * NU * qH0 + 6 * NU * qH1 + 2 * NP * NP * NU + 36 * NP * qH1 + 2 * NU * NU * NU * NS + 4 * NS * NU + 26 * NP * NU + 2 * NU * NU * NU * NP + 4 * NU * NU * NU * qD + 4 * NU * NU * NU * NU + 2 * NU * NU * qD * NS + 4 * NS * qD + 2 * NP * qD + 2 * NU * NU * qD * NP + 4 * NU * NU * qD * qD + 16 * NS * NS * NU * NU + 6 * NS * NU * NU * NP + 4 * NP * NP * NU * NU + 17 * NU * NU + 11 * NS * NS + 8 * NP * NS) / |Z| + (4 * NP * NS + 10 * qH0 * NU + 12 * qH1 * NU + 2 * NU * qD + 16 * NU * NU + qD * qD) / |G| + 2 * qH1 * NU / |hash1| + Pr[Game 54: Encrypt || Auth] + Adv[Game 54: secrecy of sk_s]
Pr[Game 54: Encrypt || Auth] <= (0.5 * NS * NS + NS * qE + NS + 0.5 * NP * NP + NP * qE + NU * qE) / |G| + 0.5 * qH1 * qH1 / |hash1| + Pr[Game 111: Encrypt || Auth]
Pr[Game 111: Encrypt || Auth] <= 0 + Pr[Game 112: Auth2 || Encrypt || Auth]
Pr[Game 112: Auth2 || Encrypt || Auth] <= (0.5 * qE * qE + 0.5 * qD * qD) / |G| + 0.5 * qH1 * qH1 / |hash1| + (NU + NS) / |passwd| + Pr[Game 116: Encrypt] + Pr[Game 116: Auth2] + Pr[Game 116: Auth]
Pr[Game 116: Encrypt] <= 0
Pr[Game 116: Auth2] <= 0
Pr[Game 116: Auth] <= 0
Adv[Game 54: secrecy of sk_s] <= 0
RESULT Proved secrecy of sk_s up to probability (2 * NS + 2 * qH1 * NU + qH1 * qH1) / |hash1| + (2 * qE * NP + 2 * qE * NS + 7 * NP * NP + 6 * NU * qH0 + 6 * NU * qH1 + 2 * NP * NP * NU + 44 * NP * qH1 + 2 * NU * NU * NU * NS + 6 * NS * NU + 30 * NP * NU + 2 * NU * NU * NU * NP + 4 * NU * NU * NU * qD + 4 * NU * NU * NU * NU + 2 * NU * NU * qD * NS + 6 * NS * qD + 4 * NP * qD + 2 * NU * NU * qD * NP + 4 * NU * NU * qD * qD + 16 * NS * NS * NU * NU + 6 * NS * NU * NU * NP + 4 * NP * NP * NU * NU + 20 * NU * NU + 13 * NS * NS + 12 * NP * NS) / |Z| + (-2 * NU + -2 * qD + -2 * NP + -2 * qE + 4 * NU * NP + 4 * qD * NP + 4 * NU * NS + 4 * qD * NS + 4 * qD * qE + 8 * NP * NS + 10 * qH0 * NU + 14 * qH1 * NU + 6 * NU * qD + 18 * NU * NU + 2.5 * NS * NS + 5 * NS * qE + -1 * NS + 2.5 * NP * NP + 5 * NP * qE + 5 * NU * qE + 2.5 * qE * qE + 3.5 * qD * qD) / |G| + (16 * qH1 + 10 * qH0 + 8) * pCDH(time_1) + (4 * NU + 2 * qD + 2 * NS + 4 * NP) * pZero + (NU + NS) / |passwd|
Adv[Game 1: secrecy of sk_u] <= (4 * NP * qH1 + 3 * NP * NP + 2 * NU * NP + 2 * NU * NU + 2 * NS * NP) / |Z| + 2 * NS / |hash1| + Adv[Game 10: secrecy of sk_u]
Adv[Game 10: secrecy of sk_u] <= 0 + Adv[Game 11: secrecy of sk_u, Auth]
Adv[Game 11: secrecy of sk_u, Auth] <= (2 * qE * NP + 2 * qE * NS + 4 * NP * qH1 + 2 * NS * qD + 2 * NS * NU + 2 * NP * qD + 2 * NP * NU + 2 * NS * NP + 2 * NS * NS + 2 * NP * NP + NU * NU) / |Z| + (2 * qH1 * NU + -2 * NU + -2 * qD + -2 * NP + -2 * NS + -2 * qE + 2 * NU * NU + 4 * NU * qD + 2 * qD * qD + 4 * NU * NP + 4 * qD * NP + 2 * NP * NP + 4 * NU * NS + 4 * qD * NS + 4 * NP * NS + 2 * NS * NS + 4 * NU * qE + 4 * qD * qE + 4 * NP * qE + 4 * NS * qE + 2 * qE * qE) / |G| + Adv[Game 19: secrecy of sk_u, Auth]
Adv[Game 19: secrecy of sk_u, Auth] <= 0 + Adv[Game 20: secrecy of sk_u, Encrypt || Auth]
Adv[Game 20: secrecy of sk_u, Encrypt || Auth] <= (16 * qH1 + 10 * qH0 + 8) * pCDH(time_1) + (4 * NU + 2 * qD + 2 * NS + 4 * NP) * pZero + (2 * NP * NP + 6 * NU * qH0 + 6 * NU * qH1 + 2 * NP * NP * NU + 36 * NP * qH1 + 2 * NU * NU * NU * NS + 4 * NS * NU + 26 * NP * NU + 2 * NU * NU * NU * NP + 4 * NU * NU * NU * qD + 4 * NU * NU * NU * NU + 2 * NU * NU * qD * NS + 4 * NS * qD + 2 * NP * qD + 2 * NU * NU * qD * NP + 4 * NU * NU * qD * qD + 16 * NS * NS * NU * NU + 6 * NS * NU * NU * NP + 4 * NP * NP * NU * NU + 17 * NU * NU + 11 * NS * NS + 8 * NP * NS) / |Z| + (4 * NP * NS + 10 * qH0 * NU + 12 * qH1 * NU + 2 * NU * qD + 16 * NU * NU + qD * qD) / |G| + 2 * qH1 * NU / |hash1| + Pr[Game 54: Encrypt || Auth] + Adv[Game 54: secrecy of sk_u]
Pr[Game 54: Encrypt || Auth] <= (0.5 * NS * NS + NS * qE + NS + 0.5 * NP * NP + NP * qE + NU * qE) / |G| + 0.5 * qH1 * qH1 / |hash1| + Pr[Game 111: Encrypt || Auth]
Pr[Game 111: Encrypt || Auth] <= 0 + Pr[Game 112: Auth2 || Encrypt || Auth]
Pr[Game 112: Auth2 || Encrypt || Auth] <= (0.5 * qE * qE + 0.5 * qD * qD) / |G| + 0.5 * qH1 * qH1 / |hash1| + (NU + NS) / |passwd| + Pr[Game 116: Encrypt] + Pr[Game 116: Auth2] + Pr[Game 116: Auth]
Pr[Game 116: Encrypt] <= 0
Pr[Game 116: Auth2] <= 0
Pr[Game 116: Auth] <= 0
Adv[Game 54: secrecy of sk_u] <= 0
RESULT Proved secrecy of sk_u up to probability (2 * NS + 2 * qH1 * NU + qH1 * qH1) / |hash1| + (2 * qE * NP + 2 * qE * NS + 7 * NP * NP + 6 * NU * qH0 + 6 * NU * qH1 + 2 * NP * NP * NU + 44 * NP * qH1 + 2 * NU * NU * NU * NS + 6 * NS * NU + 30 * NP * NU + 2 * NU * NU * NU * NP + 4 * NU * NU * NU * qD + 4 * NU * NU * NU * NU + 2 * NU * NU * qD * NS + 6 * NS * qD + 4 * NP * qD + 2 * NU * NU * qD * NP + 4 * NU * NU * qD * qD + 16 * NS * NS * NU * NU + 6 * NS * NU * NU * NP + 4 * NP * NP * NU * NU + 20 * NU * NU + 13 * NS * NS + 12 * NP * NS) / |Z| + (-2 * NU + -2 * qD + -2 * NP + -2 * qE + 4 * NU * NP + 4 * qD * NP + 4 * NU * NS + 4 * qD * NS + 4 * qD * qE + 8 * NP * NS + 10 * qH0 * NU + 14 * qH1 * NU + 6 * NU * qD + 18 * NU * NU + 2.5 * NS * NS + 5 * NS * qE + -1 * NS + 2.5 * NP * NP + 5 * NP * qE + 5 * NU * qE + 2.5 * qE * qE + 3.5 * qD * qD) / |G| + (16 * qH1 + 10 * qH0 + 8) * pCDH(time_1) + (4 * NU + 2 * qD + 2 * NS + 4 * NP) * pZero + (NU + NS) / |passwd|
RESULT time_1 = time(context for game 49) + time + (5 + 5 * qH0 + 8 * qH1 + 2 * NP + NS + qD + 2 * NU) * time(exp)
RESULT time(context for game 49) = NU * time(([1,NU])) + NS * time(([1,NS])) + (qH0 + qH1) * time(let concat) + qH0 * qH0 * time(= bitstring, maxlength(game 49: x1), maxlength(game 49: x1)) + qH1 * qH1 * time(= bitstring, maxlength(game 49: x1_1), maxlength(game 49: x1_1))
All queries proved.
